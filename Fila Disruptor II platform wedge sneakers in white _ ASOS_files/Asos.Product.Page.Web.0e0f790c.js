define("Models/Component",[],function(){return function(){this.componentConfig=null,this.type=null,this.elementId=null,this.element=null,this.useComponentTemplate=!1,this.data=null,this.state=void 0,this.setComponentConfig=function(e){this.componentConfig=void 0!==e?e:null},this.setType=function(e){this.type=void 0!==e?e:null},this.setElementId=function(e){this.elementId=void 0!==e?e:this.type,this.element=document.getElementById(this.elementId)},this.setUseComponentTemplate=function(e){e=void 0===e?!0:e,this.useComponentTemplate="boolean"==typeof e?e:!0},this.setData=function(e){this.data=void 0!==e?e:null},this.setState=function(e){this.state=void 0!==e?e:this.state},this.getComponentPath=function(){return null!==this.type?"Components/"+this.type+"/"+this.type:null},this.getElement=function(){return this.element},this.getDictionary=function(){if(!this.element||!this.element.hasAttribute("dictionary"))return null;try{return JSON.parse(this.element.getAttribute("dictionary"))}catch(e){return null}},this.getComponentConfig=function(){return!this.useComponentTemplate&&this.element&&(this.componentConfig.template={element:this.element}),this.componentConfig}}}),define("ProductUtils/ComponentLoader",["ko","Models/Component"],function(e,t){return function(){this.register=function(i,n,r){var s=new t;return s.setType(i.type),s.setElementId(i.elementId),s.setData(n),s.setState(r),s.setUseComponentTemplate(i.useComponentTemplate),require([s.getComponentPath()],function(t){s.setComponentConfig(t),e.components.register(i.name,s.getComponentConfig()),(null!==s.getElement()||s.getElement()!=={})&&e.applyBindingsToNode(s.getElement(),{component:{name:i.name,params:{dictionary:s.getDictionary(),data:s.data,state:s.state}}})}),s},this.unregister=function(t){t&&0!==t.length&&e.components.isRegistered(t)&&e.components.unregister(t)}}}),define("videoPlayerView",[],function(){return'<div class="asos-media-players">\n    <div class="amp-video-player amp-relative">\n        <video class="amp-page amp-video-element" data-bind="foreach: sources" controls="controls" muted>\n            <source data-bind="attr: { type: type, src: src }" />\n        </video>\n        <div class="amp-page amp-page-message amp-error-page" data-bind="visible: isErrorPageVisible">\n            <div class="amp-message-container">\n                <div class="amp-message-box">\n                    <h2 data-bind="html: messages.errorHeaderText"></h2>\n                    <p data-bind="html: messages.errorMessageText"></p>\n                    <div class="amp-button amp-button-black" data-bind="html: messages.refreshButtonText, click: refreshButtonClicked"></div>\n                </div>\n            </div>\n        </div>\n        <div class="amp-page amp-page-message amp-unsupported-page" data-bind="visible: isUnsupportedPageVisible">\n            <div class="amp-message-container">\n                <div class="amp-message-box">\n                    <h2 data-bind="html: messages.unsupportedHeaderText"></h2>\n                    <p data-bind="html: messages.unsupportedMessageText"></p>\n                    <div class="amp-button amp-button-black" data-bind="html: messages.closeButtonText, click: closeButtonClicked"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'}),define("utils/scene7.config",[],function(){"use strict";return function(e,t){this.jsonpCallback="s7jsonResponse",this.jsonpErrorCallback="s7jsonError",this.scene7imageServer=e,this.scene7videoServer=t,this.spinsetManifestFileUrlPattern=this.scene7imageServer+"/products/test-desc/[productID]-spinset",this.imageUrlPattern=this.scene7imageServer+"/products/[assetID]",this.maxImageSize={width:4e3,height:4e3},this.imageMinPartitionFactors={horizontal:3,vertical:4}}}),define("utils/scene7.DataProvider",["$"],function(e){"use strict";var t=function(e){this.scene7config=e,this.manifestCache={}};return t.prototype.ABSOLUTE_URL_REGEX=/^https?:\/\/|^\/\//i,t.requests=[],t.prototype.getJson=function(i,n,r){Object.prototype.hasOwnProperty.call(window,this.scene7config.jsonpErrorCallback)||(window[this.scene7config.jsonpErrorCallback]=function(e,i){var n=t.requests[i];"function"==typeof n.onError&&n.onError()}),Object.prototype.hasOwnProperty.call(window,this.scene7config.jsonpCallback)||(window[this.scene7config.jsonpCallback]=function(e,i){var n=t.requests[i];"function"==typeof n.onSuccess&&n.onSuccess(e)}),t.requests.push({onSuccess:n,onError:r}),e.ajax({url:i.replace("[requestID]",t.requests.length-1),jsonp:"true",dataType:"jsonp",success:function(e){n(e)},error:r})},t.prototype.getManifestData=function(t){this.ABSOLUTE_URL_REGEX.test(t)||(t="//"+t);var i=new e.Deferred;if(!this.manifestCache[t]){var n=t+(-1===t.indexOf("?")?"?":"&")+"req=set,json&id=[requestID]";return this.getJson(n,function(n){this.manifestCache[t]=n,i.resolve(e.extend(!0,{},n))}.bind(this),function(){i.reject()}),i.promise()}return i.resolve(e.extend(!0,{},this.manifestCache[t])),i.promise()},t}),define("videoPlayer/DataMapper",[],function(){"use strict";var e=function(e){this.scene7config=e};return e.prototype.VIDEO_FILE_URL_PATTERN="/products/[assetID]",e.prototype.VIDEO_TYPE_FORMAT={m3u8:"application/x-mpegurl",mp4:"video/mp4"},e.prototype.map=function(e){return e.set.item.map(this.getAssetFromServerItem.bind(this))},e.prototype.getAssetFromServerItem=function(e){return{bitrate:parseInt(e.v.bitrate,10),width:parseInt(e.v.dx,10),height:parseInt(e.v.dy,10),src:this.scene7config.scene7videoServer+this.VIDEO_FILE_URL_PATTERN.replace("[assetID]",e.v.path),format:e.v.suffix,type:this.VIDEO_TYPE_FORMAT[e.v.suffix],fps:e.userdata&&e.userdata[0]&&e.userdata[0].Video_Frame_Rate?parseFloat(e.userdata[0].Video_Frame_Rate):null}},e}),define("utils/deviceHelper",[],function(){"use strict";var e=function(){return this};return e.prototype.getScreenProperties=function(e){return{width:e.screen.width,height:e.screen.height}},e.prototype.isPhysicalSizeGreaterThanLogicalSize=function(e){return e&&void 0!==e.systemXDPI&&void 0!==e.logicalXDPI&&e.systemXDPI>e.logicalXDPI},e.prototype.getDevicePixelRatio=function(e){var t=1;return this.isPhysicalSizeGreaterThanLogicalSize(e.screen)?t=e.screen.systemXDPI/e.screen.logicalXDPI:void 0!==e.devicePixelRatio&&(t=e.devicePixelRatio),t},e.prototype.getWidthInPhysicalPixels=function(e){return this.getScreenProperties(e).width*this.getDevicePixelRatio(e)},e.prototype.getHeightInPhysicalPixels=function(e){return this.getScreenProperties(e).height*this.getDevicePixelRatio(e)},new e}),define("videoPlayer/AssetsProvider",["$","utils/deviceHelper"],function(e,t){"use strict";var i=function(e,t,i){this.scene7config=e,this.dataProvider=t,this.dataMapper=i};return i.prototype.MANIFEST_PATH_PATTERN="/products/test-desc/[productID]-catwalk-AVS",i.prototype.DEFAULT_FPS=50,i.prototype.DEFAULT_BITRATES={480:800,720:1200,1080:2500},i.prototype.getAssetsByFormat=function(e,t){return e.filter(function(e){return e.format===t})},i.prototype.isBetterWidthDifference=function(e,t){return 0===e||e>0&&0>t||!(0>e&&t>0)&&Math.abs(e)<=Math.abs(t)},i.prototype.getBestAssetsByWidth=function(e){var i=t.getWidthInPhysicalPixels(window),n=e[0].width,r=e[0].width-i,s=r;return e.forEach(function(e){s=e.width-i,this.isBetterWidthDifference(s,r)&&(n=e.width,r=s)}.bind(this)),e.filter(function(e){return e.width===n})},i.prototype.getPreferredBitrateForDevice=function(e){e=e||this.DEFAULT_BITRATES;var i=Object.keys(e).map(function(e){return parseInt(e,10)}),n=t.getWidthInPhysicalPixels(window),r=i[0],s=i[0]-n,o=s;return i.forEach(function(e){o=e-n,Math.abs(o)<=Math.abs(s)&&(r=e,s=o)}),1e3*e[r]},i.prototype.getBestAssetsByBitrate=function(e,t){var i=this.getPreferredBitrateForDevice(t),n=e[0].bitrate,r=e[0].bitrate-i,s=r;return e.forEach(function(e){s=e.bitrate-i,Math.abs(s)<=Math.abs(r)&&(n=e.bitrate,r=s)}.bind(this)),e.filter(function(e){return e.bitrate===n})},i.prototype.getBestAssetsByFPS=function(e,t){var i=e[0].fps,n=e[0].fps-t,r=n;return e.forEach(function(e){r=e.fps-t,Math.abs(r)<=Math.abs(n)&&(i=e.fps,n=r)}.bind(this)),e.filter(function(e){return e.fps===i})},i.prototype.getBestAsset=function(e,t,i){if(e&&e.length){i=i||this.DEFAULT_FPS;var n=this.getBestAssetsByWidth(e);if(n.length<=1)return n[0];var r=this.getBestAssetsByBitrate(n,t);if(r.length<=1)return r[0];var s=this.getBestAssetsByFPS(r,i);return s[0]}},i.prototype.getBestAssets=function(e,t,i){var n=this.getBestAssetsFromManifest(t,i);return-1!==i.formats.indexOf("m3u8")&&this.addM3U8Asset(e,n),n},i.prototype.getBestAssetsFromManifest=function(e,t){var i=[];return t.formats.forEach(function(n){var r=this.getBestAsset(this.getAssetsByFormat(e,n),t.preferredBitrates,t.preferredFPS);r&&i.push(r)}.bind(this)),i},i.prototype.addM3U8Asset=function(e,t){t.push({src:e+".m3u8",format:"m3u8",type:this.dataMapper.VIDEO_TYPE_FORMAT.m3u8})},i.prototype.getAssets=function(e,t,i,n){return isNaN(parseInt(e,10))||(e=this.scene7config.scene7videoServer+this.MANIFEST_PATH_PATTERN.replace("[productID]",e)),this.dataProvider.getManifestData(e).then(function(n){var r=this.dataMapper.map(n),s=this.getBestAssets(e,r,t);return s.sort(function(e,i){return t.formats.indexOf(e.format)-t.formats.indexOf(i.format)}),"function"==typeof i&&i(s),s}.bind(this)).fail(function(){"function"==typeof n&&n()})},i}),define("videoPlayer/ViewModel",["ko"],function(e){function t(t,i){this.events=t,this.sources=e.observableArray(),this.messages=i,this.isErrorPageVisible=e.observable(!1),this.isUnsupportedPageVisible=e.observable(!1),this.refreshButtonClicked=function(){this.events.trigger("refreshButtonClicked")}.bind(this),this.closeButtonClicked=function(){this.events.trigger("closeButtonClicked")}.bind(this)}return t}),define("utils/fullScreenHelper",["$"],function(e){"use strict";var t=function(e,t){this.events=e,this.fullscreenLauncherName=this.getFullscreenLauncherName(t),this.fullscreenElementName=this.getFullscreenElementName(t),this.fullscreenCancelName=this.getFullscreenCancelName(t),this.elementStyle={position:null,top:null,left:null,width:null,height:null,backgroundColor:null,zIndex:null},this.setEventListeners(t)};return t.prototype.getFullscreenLauncherName=function(e){return e.body.requestFullscreen?"requestFullscreen":e.body.mozRequestFullScreen?"mozRequestFullScreen":e.body.webkitRequestFullscreen?"webkitRequestFullscreen":e.body.msRequestFullscreen?"msRequestFullscreen":null},t.prototype.getFullscreenCancelName=function(e){return e.exitFullscreen?"exitFullscreen":e.mozCancelFullScreen?"mozCancelFullScreen":e.webkitExitFullscreen?"webkitExitFullscreen":null},t.prototype.getFullscreenElementName=function(e){return"fullscreenElement"in e?"fullscreenElement":"webkitFullscreenElement"in e?"webkitFullscreenElement":"msFullscreenElement"in e?"msFullscreenElement":"mozFullScreenElement"in e?"mozFullScreenElement":null},t.prototype.getNativeFullScreenElement=function(e){return this.fullscreenElementName?e[this.fullscreenElementName]:void 0},t.prototype.getFullScreenElement=function(e){return this.fullscreenElement?this.fullscreenElement:this.getNativeFullScreenElement(e)},t.prototype.launchIntoFullscreen=function(e,t){if(!this.getFullScreenElement(e)){if(this.fullscreenLauncherName)return void t[this.fullscreenLauncherName]();this.fullscreenElement=t,this.onFullScreenChange(e)}},t.prototype.exitFullScreen=function(e,t){if(!t||!this.getNativeFullScreenElement(e)||this.getNativeFullScreenElement(e)===t){if(this.fullscreenCancelName)return void(this.getNativeFullScreenElement(e)&&e[this.fullscreenCancelName]());if(this.fullscreenElement)try{var i=this.fullscreenElement.parentNode,n=this.fullscreenElement.nextSibling;i.removeChild(this.fullscreenElement),i.insertBefore(this.fullscreenElement,n)}catch(r){}finally{this.onFullScreenChange(e)}}},t.prototype.onFullScreenChange=function(e){return this.getFullScreenElement(e)?void this.events.trigger("fullScreenEntered"):void this.events.trigger("fullScreenExited")},t.prototype.setEventListeners=function(t){e(t).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",this.onFullScreenChange.bind(this,t))},new t(e({}),document)}),define("videoPlayer/Controller",["$","utils/fullScreenHelper"],function(e,t){"use strict";var i=function(t,i,n,r,s){this.loadedAssets=null,this.loadedSources=void 0,this.progressEvents={0:!1,25:!1,50:!1,75:!1,100:!1},this.assetsProvider=t,this.events=r,this.viewModel=n,this.videoElement=s,this.params={},this.isError=!1,e.extend(!0,this.params,i),this.setEventListeners()};return i.prototype.setEventListeners=function(){var i=e(this.videoElement);i.on("timeupdate",function(){this.onVideoTimeUpdated(),this.videoElement.ended&&this.onVideoPlaybackEnded()}.bind(this)),i.on("webkitendfullscreen",function(){this.onFullScreenExited()}.bind(this)),i.on("error",function(e){var t=e.target;if(t===this.videoElement)this.onVideoError();else if("SOURCE"===t.tagName){var i=Array.prototype.indexOf.call(this.videoElement.querySelectorAll("source"),t);this.onVideoSourceError(i)}}.bind(this)),i.on("canplay",function(){this.isError=!1}.bind(this)),this.viewModel.events.on("videoSourceError",function(e){this.onVideoSourceError(e.detail.sourceIndex)}.bind(this)),this.viewModel.events.on("refreshButtonClicked",function(){this.onRefreshButtonClicked()}.bind(this)),this.viewModel.events.on("closeButtonClicked",function(){this.onCloseButtonClicked()}.bind(this)),t.events.on("fullScreenExited",function(){this.onFullScreenExited()}.bind(this)),t.events.on("fullScreenEntered fullScreenExited",function(){this.onFullScreenChanged()}.bind(this))},i.prototype.onVideoPlaybackEnded=function(){--this.remainingLoopCount>0?(this.videoElement.currentTime=0,this.resetProgressEvents(),this.videoElement.play(),this.events.trigger("loopEnded")):(this.stop(),this.events.trigger("allLoopsEnded"))},i.prototype.onVideoTimeUpdated=function(){var e=100*this.videoElement.currentTime/this.videoElement.duration;for(var i in this.progressEvents){var n=parseInt(i,10);!this.progressEvents[i]&&e>=n&&(this.progressEvents[i]=!0,this.events.trigger("progress",{detail:{src:this.videoElement.currentSrc,value:n,isFullScreen:t.getFullScreenElement(document)===this.videoElement}}))}},i.prototype.onVideoError=function(){this.isError=!0,this.viewModel.isErrorPageVisible(!0),this.events.trigger("playbackError")},i.prototype.onVideoSourceError=function(e){e===this.viewModel.sources().length-1&&this.onVideoError()},i.prototype.onRefreshButtonClicked=function(){this.videoElement.load(),this.start()},i.prototype.onCloseButtonClicked=function(){this.events.trigger("playerExitRequested")},i.prototype.onFullScreenExited=function(){this.params.closeOnFullScreenExited&&this.events.trigger("playerExitRequested")},i.prototype.onFullScreenChanged=function(){if(!this.params.closeOnFullScreenExited&&4===this.videoElement.readyState){var e=function(){this.videoElement.currentTime<1?(this.videoElement.currentTime+=1,this.videoElement.currentTime-=1):(this.videoElement.currentTime-=1,this.videoElement.currentTime+=1)}.bind(this);this.videoElement.paused?(this.videoElement.play(),e(),this.videoElement.pause()):(e(),this.videoElement.pause(),this.videoElement.play())}},i.prototype.hideInfoPages=function(){this.viewModel.isErrorPageVisible(!1)},i.prototype.start=function(e){this.hideInfoPages(),this.resetProgressEvents(),this.play(this.params.initialLoopCount||1,this.params.startInFullScreen,e)},i.prototype.play=function(e,i,n){n&&this.setAssets(n),this.videoElement&&this.videoElement.play&&this.loadedAssets&&!this.viewModel.isUnsupportedPageVisible()&&((this.isError||JSON.stringify(this.loadedAssets)!==JSON.stringify(this.viewModel.sources()))&&(this.viewModel.sources(this.loadedAssets),this.videoElement.load()),this.remainingLoopCount=e,this.videoElement.readyState>0&&(this.videoElement.currentTime=0),i&&t.launchIntoFullscreen(document,this.videoElement,!0),this.videoElement.play())},i.prototype.stop=function(){this.videoElement&&this.videoElement.pause&&(t.exitFullScreen(document,this.videoElement,!0),this.videoElement.pause(),this.videoElement.readyState>0&&(this.videoElement.currentTime=0))},i.prototype.resetProgressEvents=function(){for(var e in this.progressEvents)this.progressEvents[e]=!1},i.prototype.hasSupportedAssets=function(e){var t=document.createElement("video");if(!e||!t.canPlayType)return!1;var i=e.filter(function(e){return""!==t.canPlayType(e.type)});return i.length>0},i.prototype.setAssets=function(e){this.loadedAssets=e,this.viewModel.isUnsupportedPageVisible(!this.hasSupportedAssets(this.loadedAssets))},i.prototype.loadAssets=function(e,t,i,n){this.loadedAssets=null,this.assetsProvider.getAssets(e,t,function(e){e&&e.length>0?(this.setAssets(e),"function"==typeof i&&i()):"function"==typeof n&&n()}.bind(this),function(){"function"==typeof n&&n()})},i}),define("videoPlayer/component",["ko","$","videoPlayerView","utils/scene7.config","utils/scene7.DataProvider","videoPlayer/DataMapper","videoPlayer/AssetsProvider","videoPlayer/ViewModel","videoPlayer/Controller"],function(e,t,i,n,r,s,o,a,l){"use strict";return{viewModel:{createViewModel:function(e,i){var c=t({}),d=t({}),u=i.element.querySelector(".asos-media-players .amp-video-player .amp-video-element");e.messages&&e.messages.unsupportedHeaderText&&(e.messages.unsupportedHeaderText=e.messages.unsupportedHeaderText.replace("[BrowserName]","Your browser"));var h=new a(c,e.messages),p=new n(e.scene7.imageServer,e.scene7.videoServer),m=new r(p),f=new s(p),v=new o(p,m,f),g=new l(v,e.player,h,d,u),b={start:g.start.bind(g),stop:g.stop.bind(g),loadAssets:g.loadAssets.bind(g),events:g.events};return e.api(b),h}},template:i,synchronous:!0}}),define("spinViewerView",[],function(){return'<div class="asos-media-players amp-relative">\n    <div class="amp-spin-viewer amp-relative" data-bind=\'css: { "pannable": isPannable() }\'>\n        <div class="amp-spinner amp-relative">\n            <div class="amp-page amp-spin">\n                <div class="amp-page amp-hint" data-bind="fadeVisible: isHintVisible">\n                    <div class="amp-hint-container">\n                        <div class="amp-hint-gesture amp-first">\n                            <div class="amp-hint-gesture-img sprite drag"></div>\n                        </div>\n                        <div class="amp-clear"></div>\n                        <div class="amp-hint-gesture amp-first">\n                            <span data-bind="text: messages.hintDragText"></span>\n                        </div>\n                        <div class="amp-clear"></div>\n                    </div>\n                </div>\n                <div class="amp-page amp-overlay"></div>\n                <div class="amp-page amp-images"></div>\n            </div>\n            <div class="amp-page amp-loading" data-bind="visible: isLoadingPageVisible">\n                <div class="amp-loading-img"></div>\n                <span data-bind="text: loadingPercentage() + \'%\'"></span>\n            </div>\n            <div class="amp-page amp-page-message amp-error-page" data-bind="visible: isErrorPageVisible">\n                <div class="amp-message-container">\n                    <div class="amp-message-box">\n                        <h2 data-bind="html: messages.errorHeaderText"></h2>\n                        <p data-bind="html: messages.spinsetErrorMessageText"></p>\n                        <div class="amp-button amp-button-black" data-bind="html: messages.refreshButtonText, click: refreshButtonClicked"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="amp-controls">\n            <div class="amp-button amp-wrapper" data-bind="visible: isCloseButtonVisible, click: closeButtonClicked">\n                <div class="sprite close"></div>\n            </div>\n        </div>\n    </div>\n</div>                '}),define("utils/sizeHelper",[],function(){"use strict";function e(){}return e.prototype.getProportionalSize=function(e,t){var i={width:e.width,height:e.height},n=t.width/t.height,r=e.width/e.height;return r>n?i.width=i.height*n:n>r&&(i.height=i.width/n),i.width=Math.round(i.width),i.height=Math.round(i.height),i},e.prototype.resizeCanvas=function(e,t){var i=document.createElement("canvas");i.width=t.width,i.height=t.height,i.getContext("2d").drawImage(e,0,0,t.width,t.height),e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(i,0,0)},new e}),define("utils/imageProvider",["$"],function(e){"use strict";var t=function(){};return t.prototype.setImage=function(t,i,n,r,s,o){if(s&&e.support.cors)return i.onload=n,e.ajax(t,{success:function(e){i.src=t},error:r,cache:!o});if(o)t+="&"+(new Date).getTime();else if(i.complete&&i.src===t)return"function"==typeof n&&n(),null;return i.onload=n,i.onerror=r,i.src=t,null},new t}),define("utils/scene7.ImageLoader",["$","utils/sizeHelper","utils/imageProvider"],function(e,t,i){"use strict";var n=function(e,t){this.urlQueryStringPattern="wid=[width]&hei=[height]&size=[width],[height]&rect=[startH],[startW],[lengthH],[lengthW]&qlt=[qlt]",this.scene7Config=e,this.canUseCanvas=document.createElement("canvas").getContext,this.useCors=t,this.loadRequests=[]};return n.prototype.getPartitionFactors=function(e,t){return{horizontal:Math.max(Math.ceil(e.width/this.scene7Config.maxImageSize.width),t?this.scene7Config.imageMinPartitionFactors.horizontal:1),vertical:Math.max(Math.ceil(e.height/this.scene7Config.maxImageSize.height),t?this.scene7Config.imageMinPartitionFactors.vertical:1)}},n.prototype.getTile=function(e,t,n,r,s,o,a,l,c){var d=new Image,u=this.getTileUrl(t,n,r,s,o,a),h=i.setImage(u,d,function(){d.onload=null,this.loadRequests[e].isActive&&"function"==typeof l&&l(d)}.bind(this),function(){d.onload=null,this.loadRequests[e].isActive&&"function"==typeof c&&c()}.bind(this),this.useCors);return{xhr:h,image:d}},n.prototype.addTile=function(e,t,i,n,r,s,o,a,l,c,d){this.loadRequests[e].isActive&&this.loadRequests[e].tiles.push(this.getTile(e,i,n,s,o,a,l,function(i){if(this.loadRequests[e].isActive){var n=(this.getTileBox(r,s,o,a),t.querySelector('.tile[data-tile-hp="'+s+'" ][data-tile-vp="'+o+'"]')),l=n.querySelector("img");l||(l=new Image,l.style.width="100%",l.style.height="100%",n.appendChild(l)),l.src=i.src,"function"==typeof c&&c()}}.bind(this),d))},n.prototype.addTiles=function(e,t,i,n,r,s,o,a,l,c){var d=e.length,u=function(){d--,0===d&&"function"==typeof l&&l()};0===d&&"function"==typeof l&&l();for(var h=0;h<e.length;h++)this.addTile(t,i,n,r,s,e[h].horizontal,e[h].vertical,o,a,u,c)},n.prototype.loadFullImage=function(e,n,r,s,o,a,l,c,d){(s.width>this.scene7Config.maxImageSize.width||s.height>this.scene7Config.maxImageSize.height)&&(s=t.getProportionalSize(this.scene7Config.maxImageSize,s));var u=r.querySelector(".fullImageContainer"),h=r.querySelector(".partitionedImageContainer"),p=r.querySelector(".fullImageContainer img"),m=!1;u||(u=document.createElement("div"),u.className="fullImageContainer",r.insertBefore(u,r.firstChild)),p?m=!p.complete:(p=new Image,p.className="img",p.style.width="100%",p.style.height="100%",u.appendChild(p)),u.style.width=Math.floor(o.width)+"px",u.style.height=Math.floor(o.height)+"px",l&&(u.style.position=l.position,u.style.top=l.top,u.style.left=l.left),u.setAttribute("data-url",n),u.setAttribute("data-target-qlt",a),u.setAttribute("data-target-width",Math.floor(s.width)),u.setAttribute("data-target-height",Math.floor(s.height)),u.setAttribute("data-output-width",Math.floor(o.width)),u.setAttribute("data-output-height",Math.floor(o.height));var f=this.getTileUrl(n,s,0,0,{vertical:1,horizontal:1},a),v=i.setImage(f,p,function(){if(p.onload=null,this.loadRequests[e].isActive){if(h)for(;h.lastChild;)h.removeChild(h.lastChild);"function"==typeof c&&c()}}.bind(this),function(){p.onload=null,this.loadRequests[e].isActive&&"function"==typeof d&&d()}.bind(this),this.useCors,m);this.loadRequests[e].tiles.push({image:p,xhr:v})},n.prototype.loadImageToContainer=function(e,t,i,n,r,s,o,a,l,c,d){o=o||{x:i.width/2,y:i.height/2},c=c||"";var u,h,p=this.getPartitionFactors(i,l),m=(p.horizontal*p.vertical,{topLeft:{x:0,y:0},bottomRight:{x:n.width-1,y:n.height-1}}),f=this.getTileDataForPoint(o,n,p),v=this.loadRequests.push({isActive:!0,tiles:[]})-1,g=function(){this.addTiles([f],v,b,e,i,n,p,c,function(){return!!this.loadRequests[v].isActive&&void this.addTiles(u,v,b,e,i,n,p,c,function(){return!!this.loadRequests[v].isActive&&void this.addTiles(h,v,b,e,i,n,p,c,function(){this.loadRequests[v].isActive=!1,"function"==typeof r&&r()}.bind(this),function(){return!!this.loadRequests[v].isActive&&void("function"==typeof s&&s())}.bind(this))}.bind(this),function(){return!!this.loadRequests[v].isActive&&void("function"==typeof s&&s())}.bind(this))}.bind(this),function(){return!!this.loadRequests[v].isActive&&void("function"==typeof s&&s())}.bind(this))}.bind(this);if(a=a||m,a.topLeft.x=Math.max(Math.min(a.topLeft.x,m.bottomRight.x),m.topLeft.x),a.topLeft.y=Math.max(Math.min(a.topLeft.y,m.bottomRight.y),m.topLeft.y),a.bottomRight.x=Math.max(Math.min(a.bottomRight.x,m.bottomRight.x),a.topLeft.x),a.bottomRight.y=Math.max(Math.min(a.bottomRight.y,m.bottomRight.y),a.topLeft.y),u=this.getTilesDataForArea(a,n,[f],f,p),h=this.getTilesDataForArea(m,n,[f].concat(u),f,p),!this.canUseCanvas||1===p.vertical&&1===p.horizontal)this.loadFullImage(v,e,t,i,n,c,d,r,s);else{var b=t.querySelector(".partitionedImageContainer");if(!b){b=document.createElement("div"),b.className="partitionedImageContainer",b.style.width=n.width+"px",b.style.height=n.height+"px",d&&(b.style.position=d.position,b.style.top=d.top,b.style.left=d.left);for(var y=0;y<p.vertical;y++)for(var S=0;S<p.horizontal;S++){var w=document.createElement("div");w.className="tile",w.style["float"]="left",w.style.width=100/p.horizontal+"%",w.style.height=100/p.vertical+"%",w.setAttribute("data-tile-hp",S),w.setAttribute("data-tile-vp",y),b.appendChild(w)}t.appendChild(b)}g()}return v},n.prototype.getTilesDataForArea=function(e,t,i,n,r){i=i||[],n=n||{horizontal:0,vertical:0};for(var s=this.getTileDataForPoint(e.topLeft,t,r),o=this.getTileDataForPoint(e.bottomRight,t,r),a=[],l=function(e){return e.horizontal===c&&e.vertical===d},c=s.horizontal;c<=o.horizontal;c++)for(var d=s.vertical;d<=o.vertical;d++)0===i.filter(l).length&&a.push({horizontal:c,vertical:d});return a.sort(function(e,t){var i=Math.sqrt(Math.pow(e.horizontal-n.horizontal,2)+Math.pow(e.vertical-n.vertical)),r=Math.sqrt(Math.pow(t.horizontal-n.horizontal,2)+Math.pow(t.vertical-n.vertical));return i>r?1:-1}),a},n.prototype.getTileDataForPoint=function(e,t,i){for(var n,r={horizontal:null,vertical:null},s=0;s<i.horizontal&&null===r.horizontal;s++)n=this.getTileBox(t,s,0,i),e.x>=n.left&&e.x<n.left+n.width&&(r.horizontal=s);for(var o=0;o<i.vertical&&null===r.vertical;o++)n=this.getTileBox(t,0,o,i),e.y>=n.top&&e.y<n.top+n.height&&(r.vertical=o);return r},n.prototype.getTileBox=function(e,t,i,n){var r=this.getPartPosition(t,e.width,n.horizontal),s=this.getPartPosition(i,e.height,n.vertical),o=this.getPartPosition(t+1,e.width,n.horizontal),a=this.getPartPosition(i+1,e.height,n.vertical);return{left:r,top:s,width:o-r,height:a-s}},n.prototype.getPartPosition=function(e,t,i){return Math.floor(t*e/i)},n.prototype.getTileUrl=function(e,t,i,n,r,s){var o=this.getTileBox(t,i,n,r),a=e.indexOf("?")>-1?"&":"?",l=e+a+this.urlQueryStringPattern,c=l.replace(/\[width\]/g,Math.floor(t.width)).replace(/\[height\]/g,Math.floor(t.height)).replace("[startH]",Math.floor(o.left)).replace("[startW]",Math.floor(o.top)).replace("[lengthH]",Math.floor(o.width)).replace("[lengthW]",Math.floor(o.height)).replace("[qlt]",s);return c},n.prototype.cancelAllLoadRequests=function(){for(var e=0;e<this.loadRequests.length;e++)this.cancelLoadRequest(e)},n.prototype.cancelLoadRequest=function(e){if("number"==typeof e&&e<this.loadRequests.length&&this.loadRequests[e].isActive){var t=this.loadRequests[e];if(t.isActive=!1,t.tiles.length)for(var i=t.tiles[0].image.src,n=t.tiles.pop();n;)n.xhr?n.xhr.abort():(n.image.onload=null,n.image.src=i),n=t.tiles.pop()}},n}),define("spinViewer/DataProvider",[],function(){"use strict";var e=function(e,t){this.scene7config=e,this.scene7dataProvider=t};return e.prototype.mapManifestData=function(e){var t={frameUrls:[],maxSize:{width:0,height:0}};if(e.set.item.length>0){var i=e.set.item[0].set?e.set.item.length:1;if(1===i)t.frameUrls[0]=e.set.item.map(function(e){return this.scene7config.imageUrlPattern.replace("[assetID]",e.i.n)}.bind(this)),t.maxSize.width=parseInt(e.set.item[0].dx,10),t.maxSize.height=parseInt(e.set.item[0].dy,10);else{e.set.item[0].set.item.length>0&&(t.maxSize.width=parseInt(e.set.item[0].set.item[0].dx,10),t.maxSize.height=parseInt(e.set.item[0].set.item[0].dy,10));for(var n=0;i>n;n++)t.frameUrls[n]=e.set.item[n].set.item.map(function(e){return this.scene7config.imageUrlPattern.replace("[assetID]",e.i.n)}.bind(this))}}return t},e.prototype.getSpinsetDataForImageUrls=function(e,t,i){for(var n,r="[baseUrl]?imageset={[imageSet]}&req=set,json",s=[],o=0;o<e.length;o++)n=e[o].split("?").shift(),r=r.replace("[baseUrl]",n),s.push(n.split("/").pop());return r=r.replace("[imageSet]",s.join(",")),this.scene7dataProvider.getManifestData(r).then(function(e){var i=[];for(Array.isArray(e.set.item)||(e.set.item=[e.set.item]),o=0;o<e.set.item.length;o++)i.push(this.mapManifestData({set:{item:[e.set.item[o]]}}));return"function"==typeof t&&t(i),i}.bind(this)).fail(function(){"function"==typeof i&&i()})},e.prototype.getSpinsetDataForImageUrl=function(e,t,i){e=e.split("?").shift();var n=e+"?req=set,json";return this.scene7dataProvider.getManifestData(n).then(function(e){return e.set.item=[e.set.item],"function"==typeof t&&t(e),e}.bind(this)).fail(function(){"function"==typeof i&&i()})},e.prototype.getSpinsetDataForProduct=function(e,t,i){var n=this.scene7config.spinsetManifestFileUrlPattern.replace("[productID]",e);return this.scene7dataProvider.getManifestData(n).then(function(e){var i=this.mapManifestData(e);return"function"==typeof t&&t(i),i}.bind(this)).fail(function(){"function"==typeof i&&i()})},e}),define("spinViewer/AssetsProvider",[],function(){"use strict";var e=function(e){this.dataProvider=e};return e.prototype.getAssets=function(e,t,i){Array.isArray(e)?this.dataProvider.getSpinsetDataForImageUrls(e,t,i):isNaN(e)?this.dataProvider.getSpinsetDataForImageUrl(e,t,i):this.dataProvider.getSpinsetDataForProduct(e,t,i)},e}),define("spinViewer/ViewModel",["ko"],function(e){function t(t,i){this.events=t,this.messages=i,this.isCloseButtonVisible=e.observable(!1),this.isPannable=e.observable(!1),this.isLoadingPageVisible=e.observable(!1),this.loadingPercentage=e.observable(0),this.isErrorPageVisible=e.observable(!1),this.isHintVisible=e.observable(!1),this.refreshButtonClicked=function(){this.events.trigger("refreshButtonClicked")}.bind(this),this.closeButtonClicked=function(){this.events.trigger("closeButtonClicked")}.bind(this)}return t}),define("utils/ImageScaler",["$"],function(e){"use strict";var t=function(t){this.options={},e.extend(!0,this.options,t)};return t.prototype.getScaledImageSize=function(e){var t=this.getScaledImageLength(this.options.baseSize.width,this.options.maxSize.width,e),i=this.getScaledImageLength(this.options.baseSize.height,this.options.maxSize.height,e);return{width:t,height:i}},t.prototype.getScaledImageLength=function(e,t,i){return i?Math.pow(Math.pow(e,1/i)*t/e,i):e},t}),define("utils/ImageZoomer",["ko","$","utils/sizeHelper"],function(e,t,i){"use strict";var n=function(i,n,r,s){this.events=t({}),this.imageLoader=i,this.inputImageScaler=n,this.outputImageScaler=r,this.currentLevel=e.observable(0),this.options={},t.extend(!0,this.options,s),this.options.zoomFactors=[0].concat(this.options.zoomFactors),this.updateCanZoomDummy=e.observable(!1),this.currLoadRequestId=null,this.currentPosition={x:0,y:0},this.currentSize={width:0,height:0},this.canZoomIn=e.computed(this.canZoomIn,this),this.canZoomOut=e.computed(this.canZoomOut,this),this.fullImageStatus=this.FULL_IMAGE_STATUS.NotLoaded;
};return n.prototype.FULL_IMAGE_STATUS={NotLoaded:0,Loaded:2},n.prototype.init=function(){var e=t(this.options.container);this.containerSize={width:this.options.containerSize?this.options.containerSize.width:e.width(),height:this.options.containerSize?this.options.containerSize.height:e.height()},this.currentSize=this.getOutputImageSize(this.currentLevel()),this.currentPosition=this.getSanitizedPosition(this.currentPosition,this.currentSize),this.applyPosition(!0),this.updateCanZoomDummy(!this.updateCanZoomDummy())},n.prototype.getNextClosestLevel=function(e){for(var t=0,i=0;i<=this.options.zoomFactors.length;){var n=this.currentSize,r=this.getOutputImageSize(i);if(e&&(n.width===r.width||n.height===r.height)){t=i;break}if(n.width<r.width||n.height<r.height){t=i;break}i++}return t},n.prototype.resize=function(e,t,i){var n=this.getNextClosestLevel(!0);this.options.containerSize=t.containerSize,this.options.outputBaseSize=t.outputBaseSize,this.outputImageScaler.options.baseSize=t.imageScalersOptions.outputImageScalerOptions.baseSize,this.outputImageScaler.options.maxSize=t.imageScalersOptions.outputImageScalerOptions.maxSize,this.init(),e&&this.zoom(function(){return n},null,i)},n.prototype.canZoomIn=function(){this.updateCanZoomDummy();var e=this.currentSize,t=this.getOutputImageSize(this.options.zoomFactors.length-1);return e.width<t.width||e.height<t.height},n.prototype.canZoomOut=function(){this.updateCanZoomDummy();var e=this.getOutputImageSize(0),t=this.currentSize;return e.width<t.width||e.height<t.height},n.prototype.zoomIn=function(e,t,i){return this.canZoomIn()?void this.zoom(this.getNextClosestLevel.bind(this,!1),t,i):e?void this.zoomReset(i):void("function"==typeof i&&i())},n.prototype.zoomOut=function(e,t){return this.canZoomOut()?void this.zoom(function(){return this.currentLevel()-1}.bind(this),e,t):void("function"==typeof t&&t())},n.prototype.zoomReset=function(e,t){if(t){var i=0,n=this.getOutputImageSize(i),r=this.getZoomedImageBox(this.currentSize,this.currentPosition,n);return this.currentSize=r.size,this.currentPosition=r.position,this.applyPosition(!0),this.currentLevel(i),void("function"==typeof e&&setTimeout(e,0))}this.zoom(function(){return 0}.bind(this),void 0,e)},n.prototype.loadImage=function(e,t,i,n,r,s,o,a,l,c,d){e&&(this.imageLoader.cancelLoadRequest(this.currLoadRequestId),this.currLoadRequestId=this.imageLoader.loadImageToContainer(e,t,i,n,function(){this.currLoadRequestId=null,"function"==typeof r&&setTimeout(r,0)}.bind(this),s,o,a,l,c,d))},n.prototype.zoom=function(e,t,i,n){this.imageLoader.cancelLoadRequest(this.currLoadRequestId),this.fullImageStatus!==this.FULL_IMAGE_STATUS.Loaded&&(this.fullImageStatus=this.FULL_IMAGE_STATUS.NotLoaded);var r=e(),s=(this.getInputImageSize(r),this.getOutputImageSize(r)),o=this.getZoomedImageBox(this.currentSize,this.currentPosition,s,t),a=r>0;this.currentSize=o.size,this.currentPosition=o.position,this.applyPosition(!0),this.fullImageStatus===this.FULL_IMAGE_STATUS.NotLoaded&&a&&(this.loadImage(this.options.baseUrl,this.options.container,this.getInputImageSize(this.options.zoomFactors.length-1),this.currentSize,function(){this.fullImageStatus=this.FULL_IMAGE_STATUS.Loaded,this.applyPosition(),"function"==typeof i&&i()}.bind(this),function(){this.fullImageStatus=this.FULL_IMAGE_STATUS.NotLoaded,"function"==typeof n&&n()}.bind(this),o.focalPointOnSourceImage,this.getVisibleArea(o.position),!0,this.options.zoomJpgQlt,{position:"absolute",top:Math.floor(this.currentPosition.y)+"px",left:Math.floor(this.currentPosition.x)+"px"}),this.applyPosition(!0)),this.currentLevel(r),this.updateCanZoomDummy(!this.updateCanZoomDummy()),this.setPartitionedImageVisibility()},n.prototype.getVisibleArea=function(e){return{topLeft:{x:-e.x,y:-e.y},bottomRight:{x:this.containerSize.width-e.x,y:this.containerSize.height-e.y}}},n.prototype.getZoomedImageBox=function(e,t,i,n){n||(n={x:this.containerSize.width/2,y:this.containerSize.height/2}),n=this.getSanitizedPointOnImage(n,e);var r=this.getPointOnOutputImageFromContainer(n,e),s={width:i.width-e.width,height:i.height-e.height},o=i.width/e.width,a={x:r.x*o,y:r.y*o},l={x:r.x/e.width,y:r.y/e.height},c={x:s.width*l.x,y:s.height*l.y},d=this.getSanitizedPosition({x:t.x-c.x,y:t.y-c.y},i);return{size:i,position:d,focalPointOnSourceImage:a}},n.prototype.moveBy=function(e){this.canZoomOut()&&(e.x||e.y)&&(this.currentPosition=this.getSanitizedPosition({x:this.currentPosition.x+e.x,y:this.currentPosition.y+e.y},this.currentSize),this.applyPosition())},n.prototype.applyPosition=function(e){var i=t(this.options.container),n=Math.floor(this.currentSize.width),r=Math.floor(this.currentSize.height),s=i.find(".fullImageContainer, .partitionedImageContainer");s.css({position:"absolute",top:Math.floor(this.currentPosition.y)+"px",left:Math.floor(this.currentPosition.x)+"px",width:n+"px",height:r+"px"}),s.attr({"data-output-width":n,"data-output-height":r})},n.prototype.getInputImageSize=function(e){var t=this.options.zoomFactors[e],i=this.inputImageScaler.getScaledImageSize(t);return i.width<this.options.outputBaseSize.width||i.height<this.options.outputBaseSize.height?this.options.outputBaseSize:i},n.prototype.getOutputImageSize=function(e){if(0===e)return this.options.outputBaseSize;var t=this.options.zoomFactors[e],i=this.outputImageScaler.getScaledImageSize(t);return i.width<this.options.outputBaseSize.width||i.height<this.options.outputBaseSize.height?this.options.outputBaseSize:i},n.prototype.setPlaceholderImage=function(e){var i=0,n=(this.getInputImageSize(i),this.getOutputImageSize(i)),r=this.getZoomedImageBox(this.currentSize,this.currentPosition,n);this.currentSize=r.size,this.currentPosition=r.position;var s=t(this.options.container).children(),o=document.createElement("div");o.className="fullImageContainer",e.className="img",e.style.width="100%",e.style.height="100%",o.appendChild(e),this.options.container.appendChild(o),this.applyPosition(!0),s.remove()},n.prototype.getBezel=function(e){return{horizontal:Math.max(this.containerSize.width-Math.floor(e.width),0)/2,vertical:Math.max(this.containerSize.height-Math.floor(e.height),0)/2}},n.prototype.getSanitizedPosition=function(e,t){var i=this.getBezel(t),n={x:Math.floor(e.x),y:Math.floor(e.y)};return n.x=Math.min(n.x,i.horizontal),n.y=Math.min(n.y,i.vertical),n.x=Math.max(n.x,this.containerSize.width-Math.floor(t.width)-i.horizontal),n.y=Math.max(n.y,this.containerSize.height-Math.floor(t.height)-i.vertical),n},n.prototype.getSanitizedPointOnImage=function(e,t){var i=this.getBezel(t),n={x:e.x,y:e.y};return n.x=Math.max(n.x,i.horizontal),n.y=Math.max(n.y,i.vertical),n.x=Math.min(n.x,this.containerSize.width-i.horizontal),n.y=Math.min(n.y,this.containerSize.height-i.vertical),n},n.prototype.getPointOnOutputImageFromContainer=function(e){return{x:e.x-this.currentPosition.x,y:e.y-this.currentPosition.y}},n.prototype.getCurrentImageDisplaySize=function(){return this.currentSize},n.prototype.scale=function(e,t,i,n){i||(i={x:0,y:0});var r={width:Math.max(e.width*t,this.options.outputBaseSize.width),height:Math.max(e.height*t,this.options.outputBaseSize.height)};if(!n){var s=this.getOutputImageSize(this.options.zoomFactors.length-1);r.width=Math.min(s.width,r.width),r.height=Math.min(s.height,r.height)}var o=this.getZoomedImageBox(this.currentSize,this.currentPosition,r,i);this.currentPosition=o.position,this.currentSize=o.size,this.applyPosition(!0),this.updateCanZoomDummy(!this.updateCanZoomDummy()),this.setPartitionedImageVisibility()},n.prototype.setPartitionedImageVisibility=function(){var e=this.options.container.querySelector(".partitionedImageContainer");return e?this.currentSize.width===this.options.outputBaseSize.width?void(this.options.container.querySelector(".partitionedImageContainer").style.display="none"):void(this.options.container.querySelector(".partitionedImageContainer").style.display="block"):void 0},n}),function(e,t,i,n){"use strict";function r(e,t,i){return setTimeout(c(e,i),t)}function s(e,t,i){return!!Array.isArray(e)&&(o(e,i[t],i),!0)}function o(e,t,i){var r;if(e)if(e.forEach)e.forEach(t,i);else if(e.length!==n)for(r=0;r<e.length;)t.call(i,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(i,e[r],r,e)}function a(t,i,n){var r="DEPRECATED METHOD: "+i+"\n"+n+" AT \n";return function(){var i=new Error("get-stack-trace"),n=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=e.console&&(e.console.warn||e.console.log);return s&&s.call(e.console,r,n),t.apply(this,arguments)}}function l(e,t,i){var n,r=t.prototype;n=e.prototype=Object.create(r),n.constructor=e,n._super=r,i&&ue(n,i)}function c(e,t){return function(){return e.apply(t,arguments)}}function d(e,t){return typeof e==me?e.apply(t?t[0]||n:n,t):e}function u(e,t){return e===n?t:e}function h(e,t,i){o(v(t),function(t){e.addEventListener(t,i,!1)})}function p(e,t,i){o(v(t),function(t){e.removeEventListener(t,i,!1)})}function m(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function f(e,t){return e.indexOf(t)>-1}function v(e){return e.trim().split(/\s+/g)}function g(e,t,i){if(e.indexOf&&!i)return e.indexOf(t);for(var n=0;n<e.length;){if(i&&e[n][i]==t||!i&&e[n]===t)return n;n++}return-1}function b(e){return Array.prototype.slice.call(e,0)}function y(e,t,i){for(var n=[],r=[],s=0;s<e.length;){var o=t?e[s][t]:e[s];g(r,o)<0&&n.push(e[s]),r[s]=o,s++}return i&&(n=t?n.sort(function(e,i){return e[t]>i[t]}):n.sort()),n}function S(e,t){for(var i,r,s=t[0].toUpperCase()+t.slice(1),o=0;o<he.length;){if(i=he[o],r=i?i+s:t,r in e)return r;o++}return n}function w(){return Se++}function I(t){var i=t.ownerDocument||t;return i.defaultView||i.parentWindow||e}function _(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){d(e.options.enable,[e])&&i.handler(t)},this.init()}function C(e){var t,i=e.options.inputClass;return new(t=i?i:_e?O:Ce?B:Ie?W:F)(e,x)}function x(e,t,i){var n=i.pointers.length,r=i.changedPointers.length,s=t&Ee&&n-r===0,o=t&(Me|Le)&&n-r===0;i.isFirst=!!s,i.isFinal=!!o,s&&(e.session={}),i.eventType=t,P(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function P(e,t){var i=e.session,n=t.pointers,r=n.length;i.firstInput||(i.firstInput=A(t)),r>1&&!i.firstMultiple?i.firstMultiple=A(t):1===r&&(i.firstMultiple=!1);var s=i.firstInput,o=i.firstMultiple,a=o?o.center:s.center,l=t.center=E(n);t.timeStamp=ge(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=D(a,l),t.distance=L(a,l),T(i,t),t.offsetDirection=M(t.deltaX,t.deltaY);var c=z(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=ve(c.x)>ve(c.y)?c.x:c.y,t.scale=o?V(o.pointers,n):1,t.rotation=o?R(o.pointers,n):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length,k(i,t);var d=e.element;m(t.srcEvent.target,d)&&(d=t.srcEvent.target),t.target=d}function T(e,t){var i=t.center,n=e.offsetDelta||{},r=e.prevDelta||{},s=e.prevInput||{};t.eventType!==Ee&&s.eventType!==Me||(r=e.prevDelta={x:s.deltaX||0,y:s.deltaY||0},n=e.offsetDelta={x:i.x,y:i.y}),t.deltaX=r.x+(i.x-n.x),t.deltaY=r.y+(i.y-n.y)}function k(e,t){var i,r,s,o,a=e.lastInterval||t,l=t.timeStamp-a.timeStamp;if(t.eventType!=Le&&(l>Ae||a.velocity===n)){var c=t.deltaX-a.deltaX,d=t.deltaY-a.deltaY,u=z(l,c,d);r=u.x,s=u.y,i=ve(u.x)>ve(u.y)?u.x:u.y,o=M(c,d),e.lastInterval=t}else i=a.velocity,r=a.velocityX,s=a.velocityY,o=a.direction;t.velocity=i,t.velocityX=r,t.velocityY=s,t.direction=o}function A(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:fe(e.pointers[i].clientX),clientY:fe(e.pointers[i].clientY)},i++;return{timeStamp:ge(),pointers:t,center:E(t),deltaX:e.deltaX,deltaY:e.deltaY}}function E(e){var t=e.length;if(1===t)return{x:fe(e[0].clientX),y:fe(e[0].clientY)};for(var i=0,n=0,r=0;t>r;)i+=e[r].clientX,n+=e[r].clientY,r++;return{x:fe(i/t),y:fe(n/t)}}function z(e,t,i){return{x:t/e||0,y:i/e||0}}function M(e,t){return e===t?De:ve(e)>=ve(t)?0>e?Re:Ve:0>t?Fe:Oe}function L(e,t,i){i||(i=$e);var n=t[i[0]]-e[i[0]],r=t[i[1]]-e[i[1]];return Math.sqrt(n*n+r*r)}function D(e,t,i){i||(i=$e);var n=t[i[0]]-e[i[0]],r=t[i[1]]-e[i[1]];return 180*Math.atan2(r,n)/Math.PI}function R(e,t){return D(t[1],t[0],We)+D(e[1],e[0],We)}function V(e,t){return L(t[0],t[1],We)/L(e[0],e[1],We)}function F(){this.evEl=qe,this.evWin=He,this.pressed=!1,_.apply(this,arguments)}function O(){this.evEl=Ye,this.evWin=Ke,_.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function U(){this.evTarget=Je,this.evWin=Qe,this.started=!1,_.apply(this,arguments)}function N(e,t){var i=b(e.touches),n=b(e.changedTouches);return t&(Me|Le)&&(i=y(i.concat(n),"identifier",!0)),[i,n]}function B(){this.evTarget=tt,this.targetIds={},_.apply(this,arguments)}function $(e,t){var i=b(e.touches),n=this.targetIds;if(t&(Ee|ze)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var r,s,o=b(e.changedTouches),a=[],l=this.target;if(s=i.filter(function(e){return m(e.target,l)}),t===Ee)for(r=0;r<s.length;)n[s[r].identifier]=!0,r++;for(r=0;r<o.length;)n[o[r].identifier]&&a.push(o[r]),t&(Me|Le)&&delete n[o[r].identifier],r++;return a.length?[y(s.concat(a),"identifier",!0),a]:void 0}function W(){_.apply(this,arguments);var e=c(this.handler,this);this.touch=new B(this.manager,e),this.mouse=new F(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function G(e,t){e&Ee?(this.primaryTouch=t.changedPointers[0].identifier,q.call(this,t)):e&(Me|Le)&&q.call(this,t)}function q(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var i={x:t.clientX,y:t.clientY};this.lastTouches.push(i);var n=this.lastTouches,r=function(){var e=n.indexOf(i);e>-1&&n.splice(e,1)};setTimeout(r,it)}}function H(e){for(var t=e.srcEvent.clientX,i=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var r=this.lastTouches[n],s=Math.abs(t-r.x),o=Math.abs(i-r.y);if(nt>=s&&nt>=o)return!0}return!1}function j(e,t){this.manager=e,this.set(t)}function Z(e){if(f(e,ct))return ct;var t=f(e,dt),i=f(e,ut);return t&&i?ct:t||i?t?dt:ut:f(e,lt)?lt:at}function Y(){if(!st)return!1;var t={},i=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){t[n]=!i||e.CSS.supports("touch-action",n)}),t}function K(e){this.options=ue({},this.defaults,e||{}),this.id=w(),this.manager=null,this.options.enable=u(this.options.enable,!0),this.state=pt,this.simultaneous={},this.requireFail=[]}function X(e){return e&bt?"cancel":e&vt?"end":e&ft?"move":e&mt?"start":""}function J(e){return e==Oe?"down":e==Fe?"up":e==Re?"left":e==Ve?"right":""}function Q(e,t){var i=t.manager;return i?i.get(e):e}function ee(){K.apply(this,arguments)}function te(){ee.apply(this,arguments),this.pX=null,this.pY=null}function ie(){ee.apply(this,arguments)}function ne(){K.apply(this,arguments),this._timer=null,this._input=null}function re(){ee.apply(this,arguments)}function se(){ee.apply(this,arguments)}function oe(){K.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ae(e,t){return t=t||{},t.recognizers=u(t.recognizers,ae.defaults.preset),new le(e,t)}function le(e,t){this.options=ue({},ae.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=C(this),this.touchAction=new j(this,this.options.touchAction),ce(this,!0),o(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function ce(e,t){var i=e.element;if(i.style){var n;o(e.options.cssProps,function(r,s){n=S(i.style,s),t?(e.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={})}}function de(e,i){var n=t.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=i,i.target.dispatchEvent(n)}var ue,he=["","webkit","Moz","MS","ms","o"],pe=t.createElement("div"),me="function",fe=Math.round,ve=Math.abs,ge=Date.now;ue="function"!=typeof Object.assign?function(e){if(e===n||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var r=arguments[i];if(r!==n&&null!==r)for(var s in r)r.hasOwnProperty(s)&&(t[s]=r[s])}return t}:Object.assign;var be=a(function(e,t,i){for(var r=Object.keys(t),s=0;s<r.length;)(!i||i&&e[r[s]]===n)&&(e[r[s]]=t[r[s]]),s++;return e},"extend","Use `assign`."),ye=a(function(e,t){return be(e,t,!0)},"merge","Use `assign`."),Se=1,we=/mobile|tablet|ip(ad|hone|od)|android/i,Ie="ontouchstart"in e,_e=S(e,"PointerEvent")!==n,Ce=Ie&&we.test(navigator.userAgent),xe="touch",Pe="pen",Te="mouse",ke="kinect",Ae=25,Ee=1,ze=2,Me=4,Le=8,De=1,Re=2,Ve=4,Fe=8,Oe=16,Ue=Re|Ve,Ne=Fe|Oe,Be=Ue|Ne,$e=["x","y"],We=["clientX","clientY"];_.prototype={handler:function(){},init:function(){this.evEl&&h(this.element,this.evEl,this.domHandler),this.evTarget&&h(this.target,this.evTarget,this.domHandler),this.evWin&&h(I(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(I(this.element),this.evWin,this.domHandler)}};var Ge={mousedown:Ee,mousemove:ze,mouseup:Me},qe="mousedown",He="mousemove mouseup";l(F,_,{handler:function(e){var t=Ge[e.type];t&Ee&&0===e.button&&(this.pressed=!0),t&ze&&1!==e.which&&(t=Me),this.pressed&&(t&Me&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:Te,srcEvent:e}))}});var je={pointerdown:Ee,pointermove:ze,pointerup:Me,pointercancel:Le,pointerout:Le},Ze={2:xe,3:Pe,4:Te,5:ke},Ye="pointerdown",Ke="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Ye="MSPointerDown",Ke="MSPointerMove MSPointerUp MSPointerCancel"),l(O,_,{handler:function(e){var t=this.store,i=!1,n=e.type.toLowerCase().replace("ms",""),r=je[n],s=Ze[e.pointerType]||e.pointerType,o=s==xe,a=g(t,e.pointerId,"pointerId");r&Ee&&(0===e.button||o)?0>a&&(t.push(e),a=t.length-1):r&(Me|Le)&&(i=!0),0>a||(t[a]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:s,srcEvent:e}),i&&t.splice(a,1))}});var Xe={touchstart:Ee,touchmove:ze,touchend:Me,touchcancel:Le},Je="touchstart",Qe="touchstart touchmove touchend touchcancel";l(U,_,{handler:function(e){var t=Xe[e.type];if(t===Ee&&(this.started=!0),this.started){var i=N.call(this,e,t);t&(Me|Le)&&i[0].length-i[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:xe,srcEvent:e})}}});var et={touchstart:Ee,touchmove:ze,touchend:Me,touchcancel:Le},tt="touchstart touchmove touchend touchcancel";l(B,_,{handler:function(e){var t=et[e.type],i=$.call(this,e,t);i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:xe,srcEvent:e})}});var it=2500,nt=25;l(W,_,{handler:function(e,t,i){var n=i.pointerType==xe,r=i.pointerType==Te;if(!(r&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)G.call(this,t,i);else if(r&&H.call(this,i))return;this.callback(e,t,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var rt=S(pe.style,"touchAction"),st=rt!==n,ot="compute",at="auto",lt="manipulation",ct="none",dt="pan-x",ut="pan-y",ht=Y();j.prototype={set:function(e){e==ot&&(e=this.compute()),st&&this.manager.element.style&&ht[e]&&(this.manager.element.style[rt]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return o(this.manager.recognizers,function(t){d(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),Z(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,i=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var n=this.actions,r=f(n,ct)&&!ht[ct],s=f(n,ut)&&!ht[ut],o=f(n,dt)&&!ht[dt];if(r){var a=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(a&&l&&c)return}return o&&s?void 0:r||s&&i&Ue||o&&i&Ne?this.preventSrc(t):void 0},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var pt=1,mt=2,ft=4,vt=8,gt=vt,bt=16,yt=32;K.prototype={defaults:{},set:function(e){return ue(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(s(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=Q(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return s(e,"dropRecognizeWith",this)?this:(e=Q(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(s(e,"requireFailure",this))return this;var t=this.requireFail;return e=Q(e,this),-1===g(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(s(e,"dropRequireFailure",this))return this;e=Q(e,this);var t=g(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function t(t){i.manager.emit(t,e)}var i=this,n=this.state;vt>n&&t(i.options.event+X(n)),t(i.options.event),e.additionalEvent&&t(e.additionalEvent),n>=vt&&t(i.options.event+X(n))},tryEmit:function(e){return this.canEmit()?this.emit(e):void(this.state=yt)},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(yt|pt)))return!1;e++}return!0},recognize:function(e){var t=ue({},e);return d(this.options.enable,[this,t])?(this.state&(gt|bt|yt)&&(this.state=pt),this.state=this.process(t),void(this.state&(mt|ft|vt|bt)&&this.tryEmit(t))):(this.reset(),void(this.state=yt))},process:function(e){},getTouchAction:function(){},reset:function(){}},l(ee,K,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,n=t&(mt|ft),r=this.attrTest(e);return n&&(i&Le||!r)?t|bt:n||r?i&Me?t|vt:t&mt?t|ft:mt:yt}}),l(te,ee,{defaults:{event:"pan",threshold:10,pointers:1,direction:Be},getTouchAction:function(){var e=this.options.direction,t=[];return e&Ue&&t.push(ut),e&Ne&&t.push(dt),t},directionTest:function(e){var t=this.options,i=!0,n=e.distance,r=e.direction,s=e.deltaX,o=e.deltaY;return r&t.direction||(t.direction&Ue?(r=0===s?De:0>s?Re:Ve,i=s!=this.pX,n=Math.abs(e.deltaX)):(r=0===o?De:0>o?Fe:Oe,i=o!=this.pY,n=Math.abs(e.deltaY))),e.direction=r,i&&n>t.threshold&&r&t.direction},attrTest:function(e){return ee.prototype.attrTest.call(this,e)&&(this.state&mt||!(this.state&mt)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=J(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),l(ie,ee,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ct]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&mt)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),l(ne,K,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[at]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,s=e.deltaTime>t.time;if(this._input=e,!n||!i||e.eventType&(Me|Le)&&!s)this.reset();else if(e.eventType&Ee)this.reset(),this._timer=r(function(){this.state=gt,this.tryEmit()},t.time,this);else if(e.eventType&Me)return gt;return yt},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===gt&&(e&&e.eventType&Me?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=ge(),this.manager.emit(this.options.event,this._input)))}}),l(re,ee,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ct]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&mt)}}),l(se,ee,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ue|Ne,pointers:1},getTouchAction:function(){return te.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction;return i&(Ue|Ne)?t=e.overallVelocity:i&Ue?t=e.overallVelocityX:i&Ne&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&i&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&ve(t)>this.options.velocity&&e.eventType&Me},emit:function(e){var t=J(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),l(oe,K,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[lt]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,s=e.deltaTime<t.time;if(this.reset(),e.eventType&Ee&&0===this.count)return this.failTimeout();if(n&&s&&i){if(e.eventType!=Me)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,a=!this.pCenter||L(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,a&&o?this.count+=1:this.count=1,this._input=e;var l=this.count%t.taps;if(0===l)return this.hasRequireFailures()?(this._timer=r(function(){this.state=gt,this.tryEmit()},t.interval,this),mt):gt}return yt},failTimeout:function(){return this._timer=r(function(){this.state=yt},this.options.interval,this),yt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==gt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ae.VERSION="2.0.7",ae.defaults={domEvents:!1,touchAction:ot,enable:!0,inputTarget:null,inputClass:null,preset:[[re,{enable:!1}],[ie,{enable:!1},["rotate"]],[se,{direction:Ue}],[te,{direction:Ue},["swipe"]],[oe],[oe,{event:"doubletap",taps:2},["tap"]],[ne]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var St=1,wt=2;le.prototype={set:function(e){return ue(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?wt:St},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var i,n=this.recognizers,r=t.curRecognizer;(!r||r&&r.state&gt)&&(r=t.curRecognizer=null);for(var s=0;s<n.length;)i=n[s],t.stopped===wt||r&&i!=r&&!i.canRecognizeWith(r)?i.reset():i.recognize(e),!r&&i.state&(mt|ft|vt)&&(r=t.curRecognizer=i),s++}},get:function(e){if(e instanceof K)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(s(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(s(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,i=g(t,e);-1!==i&&(t.splice(i,1),this.touchAction.update())}return this},on:function(e,t){if(e!==n&&t!==n){var i=this.handlers;return o(v(e),function(e){i[e]=i[e]||[],i[e].push(t)}),this}},off:function(e,t){if(e!==n){var i=this.handlers;return o(v(e),function(e){t?i[e]&&i[e].splice(g(i[e],t),1):delete i[e]}),this}},emit:function(e,t){this.options.domEvents&&de(e,t);var i=this.handlers[e]&&this.handlers[e].slice();if(i&&i.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](t),n++}},destroy:function(){this.element&&ce(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},ue(ae,{INPUT_START:Ee,INPUT_MOVE:ze,INPUT_END:Me,INPUT_CANCEL:Le,STATE_POSSIBLE:pt,STATE_BEGAN:mt,STATE_CHANGED:ft,STATE_ENDED:vt,STATE_RECOGNIZED:gt,STATE_CANCELLED:bt,STATE_FAILED:yt,DIRECTION_NONE:De,DIRECTION_LEFT:Re,DIRECTION_RIGHT:Ve,DIRECTION_UP:Fe,DIRECTION_DOWN:Oe,DIRECTION_HORIZONTAL:Ue,DIRECTION_VERTICAL:Ne,DIRECTION_ALL:Be,Manager:le,Input:_,TouchAction:j,TouchInput:B,MouseInput:F,PointerEventInput:O,TouchMouseInput:W,SingleTouchInput:U,Recognizer:K,AttrRecognizer:ee,Tap:oe,Pan:te,Swipe:se,Pinch:ie,Rotate:re,Press:ne,on:h,off:p,each:o,merge:ye,extend:be,assign:ue,inherit:l,bindFn:c,prefixed:S});var It="undefined"!=typeof e?e:"undefined"!=typeof self?self:{};It.Hammer=ae,"function"==typeof define&&define.amd?define("hammer",[],function(){return ae}):"undefined"!=typeof module&&module.exports?module.exports=ae:e[i]=ae}(window,document,"Hammer"),define("spinViewer/Controller",["ko","$","utils/deviceHelper","utils/sizeHelper","utils/ImageScaler","utils/ImageZoomer","hammer"],function(e,t,i,n,r,s,o){"use strict";var a=function(n,r,s,o,a,l){this.assetsProvider=n,this.imageLoader=r,this.loadedAssets=null,this.events=l,this.containers=a,this.params={showCloseButton:!1,showHint:!1,spinSpeed:1,maxPixelRatio:1.5,hintDisplayTime:3e3,preloadingTimeout:0,handleLoadingErrors:!0,framesCachingQueueInterval:35,useInitialAnimation:!1,animationFramesCount:-1,animationIntervalStart:40,animationIntervalPeak:5},this.viewModel=o,this.updateZoomerDummy=e.observable(!1),this.initState=this.INIT_STATE.NotInitialized,this.frames=[[]],this.lastInitArguments=null,this.currentRowIndex=e.observable(0),this.currentFrameIndex=e.observable(),t.extend(!0,this.params,s),this.params.devicePixelRatio=Math.min(i.getDevicePixelRatio(this.containers.window),this.params.maxPixelRatio),this.isPannable=e.computed(this.isPannable,this),this.hasError=e.observable(!1),this.getCurrentZoomer=e.computed(this.getCurrentZoomer,this),this.setEventListeners(),this.viewModel.isPannable(this.isPannable()),this.viewModel.isCloseButtonVisible(this.params.showCloseButton)};return a.prototype.MIN_GESTURE_RECOGNIZE_DISTANCE=10,a.prototype.INIT_STATE={NotInitialized:0,Initializing:1,Initialized:2},a.prototype.init=function(e,t){return this.initState!==this.INIT_STATE.Initializing?(t&&t.initImage&&(t=t.initImage.image),this.lastInitArguments=arguments,this.updateSpinContainerSize(),this.targetSize=this.getContainerInitialTargetSize(),t?(this.setInitialImage(t),this.initState=this.INIT_STATE.Initialized,void this.showFrame(0,0,!0)):this.initState!==this.INIT_STATE.Initialized?(this.initState=this.INIT_STATE.Initializing,void this.preloadImages(0,0)):void this.resize(function(){this.showFrame(0,0,!0)}.bind(this))):void 0},a.prototype.isVisible=function(){return"none"!==window.getComputedStyle(this.containers.spin).display},a.prototype.setInitialImage=function(e){var t=this.getZoomer(0,0);t.options.baseUrl=this.loadedAssets.frameUrls[0][0],t.zoomReset(null,!0),e.className="img",t.setPlaceholderImage(e)},a.prototype.updateSpinContainerSize=function(){this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.spinContainerSize={width:this.spinContainerRect.width,height:this.spinContainerRect.height}},a.prototype.isPannable=function(){var e=this.getCurrentZoomer();return e&&e.canZoomOut()},a.prototype.close=function(){this.zoomReset(),this.events.trigger("playerExitRequested")},a.prototype.zoomIn=function(e,t,i){var n=this.getCurrentZoomer();return n&&(e||n.canZoomIn())?(this.events.trigger("zoomedIn"),this.imageLoader.cancelAllLoadRequests(),void n.zoomIn(e,t,i)):void("function"==typeof i&&i())},a.prototype.zoomReset=function(e){var t=this.getCurrentZoomer();return t?(this.imageLoader.cancelAllLoadRequests(),void t.zoomReset(e)):void("function"==typeof e&&e())},a.prototype.zoomOut=function(e,t){var i=this.getCurrentZoomer();return i&&i.canZoomOut()?(this.imageLoader.cancelAllLoadRequests(),void i.zoomOut(focalPointInContainer,t)):void("function"==typeof t&&t())},a.prototype.getEventPositionRelativeToTarget=function(e,t){return{x:(e.center?e.center.x:e.clientX)-t.left,y:(e.center?e.center.y:e.clientY)-t.top}},a.prototype.resize=function(e){if(this.isVisible()){var t,i=this.frames.length*this.frames[0].length,n=function(){i--,i||"function"==typeof e&&e()};if(this.updateSpinContainerSize(),!i)return void("function"==typeof e&&e());for(var r=0;r<this.frames.length;r++)for(var s=0;s<this.frames[r].length;s++){
var o=this.getOutputBaseSize();t=this.frames[r][s],t.resize(!0,{containerSize:this.spinContainerSize,outputBaseSize:o,imageScalersOptions:this.getImageScalersOptions(o)},n)}}},a.prototype.animationIntervalEasing=function(e,t){var i=this.params.animationIntervalPeak-this.params.animationIntervalStart,n=(Math.sin(2*Math.PI*e/t-Math.PI/2)+1)/2;return this.params.animationIntervalStart+n*i},a.prototype.refresh=function(){this.init.apply(this,this.lastInitArguments)},a.prototype.animateSpin=function(e,t,i,n){var r=e,s=0,o=t>e?t-e:this.frames[this.currentRowIndex()].length+t-e,a=function(){return this.showFrame(this.currentRowIndex(),r,!0),r===t?void("function"==typeof n&&n()):(r++,s++,r>=this.frames[this.currentRowIndex()].length&&(r=0),void setTimeout(a,i(s,o)))}.bind(this);a()},a.prototype.getZoomer=function(e,t){var i,n=this.getOutputBaseSize(),r=this.getImageScalersOptions(n);return this.frames[e]=this.frames[e]||[],i=this.frames[e][t],i||(i=this.createZoomer(),this.frames[e][t]=i,this.updateZoomerDummy(!this.updateZoomerDummy())),i.inputImageScaler.options.baseSize=r.inputImageScalerOptions.baseSize,i.inputImageScaler.options.maxSize=r.inputImageScalerOptions.maxSize,i.resize(!1,{containerSize:this.spinContainerSize,outputBaseSize:n,imageScalersOptions:r}),i},a.prototype.getImageScalersOptions=function(e){var t={width:this.loadedAssets.maxSize.width,height:this.loadedAssets.maxSize.height},i={width:Math.min(this.loadedAssets.maxSize.width,this.targetSize.width*this.params.devicePixelRatio),height:Math.min(this.loadedAssets.maxSize.height,this.targetSize.height*this.params.devicePixelRatio)},n=e,r={width:Math.max(e.width,this.loadedAssets.maxSize.width/this.params.devicePixelRatio),height:Math.max(e.height,this.loadedAssets.maxSize.height/this.params.devicePixelRatio)};return{inputImageScalerOptions:{baseSize:i,maxSize:t},outputImageScalerOptions:{baseSize:n,maxSize:r}}},a.prototype.createZoomer=function(e){var t=document.createElement("div"),i=this.getOutputBaseSize(),n=this.getImageScalersOptions(i),o=new r(n.inputImageScalerOptions),a=new r(n.outputImageScalerOptions);t.className="amp-frame";var l=new s(this.imageLoader,o,a,{baseUrl:e,zoomFactors:this.params.zoomFactors,container:t,containerSize:this.spinContainerSize,outputBaseSize:i,devicePixelRatio:this.params.devicePixelRatio,baseJpgQlt:this.params.baseJpgQlt,zoomJpgQlt:this.params.zoomJpgQlt});return l},a.prototype.getContainerInitialTargetSize=function(){var e=n.getProportionalSize({width:this.spinContainerSize.width,height:this.spinContainerSize.height},this.loadedAssets.maxSize);return this.params.initialSize&&(e.width=this.params.initialSize.width,e.height=this.loadedAssets.maxSize.height*e.width/this.loadedAssets.maxSize.width),e},a.prototype.getOutputBaseSize=function(){return n.getProportionalSize(this.spinContainerSize,this.loadedAssets.maxSize)},a.prototype.preloadImages=function(e,t,i){this.viewModel.loadingPercentage(0),this.hasError(!1);var n,r=null,s=!1,o=[],a=null,l=function(e){var t=o.pop();return t?(this.showFrame(t.rowIndex,t.frameIndex,!0),m--,void this.viewModel.loadingPercentage(Math.floor(100*(n-m)/n))):void(p||(clearInterval(a),a=null,"function"==typeof e&&e()))},c=function(){s=!0,p--,m--,p||(clearTimeout(r),r=null,clearInterval(a),a=null,this.hasError(!0),this.initState=this.INIT_STATE.NotInitialized)},d=function(){if(clearTimeout(r),r=null,this.hasError(s),s)return this.events.trigger("allImagesLoaded",!1),void(this.initState=this.INIT_STATE.NotInitialized);this.events.trigger("allImagesLoaded",!0);var i=this.frames[e].length,n=t,o=(i+t-1)%i;return!this.params.showHint||window.sessionStorage&&window.sessionStorage.getItem("spinViewerHintDisplayed")||(this.viewModel.isHintVisible(!0),setTimeout(function(){this.viewModel.isHintVisible(!1),window.sessionStorage&&window.sessionStorage.setItem("spinViewerHintDisplayed",!0)}.bind(this),this.params.hintDisplayTime)),this.params.useInitialAnimation?(n=(i+t-this.params.animationFramesCount)%i,o=t,this.showFrame(e,n,!0),this.viewModel.isLoadingPageVisible(!1),void this.animateSpin(n,o,this.animationIntervalEasing.bind(this),function(){this.initState=this.INIT_STATE.Initialized,this.showFrame(e,t,!0)}.bind(this))):(this.viewModel.isLoadingPageVisible(!1),this.initState=this.INIT_STATE.Initialized,void this.showFrame(e,t,!0))},u=function(e,t,i){i.applyPosition(),p--,n>1&&o.push({rowIndex:e,frameIndex:t})},h=function(e,t,i){i.loadImage(this.loadedAssets.frameUrls[e][t],i.options.container,i.inputImageScaler.options.baseSize,i.options.outputBaseSize,u.bind(this,e,t,i),this.params.handleLoadingErrors?c.bind(this):u.bind(this,e,t,i),null,null,1===n,this.params.baseJpgQlt)};n=this.loadedAssets.frameUrls.length*this.loadedAssets.frameUrls[0].length;var p=n,m=n;n>1&&this.viewModel.isLoadingPageVisible(!0),a=setInterval(l.bind(this,d.bind(this)),this.params.framesCachingQueueInterval),this.imageLoader.cancelAllLoadRequests(),this.params.handleLoadingErrors&&this.params.preloadingTimeout&&(r=setTimeout(function(){clearInterval(a),a=null,this.imageLoader.cancelAllLoadRequests(),this.hasError(!0),this.initState=this.INIT_STATE.NotInitialized}.bind(this),this.params.preloadingTimeout));for(var f=0;f<this.loadedAssets.frameUrls.length;f++)for(var v=0;v<this.loadedAssets.frameUrls[f].length;v++){var g=this.getZoomer(f,v);g.options.baseUrl=this.loadedAssets.frameUrls[f][v],h.call(this,f,v,g)}},a.prototype.getCurrentZoomer=function(){return this.updateZoomerDummy(),this.currentRowIndex()<this.frames.length&&this.frames[this.currentRowIndex()]&&this.currentFrameIndex()<this.frames[this.currentRowIndex()].length?this.frames[this.currentRowIndex()][this.currentFrameIndex()]:null},a.prototype.getCurrentFrame=function(){return{rowIndex:this.currentRowIndex(),frameIndex:this.currentFrameIndex(),zoomer:this.getCurrentZoomer()}},a.prototype.showFrame=function(e,t,i){if((i||this.initState===this.INIT_STATE.Initialized)&&(e!=this.currentRowIndex()||t!=this.currentFrameIndex())){this.currentRowIndex(e),this.currentFrameIndex(t);for(var n=this.getCurrentFrame();this.containers.images.lastChild;)this.containers.images.removeChild(this.containers.images.lastChild);this.containers.images.appendChild(n.zoomer.options.container),this.events.trigger("frameShown",n)}},a.prototype.loadFullImage=function(e,t){e.fullImageStatus=e.FULL_IMAGE_STATUS.Loading;var i=(e.getCurrentImageDisplaySize(),e.getOutputImageSize(e.options.zoomFactors.length-1)),n=e.getZoomedImageBox(e.currentSize,e.currentPosition,i,t);e.loadImage(this.loadedAssets.frameUrls[this.currentRowIndex()][this.currentFrameIndex()],e.options.container,e.getInputImageSize(e.options.zoomFactors.length-1),i,function(){e.applyPosition(),e.fullImageStatus=e.FULL_IMAGE_STATUS.Loaded},function(){e.fullImageStatus!==e.FULL_IMAGE_STATUS.Loaded&&(e.fullImageStatus=e.FULL_IMAGE_STATUS.NotLoaded)},n.focalPointOnSourceImage,null,!0,this.params.zoomJpgQlt)},a.prototype.setEventListeners=function(){this.viewModel.events.on("closeButtonClicked",this.close.bind(this)),this.viewModel.events.on("refreshButtonClicked",function(){this.refresh(),this.events.trigger("refreshButtonClicked")}.bind(this)),t(window).resize(function(){if(this.initState===this.INIT_STATE.Initialized){var e=this.containers.spin.getBoundingClientRect();e.width===this.spinContainerRect.width&&e.height===this.spinContainerRect.height||this.resize()}}.bind(this));var e,i,n,r,s=new o(this.containers.root),a=s.get("pinch"),l=s.get("pan"),c=s.get("doubletap"),d=null,u=!1,h=function(e,t){var r=this.getCurrentZoomer();if(r.canZoomOut())return void r.moveBy(t);if(this.frames.length>1||this.frames[this.currentRowIndex()].length>1){var s=this.getRemoteRowIndex(i,this.getMatrixShift(this.params.reverseVerticalDirection,e.y,this.frames.length,this.spinContainerSize.height)),o=this.getRemoteFrameIndex(n,this.getMatrixShift(this.params.reverseHorizontalDirection,e.x,this.frames[0].length,this.spinContainerSize.width));s===this.currentRowIndex()&&o===this.currentFrameIndex()||(this.events.trigger("spun"),this.showFrame(s,o))}}.bind(this),p=function(){l.set({threshold:this.MIN_GESTURE_RECOGNIZE_DISTANCE}),l.set({direction:this.isPannable()?o.DIRECTION_ALL:o.DIRECTION_HORIZONTAL}),l.set({enable:this.isPannable()||this.frames[this.currentRowIndex()].length>1})}.bind(this),m=function(t){if(this.initState===this.INIT_STATE.Initialized){t.preventDefault(),t.stopPropagation();var i=this.getCurrentZoomer(),n=t.detail<0||t.wheelDelta>0?1:-1,r=1+.1*n;this.spinContainerRect=this.containers.spin.getBoundingClientRect(),i.fullImageStatus===i.FULL_IMAGE_STATUS.NotLoaded&&this.loadFullImage.call(this,i,this.getEventPositionRelativeToTarget(t,this.spinContainerRect)),e=i.getCurrentImageDisplaySize(),i.scale(e,r,this.getEventPositionRelativeToTarget(t,this.spinContainerRect),u)}}.bind(this);p(),c.set({interval:500,time:500,threshold:this.MIN_GESTURE_RECOGNIZE_DISTANCE,posThreshold:100}),this.isPannable.subscribe(function(e){this.viewModel.isPannable(e),p()}.bind(this)),s.on("hammer.input",function(e){return e.distance<this.MIN_GESTURE_RECOGNIZE_DISTANCE&&(d=null),null===d&&e.distance>=this.MIN_GESTURE_RECOGNIZE_DISTANCE&&(d=!this.isPannable()&&1===e.pointers.length&&(e.direction&o.DIRECTION_VERTICAL)>0),d?void s.stop():void a.set({enable:e.pointers.length>1})}.bind(this)),s.on("tap",function(e){this.initState===this.INIT_STATE.Initialized&&"mouse"===e.pointerType&&(this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.zoomIn(!0,this.getEventPositionRelativeToTarget(e,this.spinContainerRect)))}.bind(this)),s.on("doubletap",function(e){e.preventDefault(),e.srcEvent.stopPropagation(),this.initState===this.INIT_STATE.Initialized&&"mouse"!==e.pointerType&&(this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.zoomIn(!0,this.getEventPositionRelativeToTarget(e,this.spinContainerRect)))}.bind(this)),s.on("panstart",function(e){r=e,n=this.currentFrameIndex(),i=this.currentRowIndex()}.bind(this)),s.on("pan",function(e){if(this.initState===this.INIT_STATE.Initialized){e.preventDefault(),e.srcEvent.stopPropagation(),n=n||this.currentFrameIndex(),i=i||this.currentRowIndex(),r=r||e;var t={x:e.deltaX-r.deltaX,y:e.deltaY-r.deltaY},s={x:e.deltaX,y:e.deltaY};r=e,h(s,t)}}.bind(this)),s.on("panend",function(e){r=e,n=this.currentFrameIndex(),i=this.currentRowIndex()}.bind(this)),s.on("pinchstart",function(t){if(this.initState===this.INIT_STATE.Initialized){var i=this.getCurrentZoomer();i.fullImageStatus===i.FULL_IMAGE_STATUS.NotLoaded&&(this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.loadFullImage.call(this,i,this.getEventPositionRelativeToTarget(t,this.spinContainerRect))),e=i.getCurrentImageDisplaySize(),l.set({enable:!1})}}.bind(this)),s.on("pinch",function(t){t.preventDefault(),t.srcEvent.stopPropagation(),this.initState===this.INIT_STATE.Initialized&&this.getCurrentZoomer().scale(e,t.scale,this.getEventPositionRelativeToTarget(t,this.spinContainerRect),u)}.bind(this)),s.on("pinchend",function(){this.initState===this.INIT_STATE.Initialized&&p()}.bind(this)),this.containers.spin.addEventListener("mousewheel",m),this.containers.spin.addEventListener("DOMMouseScroll",m),this.hasError.subscribe(function(e){this.viewModel.isErrorPageVisible(e)}.bind(this))},a.prototype.getMatrixShift=function(e,t,i,n){var r=(e?-1:1)*this.params.spinSpeed*t*i/n;return r>0?Math.floor(r):Math.ceil(r)},a.prototype.getRemoteFrameIndex=function(e,t){var i=(e+t)%this.frames[0].length;return 0>i&&(i=this.frames[0].length+i),i},a.prototype.getRemoteRowIndex=function(e,t){var i=(e+t)%this.frames.length;return 0>i&&(i=this.frames.length+i),i},a.prototype.loadAssets=function(e,t,i){this.initState=this.INIT_STATE.NotInitialized,this.loadedAssets=null,this.assetsProvider.getAssets(e,function(e){return e.maxSize.width&&e.maxSize.height?(this.loadedAssets=e,void("function"==typeof t&&t(e))):void("function"==typeof i&&i())}.bind(this),i)},a.prototype.setAssets=function(e){this.initState=this.INIT_STATE.NotInitialized,this.loadedAssets=e},a}),define("bindings/fadeVisible",["ko","$"],function(e,t){"use strict";function i(){}return i.prototype.init=function(i,n){var r=n();t(i).toggle(e.unwrap(r))},i.prototype.update=function(i,n){var r=n();e.unwrap(r)?t(i).fadeIn():t(i).fadeOut()},e.bindingHandlers.fadeVisible=new i,e.bindingHandlers.fadeVisible}),define("spinViewer/component",["$","spinViewerView","utils/scene7.config","utils/scene7.ImageLoader","utils/scene7.DataProvider","spinViewer/DataProvider","spinViewer/AssetsProvider","spinViewer/ViewModel","spinViewer/Controller","bindings/fadeVisible"],function(e,t,i,n,r,s,o,a,l){"use strict";return{viewModel:{createViewModel:function(t,c){var d=e({}),u=e({}),h={window:window,root:c.element,spin:c.element.querySelector(".amp-spin"),images:c.element.querySelector(".amp-spin .amp-images")},p=new i(t.scene7.imageServer,t.scene7.videoServer),m=new r(p),f=new s(p,m),v=new o(f),g=new n(p,t.viewer.useCors),b=new a(d,t.messages);t.viewer.zoomFactors.container&&(t.viewer.zoomFactors=t.viewer.zoomFactors.container);var y=new l(v,g,t.viewer,b,h,u),S={setAssets:y.setAssets.bind(y),loadAssets:y.loadAssets.bind(y),init:y.init.bind(y),zoomIn:y.zoomIn.bind(y),zoomOut:y.zoomOut.bind(y),zoomReset:y.zoomReset.bind(y),events:y.events};return t.api(S),b}},template:t,synchronous:!0}}),define("Asos.Utils.MediaPlayers",["videoPlayer/component","videoPlayer/DataMapper","videoPlayer/AssetsProvider","spinViewer/component","utils/scene7.config","utils/scene7.DataProvider","spinViewer/DataProvider","spinViewer/AssetsProvider"],function(e,t,i,n,r,s,o,a){"use strict";function l(){this.videoPlayer=e,this.spinViewer=n}return l.prototype.getSpinViewerAssetsProvider=function(e){var t=new r(e),i=new s(t),n=new o(t,i);return new a(n)},l.prototype.getVideoPlayerAssetsProvider=function(e){var n=new r(null,e),o=new s(n),a=new t(n);return new i(n,o,a)},new l}),define("ProductUtils/Cookies",["Utils"],function(e){return function(){this.getXSiteOrigin=function(){var t=e.Cookies.readCookie("x-site-origin",!0);return t?t:null}}}),define("ProductUtils/NewRelicLogger",["PageConfig"],function(e){var t=function(){var t;this.init=function(e){t=e},this.logError=function(i,n){window.newrelic&&(n.pageVersion=e.version,n.pageUrl=window.location.href,n.pageType=t,window.newrelic.addPageAction(i.message,n))}};return t.prototype.PAGE_TYPE={PRD:"ProductPage.SingleProduct",GRP:"ProductPage.MixAndMatch"},t.prototype.ERROR_TYPE={AjaxError:"Ajax Error",ParseError:"Parse Error",UserActionFailed:"User Action Failed"},new t}),define("asos-web-seo-path",[],function(){"use strict";function e(e){return Object.values(e).map(function(e){var t=s.find(function(t){return t[0]===e});return t?t[1]:e}).join("")}function t(e){return Object.values(e.normalize("NFD")).map(function(e){return e.match(/[0-9A-Za-z \-\/.]/g)?e:void 0}).join("").normalize("NFC")}function i(e){return t(e.trim()).replace(/\//g,"-").replace(/\s/g,"-").replace(/-+/g,"-").replace(/\./g,"").replace(/^-/,"").replace(/-$/,"").toLowerCase()}function n(t,i,n){var r=t,s=i;return n&&"ru-ru"===n.toLowerCase()&&(r=e(t),s=e(i)),{romanProductName:r,romanBrandName:s}}function r(e){return function(t,r,s){if("function"!=typeof"".normalize)return"";if(!t)return e&&e.error("createSeoPath - productName was not passed in"),"";var o=n(t,r,s),a=o.romanProductName,l=o.romanBrandName,c=i(a),d=i(l);return"".concat(d,"/").concat(c)}}var s=[["","A"],["","a"],["","B"],["","b"],["","V"],["","v"],["","G"],["","g"],["","D"],["","d"],["","E"],["","e"],["","Yo"],["","yo"],["","Zh"],["","zh"],["","Z"],["","z"],["","I"],["","i"],["","J"],["","j"],["","K"],["","k"],["","L"],["","l"],["","M"],["","m"],["","N"],["","n"],["","O"],["","o"],["","P"],["","p"],["","R"],["","r"],["","S"],["","s"],["","T"],["","t"],["","U"],["","u"],["","F"],["","f"],["","H"],["","h"],["","Ts"],["","ts"],["","Ch"],["","ch"],["","Sh"],["","sh"],["","Sch"],["","sch"],["",""],["",""],["","Y"],["","y"],["",""],["",""],["","E"],["","e"],["","Yu"],["","yu"],["","Ya"],["","ya"]];return r}),define("ProductUtils/UrlUtils",["PageConfig","ProductUtils/NewRelicLogger","asos-web-seo-path"],function(e,t,i){return function(){var n=i();this.formatUrl=function(e){return e?"http"===e.substring(0,4)?e.replace("http:","https:"):"/"===e.substring(0,1)?e:"//"+e:e},this.getUrlParam=function(e,t){t||(t=location.href),e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var i="[\\?&]"+e+"=([^&#]*)",n=new RegExp(i),r=n.exec(t);return null===r?null:r[1]},this.getVariantFromUrl=function(e,t){var i=e.split("?")[0];if(i=void 0!==i&&null!==i?i.split("/prd/"):null,i.length>0&&(i=parseInt(i[1])),i||(i=parseInt(this.getUrlParam("iid",e))),!i)return null;for(var n=0;n<t.length;n++)if(t[n].variantId===i)return t[n];return null},this.getProductUrl=function(i,r,s){if(!s)return t.logError(new TypeError("ProductId was not provided")),e.siteDomain;var o="";return i&&r?o="/"+n(i,r,e.language):t.logError(new TypeError("missing brand name or product name, returning generic link"),{productId:s}),e.siteDomain+o+"/prd/"+s}}}),define("ProductUtils/Ajax",["$","uuid","ProductUtils/Cookies","ProductUtils/NewRelicLogger","ProductUtils/UrlUtils"],function(e,t,i,n,r){return function(){function s(e,t){if(!t)return e;var i="";return Object.keys(t).sort().forEach(function(n){var r=t[n];void 0!==r&&null!==r&&(e.indexOf(n+"=")>-1||(i+="&"+n+"="+r))}),-1===e.indexOf("?")&&(i="?"+i.slice(1)),e+i}this.execute=function(t){var o,a,l="ProductPage",c=new i,d=new r;t.callerContext?l+="."+t.callerContext:l=!1,a=void 0!==t.retryCount?t.retryCount:null,o=void 0!==t.authorization?t.authorization:null,void 0===t.cache&&(t.cache=!0);var u=s(t.url,t.storeParams),h={},p=d.getUrlParam("x-site-origin")||c.getXSiteOrigin();return p&&(h["x-site-origin"]=p),e.ajax({cache:t.cache,url:u,data:h,tryCount:0,retryLimit:a,dataType:t.dataType,jsonpCallback:t.jsonpCallback,beforeSend:function(e){this.addRequestHeaders(e,l,o)}.bind(this),success:function(e){this.successRequest(t.successCallback,e,t.callbackArgs)}.bind(this),error:function(i){return n.logError(new Error(n.ERROR_TYPE.AjaxError),{apiName:t.apiName,requestUrl:u,status:i.status,caller:t.callerContext,response:i.response,xSiteOrigin:p,requestHeaders:i.headers,responseHeaders:i.getAllResponseHeaders()}),null!==this.retryLimit&&this.tryCount<=this.retryLimit?(this.tryCount++,void e.ajax(this)):void this.errorRequest(t.errorCallback,i,t.callbackArgs)}.bind(this)})},this.addRequestHeaders=function(e,i,n){if(e.headers={},i!==!1){var r=t();e.setRequestHeader("asos-c-name",i),e.setRequestHeader("asos-cid",r),e.headers["asos-c-name"]=i,e.headers["asos-cid"]=r}null!==n&&(e.setRequestHeader("Authorization",n),e.headers.Authorization=n)},this.successRequest=function(e,t,i){e&&e(t,i)},this.errorRequest=function(e,t,i){e&&e(t,i)}}}),define("ProductUtils/StockPrice",["$","ProductUtils/Ajax","Product.Config","PageConfig"],function(e,t,i,n){return function(){this.ajax=new t,this.getStockPrice=function(e,t,i){if(void 0!==e&&null!==e){var n=window.asos&&window.asos.pdp.stockPrice;if(n)return void this.successRequest.call(this,n,{callback:t,products:e});var r=void 0===e.products?e.id:e.productIds;this.requestData(e,t,r,i)}},this.requestData=function(e,t,r,s){this.ajax.execute({storeParams:{store:n.storeCode,currency:n.currency,keyStoreDataversion:n.keyStoreDataversion},url:i.stockPriceUrl+r,apiName:"Product Catalogue",callerContext:"StockPrice",successCallback:this.successRequest.bind(this),errorCallback:s,retryCount:5,callbackArgs:{callback:t,products:e}})},this.successRequest=function(e,t){var i=this.combineData(t.products,e),n=void 0===i.productIds?i.isInStock:!0;this.setStockClass(n),t.callback(i)},this.combineData=function(e,t){var i,n=void 0!==e.products,r=this.createVariantMap(e,n);if(n){for(var s={},o=0;o<e.products.length;o++)s[e.products[o].id]=o;var a=[];a.length=t.length;for(var l=0;l<t.length;l++){var c=s[t[l].productId];a[c]=t[l]}for(var d=0;d<e.products.length;d++)e.products[d]=this.mergeJsons(e.products[d],a[d]);i=e;for(var u=[],h=0;h<e.products.length;h++)u.push(this.mapVariantData(e.products[h],i.products[h],r[e.products[h].productId]));return i.products=u,i}return r=r[e.id],i=this.mergeJsons(e,t[0]),this.mapVariantData(e,i,r)},this.mapVariantData=function(e,t,i){for(var n=!1,r=0;r<e.variants.length;r++)n||(n=t.variants[r].isInStock),t.variants[r].size=i[t.variants[r].id].size,t.variants[r].sizeOrder=i[t.variants[r].id].sizeOrder,t.variants[r].colour=i[t.variants[r].id].colour,t.variants[r].colourWayId=i[t.variants[r].id].colourWayId,t.variants[r].isPrimary=i[t.variants[r].id].isPrimary,t.variants[r].sizeId=i[t.variants[r].id].sizeId,t.variants[r].productImage=void 0!==e.productImage?e.productImage.url:"";return t.isInStock=n,t},this.createVariantMap=function(e,t){var i=[];if(t)for(var n=0;n<e.products.length;n++)i[e.products[n].id]=[],i=this.loopVariants(e.products[n],i);else i[e.id]=[],i=this.loopVariants(e,i);return i},this.loopVariants=function(e,t){for(var i=0;i<e.variants.length;i++){var n=e.variants[i].variantId;t[e.id][n]=e.variants[i]}return t},this.mergeJsons=function(e,t){var i=JSON.parse(JSON.stringify(e)),n=JSON.parse(JSON.stringify(t));for(var r in n)try{i[r]=n[r]}catch(s){console.warn("couldn't merge JSONS: "+s)}return i},this.setStockClass=function(t){var i=t?"pg-in-stock":"pg-out-of-stock";e(".asos-product").hasClass("pg-out-of-stock")||e(".asos-product").hasClass("pg-out-of-stock")||e(".asos-product").addClass(i)}}}),define("Models/VariantDecorator",[],function(){return function(){var e=this;e.getData=function(e,t){t=void 0===t?!1:t;var i=void 0!==e.productImage?[e.productImage]:e.images,n={};if(i)for(var r=0;r<i.length;r++){var s=i[r];if(s.colourWayId){var o=n[s.colourWayId];void 0===o&&(n[s.colourWayId]=s.colour)}}var a=e.variants;a.sort(function(e,t){var i=t.colour.localeCompare(e.colour);return 0===i?t.sizeOrder-e.sizeOrder:i});var l,c=e.productId?e.productId:e.id,d=a.length,u=[],h={productId:c,colours:[],rrpPrice:void 0,maxPrevPrice:void 0,minPrice:void 0,isInStock:!1},p=0;for(a.length>0&&a[0].price.isOutletPrice&&(h.rrpPrice=a[0].price.rrp);d--;){var m=a[d];m.productId=c,void 0===h.hasDifferentPrices&&m.isInStock&&(void 0===l?l=m.price.current:m.price.current.value!==l.value&&(h.hasDifferentPrices=!0));var f=t||m.isInStock;f&&(void 0===h.minPrice||h.minPrice.value>m.price.current.value)&&(h.minPrice=m.price.current);var v=m.isInStock;m.colourName=n[m.colourWayId];var g=u[m.colour];void 0===g&&(h.colours.push({colour:m.colour,colourName:m.colourName,variants:[],colourWayId:m.colourWayId}),g=u[m.colour]={index:p,variantsInStock:0},p++),v&&(g.variantsInStock++,h.isInStock||(h.isInStock=!0));var b=h.colours[g.index];b.variants.push(m),(void 0===g.lowestPrice||g.lowestPrice.value>m.price.current.value)&&(g.lowestPrice=m.price.current),void 0===h.rrpPrice&&m.price.isMarkedDown&&(void 0===g.maxPreviousPrice||g.maxPreviousPrice.value<m.price.previous.value)&&(g.maxPreviousPrice=m.price.previous)}for(var y=Object.keys(u),S=y.length-1;S>=0;S--){var w=u[y[S]];if(t||0!==w.variantsInStock){var I=h.colours[S];void 0!==w.maxPreviousPrice&&(void 0===h.maxPrevPrice||h.maxPrevPrice.value<w.maxPreviousPrice.value)&&(h.maxPrevPrice=w.maxPreviousPrice),I.price=w.lowestPrice,I.prevPrice=w.maxPreviousPrice}else h.colours.splice(w.index,1)}return h}}}),define("text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("text!Components/product-image/product-image.html",[],function(){return'<div class="grid-row">\r\n    <img data-bind="attr: { src: imgUrl }"/>\r\n    <div data-bind=\'component:{\r\n            name: "save-button",\r\n            params:{\r\n                productId: productId,\r\n                state: state,\r\n                productImage : imgUrl,\r\n                context : context\r\n                  }\r\n           }\'></div>\r\n</div>\r\n'}),define("Models/RecentlyViewedStorage",[],function(){return function(){function e(){var e=new Date;return e.setHours(0,0,0,0),e.setDate(e.getDate()+o),e}function t(e,t){for(var i=0;i<e.length;i++)if(e[i].id===t)return{item:e[i],index:i};return null}function i(e){this.localStorageSupported&&r.setItem(n,JSON.stringify(e))}var n="RecentlyViewed",r=window.localStorage,s=25,o=30;return this.localStorageSupported=!0,this.ProductItem=function(e,t,i,n,r,s){this.id=e,this.img=t,this.url=i,this.title=n,this.mixMatch=r,this.colourWayId=s},this.checkLocalStorageSupport=function(){if("object"==typeof localStorage)try{localStorage.setItem("testStorage",1),localStorage.removeItem("testStorage")}catch(e){this.localStorageSupported=!1}},this.checkLocalStorageSupport(),this.addItem=function(n){var r=this.getItems(),o=t(r,n.id);n.expiryDate=e(),null!==o&&void 0!==o?(r.splice(o.index,1),r.splice(0,0,n)):(r.length===s&&r.splice(-1,1),r.splice(0,0,n)),i(r)},this.removeItem=function(e){var n=this.getItems(),r=t(n,e);void 0!==r&&null!==r&&(n.splice(r.index,1),i(n))},this.getItems=function(){var e=null;if(this.localStorageSupported&&(e=r.getItem(n)),null===e)return[];var t=new Date,s=JSON.parse(e),o=s.filter(function(e){return void 0===e.expiryDate||null===e.expiryDate||new Date(e.expiryDate)>t});return o.length!==s.length&&i(o),o},this.setExpiryInDays=function(e){void 0!==e&&null!==e&&!isNaN(e)&&parseInt(e)&&(o=e)},this.getExpiryInDays=function(){return o},this.clear=function(){i([])},this}()}),define("ProductUtils/features/manifest",[],function(){return{features:{},mvt:{"t1280-web-selling-fast":{},"t1270-web-fit-assistant-redesign":{}}}}),define("ProductUtils/features/features",["asos-web-features","./manifest"],function(e,t){var i=e["default"].getInstance();return i.addManifest(t,{}),i}),define("ProductUtils/Analytics",["$","ProductUtils/UrlUtils","Models/RecentlyViewedStorage","PageConfig","ProductUtils/features/features"],function(e,t,i,n,r){var s=function(){this.url=new t,this.log=this.url.getUrlParam("analytics"),this.base="tracking.productPage.";var s=this;window.product=[],this.applyStandardEventData=function(t){var i={keyStoreDataVersion:n.keyStoreDataversion,selectedCountry:n.countryCode,selectedCurrency:n.currency,selectedLanguage:n.language,selectedSizeSchema:n.sizeSchema,sitechromeTemplateVersion:n.siteChromeTemplateVersion},r=e.extend({},t,i);return r},this.fireEvent=function(t,i,n){var r=this.applyStandardEventData(i),s=(n?"":this.base)+t;"true"===this.log&&console.log(s,r),e(window).trigger(s,r)};var o={entryScreen_landed:1,entryScreen_submit:2,entryScreen_tooltip:3,immediateRecommendation_upper:11,immediateRecommendation_lower:12,immediateRecommendation_shoes:13,bcScreen_landed:14,bcScreen_skip:15,bcScreen_submit:16,lbwBcScreen_landed:17,lbwBcScreen_skip:18,lbwBcScreen_submit:19,managePurchasesScreen_landed:20,managePurchasesScreen_submit:21,managePurchasesScreen_skip:22,lbwRiseScreen_landed:23,lbwRiseScreen_submit:24,lbwSizeSelectScreen_landed:25,lbwSizeSelectScreen_submit:26,lbwCategoryScreen_landed:27,lbwCategoryScreen_submit:28,lbwCategoryScreen_skip:29,shapeSelectScreen_1_landed:30,shapeSelectScreen_1_skip:31,shapeSelectScreen_1_submit:32,shapeSelectScreen_1_tooltip:33,shapeSelectScreen_2_landed:34,shapeSelectScreen_2_skip:35,shapeSelectScreen_2_submit:36,shapeSelectScreen_2_tooltip:37,ageScreen_landed:38,ageScreen_skip:39,ageScreen_submit:40,braScreen_landed:41,braScreen_skip:42,braScreen_submit:43,resultsScreen_initial_landed:44,resultsScreen_final_landed:45,sizeRecommendation_returning_lower_results_sp:46,sizeRecommendation_returning_upper_results_sp:47,sizeRecommendation_upper_results_sp:48,sizeRecommendation_lower_results_sp:49,sizeRecommendation_out_of_scale:50,close_lower_results_sp:51,close_upper_results_sp:52,close_brand_compare:53,close_upper_form:54,close_lower_form:55,close_upper_out_of_scale:56,outOfScaleScreen_landed:57,loadingScreen_open:58,loadingScreen_close:59,loadingScreen_timeout:60,entryScreen_close:61,outOfScaleScreen_back:62,outOfScaleScreen_close:63,brandCompareScreen_landed:64,brandCompareScreen_back:65,brandCompareScreen_submit:66,brandCompareScreen_close:67,brandCompareScreen_skip:68,initialResultsScreen_landed:69,initialResultsScreen_close:70,initialResultsScreen_back:71,finalResultsScreen_landed:72,finalResultsScreen_close:73,finalResultsScreen_back:74,tummyShapeScreen_landed:75,tummyShapeScreen_back:76,tummyShapeScreen_submit:77,tummyShapeScreen_close:78,tummyShapeScreen_skip:79,hipShapeScreen_landed:80,hipShapeScreen_back:81,hipShapeScreen_submit:82,hipShapeScreen_close:83,hipShapeScreen_skip:84,ageScreen_back:86,ageScreen_close:88,braScreen_back:91,braScreen_close:93,managePurchasesScreen_back:96,managePurchasesScreen_close:98,lowerCategoryScreen_landed:100,lowerCategoryScreen_back:101,lowerCategoryScreen_submit:102,lowerCategoryScreen_close:103,lowerCategoryScreen_skip:104,fitPreferenceScreen_landed:105,fitPreferenceScreen_submit:106,genderScreen_landed:107,genderScreen_submit:108,immediateRecommendation_out_of_scale:109,lowerBrandScreen_landed:110,lowerBrandScreen_skip:111,lowerBrandScreen_submit:112,lowerModelScreen_landed:113,lowerSizeScreen_landed:114,lowerSizeScreen_submit:115,resultsScreen_returned_landed:116,resultsScreen_submitted_landed:117,shoesBrandScreen_landed:118,shoesBrandScreen_submit:119,shoesSizeScreen_landed:120,shoesSizeScreen_submit:121,shoesWidthScreen_landed:122,shoesWidthScreen_submit:123,"warningScreen_error: loading timeout":124,"warningScreen_error: no fit indicators for result screen":125,"warningScreen_warning: long loading time":126,chestShapeScreen_landed:127,chestShapeScreen_submit:128,close_age:129,close_body_mass:130,close_body_shape:131,close_bra:132,close_fit:133,close_gender:134,close_lower_brand:135,close_lower_size:136,close_lower_type_mobile:137,close_manage_purchases:138,close_out_of_scale:139,close_results:140,close_shoes_brand:141,close_shoes_size:142,close_shoes_type_mobile:143,close_shoes_width_mobile:144,close_warning:145,lowerRiseScreen_landed:146,shoesCategoryScreen_landed:147,shoesCategoryScreen_submit:148,shoesModelScreen_landed:149,shoesModelScreen_skip:150,shoesModelScreen_submit:151,sizeRecommendation_lower_results:152,sizeRecommendation_returning_lower_results:153,sizeRecommendation_returning_shoes_results:154,sizeRecommendation_returning_upper_results:155,sizeRecommendation_shoes_results:156,sizeRecommendation_upper_results:157},a=[/^(resultsScreen_close)$/,/^(shapeSelectScreen_close)$/,/^(shoes_type_close)$/,/^(suggestBrand).*/,/^(enterData).*/];this.getFitAnalyticsEventCode=function(e,t){if(e&&t){for(var i=e+"_"+t,n=0;n<a.length;n++)if(i.match(a[n]))return;var r=o[i];return r?r:e+":"+t}},this.addVariants=function(e,t,i){var n=[],r=0;e=void 0===e.length?[e]:e;for(var s=0;s<e.length;s++){var o=void 0===e[s].price.current?e[s].price:e[s].price.current.value;r+=o,n.push({productIID:e[s].productId,variantIID:e[s].variantId,units:e.length,salePrice:o,sellingFast:e[s].sellingFast})}if(t){var a={context:"addToBagError",totalValue:r,productsAdded:n.length,addToBagType:i,products:n,errorCode:t.message[0].errorCode,errorId:t.message[0].errorMessage};this.fireEvent("addToBag",l(a),!1)}else{var c={context:"addToBag",totalValue:r,productsAdded:n.length,addToBagType:i,products:n};this.fireEvent("addToBag",l(c),!1)}};var l=function(e){if(e&&window.fitAnalyticsData)for(var t in window.fitAnalyticsData)window.fitAnalyticsData.hasOwnProperty(t)&&"context"!==t&&(e[t]=window.fitAnalyticsData[t]);return e};this.saveVariants=function(e,t){t=void 0===t?"main":t;for(var i=0;e.length>i;i++)this.fireEvent("saveForLater",{context:"saveForLater",productIID:e[i].productId,variantIID:e[i].variantId,saveForLaterType:t,SellingFast:e[i].sellingFast})};var c=function(e){var t=s.getRecommendationState(e.recommendationType),i={faState:t,faUserProfile:e.hasPreviousPurchaseData?"previous purchase data":"no previous purchase data",faSignedInStatus:e.userSignedIn?"signed in":"not signed in",faSizeRegion:n.storeCode.toLowerCase()};return e.bodyCategory&&(i.faBodyCategory=e.bodyCategory),
e.recommendedSize&&(i.faRecommendedSize=e.recommendedSize),window.fitAnalyticsData=i,i};this.fireFitAnalyticsOutOfScaleEvent=function(e){var t=c(e);t.context="out of scale",this.fireEvent("fitAnalyticsInteraction",t,!1)},this.fireFitAnalyticsSaveSelectionsEvent=function(e){e.context="save selections",this.fireEvent("fitAnalyticsInteraction",e,!1)},this.fireFitAnalyticsOpenWidgetEvent=function(e){var t=c(e);t.context="launch widget",this.fireEvent("fitAnalyticsInteraction",t,!1)},this.fireFitAnalyticsCloseWidgetEvent=function(e){var t=c(e);t.context="close widget";var i=[];if(e.widgetScreenEvents)for(var n=0;n<e.widgetScreenEvents.length;n++){var r=e.widgetScreenEvents[n],s=this.getFitAnalyticsEventCode(r.event,r.value);s&&i.push(s)}t.viewedScreens=i.join(","),this.fireEvent("fitAnalyticsInteraction",t,!1)},this.fireFitAnalyticsLoadEvent=function(e){var t=c(e);t.context="fit analytics impression",r.ifActive("t1270-web-fit-assistant-redesign",!0).then(function(e){t.mvtTestName=e?e.mvtExperience:void 0,this.fireEvent("fitAnalyticsImpression",t,!1)}.bind(this))},this.getRecommendationState=function(e){switch(e){case 1:return"first time interaction";case 2:return"partial recommendation";case 3:return"full recommendation";case 4:return"recommendation not in stock"}},this.getVariantStockStatus=function(e){var t=[];if(!e)return t;for(var i=0;i<e.length;i++){var n=e[i],r={variantId:n.variantId,stockStatus:n.isInStock?"in stock":"out of stock"};t.push(r)}return t},this.fireProductLoadEvent=function(e){var t=this.hasRecentlyViewed(),i=this.getSizes(e.variants),r=void 0!==e.productPrice?e.productPrice:e.price,s={IsMarkDown:r.isMarkedDown,OriginalPrice:r.xrp,CurrentPrice:r.current,ProductIID:e.id,MixMatchIID:!1,TotalSku:e.variants.length,AvailbleSku:this.getSkus(e.variants),RecentlyViewedAvailible:t>0?!0:!1,IsInStock:e.isInStock,TotalColours:e.totalNumberOfColours,ProductURL:location.protocol+"//"+location.host+location.pathname,TotalSizes:i[0],AvailibleSizes:i[1],StockStatus:e.isInStock,VariantStockStatus:this.getVariantStockStatus(e.variants),PreviusCatagoryPageNumber:this.url.getUrlParam("pge"),PreviusCatagoryGridSize:this.url.getUrlParam("gridsize"),PreviusCatagoryTotalstyles:this.url.getUrlParam("totalstyles"),PreviusCatagoryRowColumn:this.url.getUrlParam("gridrow")||this.url.getUrlParam("gridcolumn")?this.url.getUrlParam("gridrow")+"/"+this.url.getUrlParam("gridcolumn"):null,PreviusCatagoryPageSize:this.url.getUrlParam("pgesize"),CID:this.url.getUrlParam("cid"),SearchTerm:decodeURI(this.url.getUrlParam("SearchQuery")),BreadCrumb:n.breadcrumb,Platform:n.platform,StoreID:n.storeId,PageType:"product",PageName:n.pageTitle,Channel:n.gender,ProductCategoryName:this.getCatName(),ProductCode:e.productCode,AppVersion:n.version,SellingFast:e.sellingFast};this.signal(s),this.fireEvent("pageLoad",s,!1)},this.fireMixMatchLoadEvent=function(e){var t=this.hasRecentlyViewed(),i={MixMatchIID:e.id,IsInStock:this.mixMatchInStock(e.products),ProductURL:location.protocol+"//"+location.host+location.pathname,PreviusCatagoryPageNumber:this.url.getUrlParam("pge"),PreviusCatagoryGridSize:this.url.getUrlParam("gridsize"),PreviusCatagoryTotalstyles:this.url.getUrlParam("totalstyles"),PreviusCatagoryRowColumn:this.url.getUrlParam("gridrow")||this.url.getUrlParam("gridcolumn")?this.url.getUrlParam("gridrow")+"/"+this.url.getUrlParam("gridcolumn"):null,PreviusCatagoryPageSize:this.url.getUrlParam("pgesize"),CID:this.url.getUrlParam("cid"),SearchTerm:decodeURI(this.url.getUrlParam("SearchQuery")),BreadCrumb:n.breadcrumb,AvailibleProducts:e.productIds,RecentlyViewedAvailible:t>0?!0:!1,Platform:n.platform,StoreID:n.storeId,PageType:"mix&match",PageName:n.pageTitle,Channel:n.gender,ProductCategoryName:this.getCatName(),AppVersion:n.version};this.signal(i),this.fireEvent("pageLoad",i,!1)},this.signal=function(e){window.Product=e},this.mixMatchInStock=function(e){for(var t=!1,i=0;i<e.length;i++)e[i].isInStock&&(t=!0);return t},this.hasRecentlyViewed=function(){return i.getItems().length},this.getCatName=function(){for(var e=n.breadcrumb.split("/"),t="",i=2;i<e.length-1;i++)t+=2===i?e[i]:" | "+e[i];return t},this.getSkus=function(e){for(var t=0,i=0;i<e.length;i++)e[i].isInStock===!0&&t++;return t},this.getSizes=function(e){for(var t=[],i=0,n=0,r=0;r<e.length;r++)void 0===t[e[r].size]&&(i++,t[e[r].size]=!0,e[r].isInStock&&n++);return[i,n]},this.fireFeatureAnalytics=function(e){var t=window.s_gi(window.s.account);t.eVar9=e,window.mvtTestName=e}};return new s}),define("Providers/SdkProvider",["Promise"],function(e){function t(t){return function(){return new e(function(e){var i=function(){e(window.asos.sdk[t])};window.asos.sdk&&window.asos.sdk[t]?i():window.asos.eventBus.once(t+"-sdk-ready",function(){i()})})}}return{getSavedItems:t("savedItems"),getBag:t("bag"),getIdentity:t("identity")}}),define("ProductUtils/Bag",["$","ProductUtils/Analytics","ProductUtils/NewRelicLogger","Providers/SdkProvider"],function(e,t,i,n){return function(e,r){function s(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function o(t){return{productId:t.productId,colour:t.colourName,sizeId:t.sizeId,variantId:t.variantId,price:t.price.current.value,sellingFast:e.state.sellingFast}}return this.error="",void 0!==e&&(this.error=e.state.resources.pdp_status_error_max_items),this.addItems=function(e,t){n.getBag().then(function(i){var n,s=e.length>1;if(s){var a=this.formatAddProducts(e);n=i.addVariants(a),this.watchPromise(n,t,a,r)}else{var l=void 0!==e[0]?e[0]:e;l.colourName=void 0===l.colourName?l.colour:l.colourName;var c=o(l);n=i.addVariant(c),this.watchPromise(n,t,c,r)}}.bind(this))},this.formatErrorMessage=function(e){var t=e.userMessage||"";return e.hasOwnProperty("messageContext")&&e.messageContext&&e.messageContext.length>0&&(t=t.replace(/{(\d)}/g,function(t,i){var n=e.messageContext[parseInt(i,10)];return n?n:"..."})),t},this.watchPromise=function(e,n,r,o){e.then(function(){return t.addVariants(r,!1,o),n({success:!0,error:""})},function(e){t.addVariants(r,e,o);var a={action:"AddToBag"};a=s(a,r),a=s(a,e),a=s(a,e.message[0]),i.logError(new Error(i.ERROR_TYPE.UserActionFailed),a);var l;l="LegacyQuantityLimitReached"===e.message[0].errorCode?this.error:this.formatErrorMessage(e.message[0]),n({success:!1,error:l})}.bind(this))},this.formatAddProducts=function(e){for(var t=[],i=0;i<e.length;i++){var n=o(e[i]);n.colourName=void 0===n.colourName?n.colour:n.colourName,t.push(n)}return t},this}}),define("Components/product-image/product-image",["ko","text!./product-image.html","ProductUtils/Bag"],function(e,t,i){function n(t){this.imgUrl=t.imgUrl;var n=t.data,r=new i;this.state=t.state,this.productId=t.productId,this.saveForLaterCalled=e.observable(!1),this.context=t.context,this.saveForLater=function(){this.saveForLaterCalled()!==!0&&(r.saveProduct(n),this.saveForLaterCalled(!0))}.bind(this)}return{viewModel:n,template:t}}),define("text!Components/product-price/product-price.html",[],function(){return'<div class="grid-row rendered">\r\n    <span data-id="from-price" data-bind="visible: showFromLabel, text: fromLabelText, css: { \'price-from-discounted\' : isDiscountedPrice }" class="price-from"></span>\r\n    <span data-id="current-price" data-bind="text: priceText(), css: {\'product-price-discounted\' : isDiscountedPrice }, markAndMeasure: \'pdp:price_displayed\'" class="current-price"></span>\r\n    <span data-id="rrp-price" data-bind="text: rrpPriceText, visible: showRrpPrice" class="product-prev-price"></span>\r\n    <span data-id="previous-price" data-bind="text: prevPriceText, visible: showPrevPrice" class="product-prev-price"></span>\r\n    <span data-id="german-vat-message" data-bind="text: germanVatMessage, visible: showGermanVatMessage" class="product-german-vat"></span>\r\n</div>\r\n<!-- ko if: showPrevPrice -->\r\n<div class="clear-element"></div>\r\n<!-- /ko -->'}),define("Components/product-price/product-price",["ko","text!./product-price.html","ProductUtils/Ajax"],function(e,t,i){function n(t){this.ajax=new i;var n=t.state,r=n.productData;this.showRrpPrice=void 0!==r.rrpPrice,this.rrpPriceText=this.showRrpPrice?n.resources.pdp_price_rrp+" "+r.rrpPrice.text:"",this.showGermanVatMessage=t.showGermanVatMessage?!0:!1,this.germanVatMessage=t.state.resources.pdp_misc_vat_message,this.isDisplayPrice=t.isDisplayPrice,this.prevPriceText=e.computed(function(){return void 0===n.selectedColour()&&void 0!==r.maxPrevPrice?r.maxPrevPrice.text:void 0!==n.selectedColour()&&void 0!==n.selectedColour().prevPrice?n.selectedColour().prevPrice.text:""}.bind(this)),this.showPrevPrice=e.computed(function(){return""!==this.prevPriceText()}.bind(this)),this.showFromLabel=e.computed(function(){return void 0===r.hasDifferentPrices?!1:void 0!==n.selectedColour()?!1:!0}),this.fromLabelText=n.resources.pdp_misc_from,this.isDiscountedPrice=e.computed(function(){return this.showPrevPrice()||this.showRrpPrice}.bind(this));var s;s=void 0===n.selectedColour()?r.minPrice:n.selectedColour().price,this.price=e.observable(s),this.isDisplayPrice&&this.price.subscribe(function(e){t.state.displayPrice(e.value)}.bind(this)),this.priceText=e.computed(function(){return void 0===this.price()?"":this.price().text}.bind(this)),n.selectedColour.subscribe(function(e){e?this.price(e.price):this.price(r.minPrice)}.bind(this))}return{viewModel:n,template:t}}),define("text!Components/social-share/social-share.html",[],function(){return'<button\r\n    class="link social-share-icon"\r\n    id="social-share-button"\r\n    data-bind="click: toggleShareIcons, clickBubble: false, attr: { \'aria-expanded\': isVisible }"\r\n    aria-haspopup="true"\r\n    aria-controls="share-bar"\r\n>\r\n    <span class="product-share-icon" data-bind="attr: { \'aria-label\': state.resources.pdp_cta_social_share }"></span>\r\n    <span class="social-share-text" aria-hidden="true" data-bind="text: state.resources.pdp_cta_social_share"></span>\r\n</button>\r\n<div class="share-bar-wrap" data-bind="visible: isVisible">\r\n    <div class="triangle-up"></div>\r\n    <ul role="menu" id="share-bar" aria-labelledby="social-share-button">\r\n        <!-- ko if : isRussia -->\r\n        <li role="menuitem" tabindex="-1"><a data-bind="attr: { href: vkLink }, click: handleClick" data-id="vk" aria-label="vk" class="product-vk-icon"></a></li>\r\n        <!-- /ko -->\r\n        <li role="menuitem" tabindex="-1"><a data-bind="attr: { href: facebookLink }, click: handleClick" data-id="facebook" aria-label="facebook" class="product-facebook-icon"></a></li>\r\n        <li role="menuitem" tabindex="-1"><a data-bind="attr: { href: pinterestLink }, click: handleClick" data-id="pinterest" aria-label=pinterest" class="product-pinterest-icon"></a></li>\r\n        <!-- ko if : isMobile -->\r\n        <li role="menuitem" tabindex="-1"><a data-bind="attr: { href: whatsappLink }, click: handleClick" data-id="whatsapp" aria-label="whatsapp" class="product-whatsapp-icon"></a></li>\r\n        <li role="menuitem" tabindex="-1"><a data-bind="attr: { href: emailLink }, click: fireAnalytics" data-id="email" aria-label="email" class="product-email-icon"></a></li>\r\n        <!-- /ko -->\r\n    </ul>\r\n</div>\r\n'}),define("Components/social-share/social-share",["ko","text!./social-share.html","PageConfig","ProductUtils/Analytics","ProductUtils/NewRelicLogger"],function(e,t,i,n,r){function s(t){function s(e){for(var t=[],i=Object.keys(e),n=0;n<i.length;n++){var r=i[n];t.push(r+"="+encodeURIComponent(e[r]))}return t.join("&")}this.isVisible=e.observable(!1),this.isMobile="mobile"===i.platform,this.isRussia="ru"===i.storeCode.toLowerCase();var o,a,l,c=t.data,d=c.images[0].url,u=document.querySelector("link[rel=canonical]").href;this.facebookLink="https://www.facebook.com/sharer/sharer.php?"+s({u:u+"?ctaref=product_share_facebook"}),this.vkLink="http://vk.com/share.php?"+s({url:u+"?ctaref=product_share_vk"}),this.pinterestLink="https://pinterest.com/pin/create/button/?"+s({url:u+"?ctaref=product_share_pinterest",media:d,description:c.name}),this.whatsappLink="https://wa.me/?"+s({text:c.name+" "+u+"?ctaref=product_share_whatsapp"}),this.emailLink="mailto:?"+s({subject:c.name,body:c.name+" "+u+"?ctaref=product_share_email"}),this.setClickListener=function(e){document.addEventListener("click",o=function(t){-1===e.indexOf(t.target)&&(this.isVisible(!1),document.removeEventListener("click",o))}.bind(this))}.bind(this),this.setKeydownListener=function(e,t,i){document.addEventListener("keydown",a=function(n){27===n.keyCode&&(e.focus(),this.isVisible(!1),document.removeEventListener("keydown",a)),("Tab"===n.key||9===n.keyCode)&&(n.shiftKey?document.activeElement===t&&(i.focus(),n.preventDefault()):document.activeElement===i&&(t.focus(),n.preventDefault()))}.bind(this))}.bind(this),this.fireAnalytics=function(e,t){var i,r=c.id+"";return t&&(i=t.target.dataset.id),n.fireEvent("pageInteraction",{context:"socialShare",socialPlatform:i,productIID:r}),!0},this.handleClick=function(e,t){this.fireAnalytics(e,t),window.open(t.target.href,"SocialShareWindow","width=700,height=600,resizable,scrollbars=yes,status=1")},this.openSocialShare=function(){var e=document.activeElement,t=Array.prototype.slice.call(e.parentElement.querySelectorAll("#share-bar, #share-bar a")),i=t.slice(1),n=i[0],r=i[i.length-1];return this.isVisible()?(this.isVisible(!1),void e.focus()):(l||(l=!0,this.fireAnalytics()),this.setClickListener(t),this.setKeydownListener(e,n,r),this.isVisible(!0),void n.focus())}.bind(this),this.toggleShareIcons=function(){navigator.share&&this.isMobile?navigator.share({title:c.name,text:c.name,url:u+"?ctaref=product_share_native"}).then(function(){this.fireAnalytics()}.bind(this))["catch"](function(e){r.logError(e),this.openSocialShare()}.bind(this)):this.openSocialShare()}.bind(this)}return{viewModel:s,template:t}}),define("Components/content/content",[],function(){function e(e){this.state=e.state,this.product=e.data}return{viewModel:e}}),define("text!Components/out-of-stock/out-of-stock.html",[],function(){return'<!-- ko if: !inStock -->\r\n    <!-- ko if: productCode -->\r\n    <p class="product-code">\r\n        <span class="label" data-bind="text:productCodeLabel"></span>\r\n        <span data-bind="text:productCode"></span>\r\n    </p>\r\n    <!-- /ko -->\r\n    \r\n<div data-bind="visible: isMoreFromMessageVisible()"> \r\n    <div class="more-from">\r\n        <h2 data-bind="text:moreFromMessage"></h2>\r\n\r\n        <ul data-bind="foreach: moreFrom">\r\n            <li><a href="#" data-bind="attr: { href: $parent.getTrackedLinkUrl(linkUrl) }, text: friendlyName"></a></li>\r\n        </ul>\r\n    </div>\r\n</div>\r\n<!-- /ko -->\r\n'}),define("Components/out-of-stock/out-of-stock",["ko","text!./out-of-stock.html"],function(e,t){function i(e){var t=e.state;if(this.inStock=t.productData.isInStock,this.inStock)return!1;this.moreFromMessage=t.resources.pdp_carousel_more_from_title,this.productCodeLabel=t.resources.pdp_description_product_code_title,this.productCode=e.data.productCode;var i=e.data;this.moreFrom=i.categories,this.isMoreFromMessageVisible=function(){return!1},this.getTrackedLinkUrl=function(e){return e+(-1===e.indexOf("?")?"?":"&")+"CTAref=More+From"}}return{viewModel:i,template:t}}),define("text!Components/size-guide/size-guide.html",[],function(){return'<!-- ko if: render() -->\r\n<div class="size-guide-button">\r\n    <!-- ko if: !isMobile -->\r\n        <a href="#" data-bind="click : toggleSizeGuideVisibility, text : text"></a>\r\n    <!-- /ko -->\r\n    <!-- ko if: isMobile -->\r\n    <a href="#" target="_blank" data-bind="click: fireSizeGuideEvent, attr : { href : sizeGuideUrl }, text : text"></a>\r\n    <!-- /ko -->\r\n</div>\r\n\r\n<div class="size-guide" style="display: none;" data-bind="visible : sizeGuideVisible">\r\n    <div class="size-guide-modal">\r\n        <iframe frameborder="0" seamless="seamless" data-bind="attr: { src : sizeGuideUrl }"></iframe>\r\n    </div>\r\n    <a href="#close" class="size-guide-close" data-bind="click : toggleSizeGuideVisibility"></a>\r\n    <div class="size-guide-overlay" data-bind="click : toggleSizeGuideVisibility"></div>\r\n</div>\r\n\r\n<!-- /ko -->\r\n'}),define("Components/size-guide/size-guide",["ko","$","text!./size-guide.html","PageConfig","ProductUtils/Analytics"],function(e,t,i,n,r){function s(i){this.text=i.dictionary.pdp_size_guide_link,this.sizeGuideUrl=i.url,this.isMobile="mobile"===n.platform,this.sizeGuideVisible=e.observable(!1),this.render=i.visible,this.productId=i.productId,this.bindKeyUp=function(){t(document).on("keyup.closeSizeGuide",function(e){this.checkEvent(e)}.bind(this))},this.checkEvent=function(e){27===e.keyCode&&this.toggleSizeGuideVisibility()},this.unbindKeyUp=function(){t(document).unbind("keyup.closeSizeGuide")},this.fireSizeGuideEvent=function(){return r.fireEvent("pageInteraction",{context:"launchSizeGuide",productIID:i.id}),!0},this.toggleSizeGuideVisibility=function(){this.sizeGuideVisible(!this.sizeGuideVisible()),document.body.style.overflow=this.sizeGuideVisible()?"hidden":"",this.sizeGuideVisible()?(this.fireSizeGuideEvent(),this.bindKeyUp()):this.unbindKeyUp()}}return{viewModel:s,template:i}}),define("text!Components/recently-viewed/recently-viewed.html",[],function(){return'<!-- ko if: render -->\r\n<section>\r\n    <div class="layout-width recently-viewed" data-bind="visible: carousel.items().length > 0">\r\n        <div class="layout-module">\r\n            <h2 data-bind="text: title"></h2>\r\n            <div class="carousel">\r\n                <div class="row">\r\n                    <div class="arrows">\r\n                        <a class="arrow left-arrow" data-bind="click:carousel.moveLeft, css: {active : carousel.hasPreviousPanel }, visible: carousel.hasOtherPanels"><span></span></a>\r\n                    </div>\r\n                    <div class="window" data-bind="swipe">\r\n                        <ul class="slide-panel" data-bind="foreach: carousel.visibleItems, style: { width: carousel.width(), marginLeft:carousel.slidePosition()},css: { suppressSlide : !carousel.animate() }">\r\n                            <li data-bind="style: { width: $parent.carousel.itemWidth()}">\r\n\r\n                                <a data-bind="attr: { href: url }"><img data-bind="attr: { src: img }" /></a>\r\n\r\n                                <!-- ko if: !$parent.isMobile -->\r\n                                <a data-bind="click: $parent.removeItem.bind($data, id)" class="remove"><span class="product-closesmall">Remove</span></a>\r\n                                <!-- /ko -->\r\n\r\n                                <div data-bind=\'visible: $parent.showSaveButton($data), component:{name: "save-button",\r\n                                 params:{\r\n                                     productData: $parent.productData($data),\r\n                                     productId: id,\r\n                                     productImage : img,\r\n                                     context:"recentlyviewed"\r\n                                 }\r\n                                 }\'></div>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                    <div class="arrows">\r\n                        <a class="arrow right-arrow" data-bind="click:carousel.moveRight, css: {active : carousel.hasNextPanel }, visible: carousel.hasOtherPanels"><span></span></a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <a href="#" class="clear" data-bind="click: clear, text: clearText">Clear</a>\r\n\r\n        </div>\r\n        <ul class="nav" data-bind="foreach: carousel.panels, visible: carousel.hasOtherPanels">\r\n            <li data-bind="click: $parent.carousel.currentPanel.bind($data)">\r\n                <a data-bind="css:{active:$parent.carousel.currentPanel() == $data}" href="#"></a>\r\n            </li>\r\n        </ul>\r\n  </div>\r\n</section>\r\n<!-- /ko -->\r\n\r\n\r\n'}),define("ProductUtils/debouncer",[],function(){return this.debounce=function(e,t,i){var n;return function(){var r=this,s=arguments,o=function(){n=null,i||e.apply(r,s)},a=i&&!n;clearTimeout(n),n=setTimeout(o,t),a&&e.apply(r,s)}},this}),define("Models/CarouselControl",["ko","jquery","PageConfig","ProductUtils/debouncer"],function(e,t,i,n){return function(){var r=this,s=e.observable(4),o=4,a=2,l=e.observable(0),c="slide",d=e.observable(0),u=e.observable(),h="desktop"===i.platform.toLowerCase()?1:2,p=document.querySelector("html");r.events=t({}),r.items=e.observableArray(),r.panels=e.observableArray(),r.loop=e.observable(!1),r.animate=e.observable(!0),r.setData=function(e){void 0!==e&&null!==e&&e instanceof Array?this.items(e):r.items.removeAll()},r.currentPanel=e.computed({read:function(){return l()},write:function(e,t){r.animate(void 0===t?!0:t),e>=-1&&e<r.panels().length&&l(e)}}),r.itemsInView=e.computed({read:function(){return s()},write:function(e){e&&e>0&&(s(e),o=e)}}),r.panels.subscribe(function(){if(l()>=r.panels().length){var e=0===r.panels().length?0:r.panels().length-1;l(e)}});var m=function(e){for(var t=Math.ceil(e.length/s()),i=r.panels().length,n=i;t>n;n++)r.panels.push(n);for(var o=t;i>o;o++)r.panels.pop()};s.subscribe(function(){m(r.items())}),r.items.subscribe(m),r.width=e.computed(function(){var e=r.items().length>s()?100*r.items().length/s():100;return e+"%"}),r.itemWidth=e.computed(function(){var e=r.items().length>=s()?100/r.items().length:100/s();return e===1/0&&(e=0),e+"%"}),r.slidePosition=e.computed(function(){return d(),"slide"===c?"-"+100*Math.max(0,l())+"%":d()+"px"}),r.moveLeft=function(){r.animate(!0);var e;l()>0?(e=l()-1,l(e)):r.loop()&&(e=r.panels().length-1,l(e))},r.moveRight=function(){r.animate(!0),l()<r.panels().length-1?l(l()+1):r.loop()&&l(0)},r.hasPreviousPanel=e.computed(function(){return r.loop()?r.panels().length>1:l()>0}),r.hasNextPanel=e.computed(function(){return r.loop()?r.panels().length>1:r.panels().length>0&&l()+1<r.panels().length}),r.hasOtherPanels=e.computed(function(){return r.hasNextPanel()||r.hasPreviousPanel()}),r.setAnimationType=function(e){c=e};var f=function(e){r.itemsInView(e),r.events.trigger("resize")};r.resize=function(e,t,i,n){if(r.landscapePanels=i,r.portraitPanels=n,"mobile"===e)return r.setAnimationType("move"),f(t.innerWidth>t.innerHeight?i:n);if(p.classList.contains("MasterLayout"))return r.events.trigger("resize");var s=o;return t.innerWidth<=568?(f(Math.ceil(a)),void(o=s)):t.innerWidth<=720?(f(Math.ceil((o+a)/2)),void(o=s)):f(Math.ceil(o))},l.subscribe(function(e){!u()&&e>0&&u(!0)}),r.visibleItems=e.computed(function(){return u()?r.items():r.items.slice(0,Math.ceil(r.itemsInView())*h)}),window.addEventListener("resize",n.debounce(function(){r.resize(i.platform,window,r.landscapePanels,r.portraitPanels)})),e.bindingHandlers.swipe={init:function(e){t(e).scroll(function(){u()||u(!0)})}}}}),define("Components/recently-viewed/recently-viewed",["ko","$","text!./recently-viewed.html","Models/CarouselControl","Models/RecentlyViewedStorage","ProductUtils/Bag","ProductUtils/Analytics","ProductUtils/UrlUtils","PageConfig"],function(e,t,i,n,r,s,o,a,l){function c(t,i){function c(){var e=i.URL.split("?")[0].split("#")[0]+"?CTAref=Recently+Viewed",t=u.getUrlParam("colourWayId",i.URL);return t&&(e+="&colourWayId="+t),e}i=i||document;var d=t.state,u=new a;this.title=d.resources.pdp_carousel_recently_viewed_title,this.clearText=d.resources.pdp_misc_clear,this.isMobile="mobile"===l.platform,this.render=e.observable(!1),r.setExpiryInDays(t.expiryInDays),this.carousel=new n,this.carousel.itemsInView(5),this.carousel.resize(l.platform,window,3.7,1.7);var h=r.getItems();window.localStorage&&h.length>0&&this.render(!0);for(var p=0;p<h.length;p++)h[p].addedToBag=e.observable(!1);this.carousel.setData(h),this.bag=new s;var m=t.data,f=m.images[0].url+"?$L$&wid=168&fit=constrain",v=void 0!==m.productIds?!0:!1;this.showSaveButton=function(e){return e.mixMatch||!e.colourWayId?!1:!0},this.getColourWayId=function(e){if(e.colourWayId)return e.colourWayId;if(e.images)for(var t=0;t<e.images.length;t++)if(e.images[t].isPrimary===!0&&e.images[t].colourWayId)return e.images[t].colourWayId},this.productData=function(e){return{productId:e.id,colourWayId:this.getColourWayId(e)}};var g=new r.ProductItem(m.id,f,c.call(this),m.name,v,this.getColourWayId(m));r.addItem(g),this.url=e.observable(i.URL),this.removeItem=function(e){var t=this.carousel.items.remove(function(t){return t.id===e});t.length>0&&r.removeItem(e)}.bind(this),this.clear=function(){r.clear(),this.carousel.items.removeAll(),o.fireEvent("carouselAction",{context:"clearAll",carouselType:"recentlyviewed"}),d.submodulesCompleted.recentlyViewed(d.CAROUSEL_LOADING_STATE.NO_DATA)},d.submodulesCompleted.recentlyViewed(this.carousel.items().length>0?d.CAROUSEL_LOADING_STATE.HAS_DATA:d.CAROUSEL_LOADING_STATE.NO_DATA)}return{viewModel:c,template:i}}),define("text!Components/might-like/might-like.html",[],function(){return'<section>\r\n    <div class="layout-width you-might-also-like" data-bind="visible: carousel.items().length > 0">\r\n        <div class="layout-module">\r\n            <h2 data-bind="text: title"></h2>\r\n            <div class="carousel">\r\n                <div class="row">\r\n                    <div class="arrows">\r\n                        <a class="arrow left-arrow" data-bind="click:carousel.moveLeft, css: {active : carousel.hasPreviousPanel }, visible: carousel.hasOtherPanels"><span></span></a>\r\n                    </div>\r\n                    <div class="window" data-bind="swipe">\r\n                        <ul class="slide-panel" data-bind="foreach: carousel.visibleItems, style: { width: carousel.width(), marginLeft:carousel.slidePosition()},css: { suppressSlide : !carousel.animate() }">\r\n                            <li data-bind="style: { width: $parent.carousel.itemWidth()}">\r\n                                <a data-bind="attr: { href: $parent.getProductLink($data, $index())}">\r\n                                    <div class="product-tile">\r\n                                        <img data-bind="attr: { src: $parent.getImageSrc($data)}" />\r\n                                        <div data-bind=\'component:{\r\n                                            name: "save-button",\r\n                                            params:{\r\n                                                colourWayId: $parent.getColourWayId($data),\r\n                                                productId: id,\r\n                                                productImage : $parent.getImageSrc($data),\r\n                                                context : "youMightLike"\r\n                                            }\r\n                                           }\'></div>\r\n                                        <div class="tile-info">\r\n                                            <h1 data-bind="text:$parent.formatTitle(name)"></h1>\r\n                                            <div class="price-container">\r\n                                                <span class="price" data-bind="text:$parent.getPriceText(price), css: { \'price-highlighed\' : $parent.isPriceDiscounted(price) }"></span>\r\n                                                <span class="discounted-price" data-bind="visible: $parent.isPriceDiscounted(price), text:$parent.getDiscountedPriceText(price)"></span>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </a>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                    <div class="arrows">\r\n                        <a class="arrow right-arrow" data-bind="click:carousel.moveRight, css: {active : carousel.hasNextPanel }, visible: carousel.hasOtherPanels"><span></span></a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <ul class="nav" data-bind="foreach: carousel.panels, visible: carousel.hasOtherPanels">\r\n            <li data-bind="click: $parent.carousel.currentPanel.bind($data)">\r\n                <a data-bind="css:{active:$parent.carousel.currentPanel() == $data}" href="#"></a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</section>\r\n'}),define("Components/might-like/might-like",["ko","$","text!./might-like.html","Models/CarouselControl","PageConfig","Utils","ProductUtils/Ajax","Product.Config","Providers/SdkProvider","ProductUtils/UrlUtils","events"],function(e,t,i,n,r,s,o,a,l,c,d){function u(e){var t=e.state,i=e.data,s=new c;this.resources=t.resources,this.features=t.features,this.ajax=new o,this.serviceUrl="",this.useRecs=this.features.recommendationsEnabledStores.indexOf(r.storeCode.toLowerCase())>-1,this.title=this.useRecs&&!t.productData.isInStock?t.resources.pdp_carousel_recommendations_out_of_stock:t.resources.pdp_carousel_recommendations_title,this.createFredHopperUrl=function(e,t){return a.ymalApiUrl+e+"?channel="+t.platform+"-web"},this.createRecsUrl=function(e){return a.recsApiUrl+"?ctx_origin=pdt&limit=16&ctx_productids="+e},this.createRecsOosUrl=function(e){return a.recsApiUrl+"?ctx_origin=oos&limit=16&ctx_productIds="+e},this.serviceMapper=function(e){return void 0!==window.mvtMightLikeEndpoint?window.mvtMightLikeEndpoint+"&ctx_productids="+e:this.useRecs?t.productData.isInStock?this.createRecsUrl(e):this.createRecsOosUrl(e):this.createFredHopperUrl(e,r)},this.serviceUrl=this.serviceMapper(i.id),this.carousel=new n,this.carousel.itemsInView(4),this.carousel.resize(r.platform,window,3.7,1.7),this.getImageSrc=function(e){return this.useRecs?s.formatUrl(e.images[0].url+"?$XL$&wid=200&fit=constrain"):s.formatUrl(e.imageUrl+"?$XL$&wid=200&fit=constrain")},this.getColourWayId=function(e){for(var t=0;t<e.images.length;t++)if(e.images[t].isPrimary===!0&&e.images[t].colourWayId)return e.images[t].colourWayId},this.getProductLink=function(e,t){var i=s.getProductUrl(e.name,e.brandName,e.id),n="?CTAref=We+Recommend+Carousel_"+(t+1)+"&featureref1=we+recommend";return this.useRecs&&(n+="+pers"),i+n}.bind(this),this.getPriceText=function(e){return e.current.text},this.getDiscountedPriceText=function(e){return this.isPriceDiscounted(e)?e.isOutletPrice?t.resources.pdp_price_rrp+e.rrp.text:e.previous.text:""},this.isPriceDiscounted=function(e){return e.isMarkedDown||e.isOutletPrice},this.formatTitle=function(e){var t=e;return t.length>50&&(t=t.substring(0,48),t+="..."),t},this.getAuthorizationHeader=function(){return l.getIdentity().then(function(e){return e.customer.customerGuid().then(function(e){return"Bearer "+(e||"null")},function(){return"Bearer null"})})},this.getRecommendations=function(e,t){return this.ajax.execute({url:e,apiName:"Presentation",callerContext:"YMAL",storeParams:{store:r.storeCode,country:r.countryCode,currency:r.currency,lang:r.language,sizeSchema:r.sizeSchema,keyStoreDataversion:r.keyStoreDataversion},authorization:t,successCallback:this.bindCarouselResponse.bind(this)})},this.update=function(e){return this.getAuthorizationHeader().then(this.getRecommendations.bind(this,e),this.getRecommendations.bind(this,e)).then(this.bindCarouselResponse.bind(this))},this.bindCarouselResponse=function(e){this.carousel.setData(e.recommendations),t.submodulesCompleted.recommendations(this.carousel.items().length>0?t.CAROUSEL_LOADING_STATE.HAS_DATA:t.CAROUSEL_LOADING_STATE.NO_DATA)},d.on("updateMightLike",function(e,t){this.carousel.items([]),this.update(t+"&ctx_productids="+i.id)}.bind(this)),d.on("setMightLikeData",function(e,t){this.useRecs=!0,this.bindCarouselResponse(t.recData)}.bind(this)),this.update(this.serviceUrl)}return{viewModel:u,template:i}}),define("text!Components/buy-the-look/buy-the-look.html",[],function(){return'<section data-bind="visible: isVisible" class="buy-the-look">\r\n    <div class="layout-width">\r\n        <div class="layout-module">\r\n            <h2 data-bind="text: state.resources.pdp_carousel_buy_the_look_title"></h2>\r\n            <div class="carousel">\r\n                <div class="row">\r\n                    <div class="arrows">\r\n                        <a class="arrow left-arrow" data-bind="click:carousel.moveLeft, css: {active : carousel.hasPreviousPanel }, visible: carousel.hasOtherPanels"><span></span></a>\r\n                    </div>\r\n                    <div class="window" data-bind="swipe">\r\n                        <ul data-bind="foreach: {data: carousel.visibleItems, afterRender: renderedHandler}, style: { height: uniformHeight, width: carousel.width(), marginLeft:carousel.slidePosition()},css: { suppressSlide : !carousel.animate() }, afterRender: postRender ">\r\n                            <li data-bind="style: { width: $parent.carousel.itemWidth() }, css : { \'out-of-stock\' : !isInStock, \'in-stock\' : isInStock}">\r\n                                <div class="item card-container">\r\n                                    <div class="card" data-bind="css : { \'flipped\' : state.showAddToBagError() }">\r\n                                        <div class="front">\r\n                                            <div class="btl-product-details">\r\n                                                <a data-bind="attr: { href: $parent.getProductLink(product, $index()) }">\r\n                                                    <div class="product-image" data-bind=\'component: { name: "product-image", params: {imgUrl: imgUrl, state:state, productId: product.id, context:"buythelook" } }\'></div>\r\n                                                    <div class="product-title" data-bind="text:$parent.formatTitle(product.name)"></div>\r\n                                                </a>\r\n                                            </div>\r\n                                            <div class="btl-options">\r\n                                                <div class="product-price" data-bind=\'component: { name: "product-price", params: {state: state, hideDeliveryLink: true, showGermanVatMessage: showGermanVatMessage}}\'></div>\r\n                                                <div class="separator"></div>\r\n                                                <div data-bind="component:{\r\n                                        name: \'product-colour\',\r\n                                        params: {\r\n                                            hideLabels: true,\r\n                                            useShortSelectColourLabel: true,\r\n                                            state: state,\r\n                                            data: product}\r\n                                        }"></div>\r\n\r\n                                                <div class="separator"></div>\r\n                                                <div data-bind=\'component:{\r\n                                        name: "product-size",\r\n                                        params: {\r\n                                            hideLabels: true,\r\n                                            hideLowInStock: true,\r\n                                            state: state,\r\n                                            data: product}\r\n                                        }\'></div>\r\n                                                <!-- ko if: isInStock -->\r\n                                                <div class="add-status">\r\n                                                    <div data-component-id="add-item" data-bind=\'component: { name: "add-item",\r\n                                             params:{\r\n                                                 productId: product.id,\r\n                                                 showTryAgain: false,\r\n                                                 productImage : product.images[0].url,\r\n                                                 state: state,\r\n                                                 initiator : "buyTheLook"\r\n                                             }}\'></div>\r\n                                                </div>\r\n                                                <!-- /ko -->\r\n                                                <div class="out-of-stock-button" data-bind="visible: !isInStock">\r\n                                                    <span data-bind="text: state.resources.pdp_carousel_buy_the_look_out_of_stock"></span>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div class="back">\r\n                                            <div class="btl-product-details">\r\n                                                <a data-bind="attr: { href: $parent.getProductLink(product, $index()) }">\r\n                                                    <img class="product-image" data-bind="attr: { src: imgUrl }" alt="" />\r\n                                                </a>\r\n                                            </div>\r\n                                            <div class="add-failed">\r\n                                                <div class="add-to-bag-error" data-bind="html: state.addToBagErrorMessage"></div>\r\n                                                <div class="retry-add">\r\n                                                    <a class="failed" data-bind="click: $parent.tryAgain($index())">\r\n                                                        <span data-bind="text: state.resources.pdp_status_error_add_item_try_again"></span>\r\n                                                    </a>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </li>\r\n                        </ul>\r\n                    </div>\r\n                    <div class="arrows">\r\n                        <a class="arrow right-arrow" data-bind="click:carousel.moveRight, css: {active : carousel.hasNextPanel }, visible: carousel.hasOtherPanels"><span></span></a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <ul class="nav" data-bind="foreach: carousel.panels, visible: carousel.hasOtherPanels">\r\n            <li data-bind="click: $parent.carousel.currentPanel.bind($data)">\r\n                <a data-bind="css:{active:$parent.carousel.currentPanel() == $data}" href="#"></a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n\r\n</section>\r\n';
}),define("ProductUtils/BuyTheLook",["ProductUtils/Ajax","ProductUtils/UrlUtils","Product.Config","PageConfig"],function(e,t,i,n){return function(){this.productArray=[],this.callbacks=[],this.ajax=new e;var r=new t;this.getBuyTheLook=function(e,t){this.ajax.execute({storeParams:{store:n.storeCode,currency:n.currency,lang:n.language,sizeSchema:n.sizeSchema,keyStoreDataversion:n.keyStoreDataversion},url:i.buyTheLookApiUrl+e,apiName:"Product Catalogue",callerContext:"BuyTheLook",successCallback:this.success.bind(this),retryCount:5,callbackArgs:{callback:t}})},this.success=function(e,t){var i=e.products;i.sort(function(e,t){return e.order-t.order});for(var n=0;n<i.length;n++){var s=i[n].product;s.sizeGuide=r.formatUrl(s.sizeGuide);for(var o=0;o<s.images.length;o++)s.images[o].url=r.formatUrl(s.images[o].url);for(var a=0;a<s.variants.length;a++){var l=s.variants[a];l.size=l.brandSize,l.variantId=l.id,l.sizeDescription&&(l.size+=" - "+l.sizeDescription)}}t.callback(i)}}}),define("Components/buy-the-look/buy-the-look",["ko","text!./buy-the-look.html","Models/CarouselControl","Models/VariantDecorator","PageConfig","$","ProductUtils/BuyTheLook","ProductUtils/UrlUtils"],function(e,t,i,n,r,s,o,a){function l(t){this.state=t.state,this.product=t.data,this.carousel=new i,this.buyTheLook=new o,this.render=t.render,this.uniformHeight=e.observable(),this.expectedCarouselLength=e.observable(0),this.renderedCount=e.observable(0),this.urlUtils=new a,this.adjustCarouselHeight=function(){var e=s(".buy-the-look .item"),t=[];e.each(function(e){var i=20,n=s(this).find(".btl-product-details").outerHeight(),r=s(this).find(".btl-options").outerHeight(),o=r+n+i;t.push(e),t[e]=o});var i=Math.max.apply(Math,t);this.uniformHeight(i+"px")}.bind(this),this.renderedHandler=function(){this.renderedCount(this.renderedCount()+1),this.expectedCarouselLength()>0&&this.renderedCount()===this.carousel.visibleItems().length&&setTimeout(this.adjustCarouselHeight,1)}.bind(this),this.carousel.events.on("resize",function(){this.adjustCarouselHeight()}.bind(this)),this.isVisible=e.computed(function(){return null!==e.utils.arrayFirst(this.carousel.items(),function(e){return e.isInStock})}.bind(this)),this.formatTitle=function(e){var t=e;return t.length>32&&(t=t.substring(0,29),t+="..."),t},this.getProductLink=function(e,t){var i=this.urlUtils.getProductUrl(e.name,e.brandName,e.id),n="?CTAref=Complete+the+Look+Carousel_"+(t+1)+"&featureref1=complete+the+look";return i+n},this.tryAgain=function(e){this.carousel.items()[e].state.showAddToBagError(!1)},this.product.buyTheLookId?this.buyTheLook.getBuyTheLook(this.product.buyTheLookId,function(i){if(!i)return void this.state.submodulesCompleted.buyTheLook(this.state.CAROUSEL_LOADING_STATE.NO_DATA);var s=[];this.expectedCarouselLength(i.length);for(var o=0;o<i.length;o++){var a=i[o].product,l=a.variants.filter(function(e){return e.isInStock}),c=l.length>0,d={productData:(new n).getData(a,!c),selectedColour:e.observable(),selectedSize:e.observable(),showNoColourSelectedWarning:e.observable(!1),showNoSizeSelectedWarning:e.observable(!1),showAddToBagError:e.observable(!1),addToBagErrorMessage:e.observable(""),resources:t.state.resources},u={state:d,product:a,showGermanVatMessage:t.showGermanVatMessage},h=a.images.filter(function(e){return e.isPrimary===!0?e.url:""});u.isInStock=c,u.imgUrl=h.length>0?h[0].url:a.images[0].url,u.imgUrl=u.imgUrl+"?$L$&wid=190&fit=constrain",s.push(u)}s.sort(function(e,t){return e.isInStock===t.isInStock?0:e.isInStock?-1:1}),i.length>0&&(this.carousel.itemsInView(4),this.carousel.setData(s.slice(0,6)),this.carousel.resize(r.platform,window,3.7,1.7)),this.state.submodulesCompleted.buyTheLook(this.isVisible()?this.state.CAROUSEL_LOADING_STATE.HAS_DATA:this.state.CAROUSEL_LOADING_STATE.NO_DATA)}.bind(this)):this.state.submodulesCompleted.buyTheLook(this.state.CAROUSEL_LOADING_STATE.NO_DATA)}return{viewModel:l,template:t}}),define("text!Components/product-gallery/product-gallery.html",[],function(){return'<div class="product-carousel" id="product-gallery" role="region" data-bind="attr: { \'aria-label\': galleryText.carouselLabel }">\r\n    <div class="window" data-bind="swipe">\r\n        <div class="selling-fast" data-bind="visible: showSellingFastLabel">\r\n            <span class="selling-fast__label" data-bind="text: state.resources.pdp_misc_selling_fast"></span>\r\n        </div>\r\n        <div class="gallery-images" data-bind="foreach: galleryItems, css: { animate : animate() }, style: { width : galleryWidth, marginLeft : galleryPosition }">\r\n            <div class="image-container" tabindex="-1" data-bind="style: { width : $parent.itemWidth}, css: { \'zoomable\': $parent.imageData() }, attr: { \'data-gallery-index\': $index, \'aria-hidden\': $parent.thumbIndex() !== $index() }">\r\n                <div class="asos-media spinset imageviewer" data-bind=\'component: { name: "asos-spin-viewer-prod", params: { scene7: $parent.playerParams.scene7, viewer: { showCloseButton: false, zoomFactors: $parent.zoomFactors, baseJpgQlt: 80, zoomJpgQlt: 90, handleLoadingErrors: false, showHint: false }, api: $parent.imageViewerApis()[$index()], messages: $parent.playerParams.messages } }, visible: $parent.imageViewersVisibility()[$index()]\'></div>\r\n                <!-- ko if: $index() === 1 -->\r\n                <img class="gallery-image" data-bind="attr: { src: $parent.colourOptionImage().url + \'?$XXL$&wid=513&fit=constrain\', alt: $parent.getImageAlt($index()) }, event: { onload: window.asos.performance.markAndMeasure(\'pdp:gallery_image_\'+$index()+\'_displayed\')}" />\r\n                <!-- /ko -->\r\n                <!-- ko if: $index() !== 1 -->\r\n                <img class="gallery-image" data-bind="attr: { src: url + \'?$XXL$&wid=513&fit=constrain\', alt: $parent.getImageAlt($index()) }, event: { onload: window.asos.performance.markAndMeasure(\'pdp:gallery_image_\'+$index()+\'_displayed\')}" />\r\n                <!-- /ko -->\r\n            </div>\r\n        </div>\r\n        <button class="arrow-button arrow-button-right" aria-controls="product-gallery" data-bind="click:moveRight, markAndMeasure: \'pdp:gallery_swiping_right_interactive\', attr: { \'aria-label\': state.resources.pdp_media_gallery_carousel_next }">\r\n            <div class="product-chevron-right-large"></div>\r\n        </button>\r\n        <button class="arrow-button arrow-button-left" aria-controls="product-gallery" data-bind="click:moveLeft, markAndMeasure: \'pdp:gallery_swiping_left_interactive\', attr: { \'aria-label\': state.resources.pdp_media_gallery_carousel_previous }">\r\n            <div class="product-chevron-left-large"></div>\r\n        </button>\r\n        <!-- ko if: isMobile-->\r\n        <div class="carousel-bullets">\r\n            <ul id="mobile-gallery-bullets" data-bind="foreach: galleryItems, attr: { \'aria-label\': selectImageAlt }">\r\n                <!-- ko if: $index() > 0 -->\r\n                <li data-bind="css: { active: $parent.thumbIndex() === $index() }">\r\n                    <button aria-describedby="mobile-gallery-bullets" data-bind="click: $parent.selectThumbnail.bind($data, $index()), attr: { \'aria-current\': ($parent.thumbIndex() === $index()).toString() }"></button>\r\n                </li>\r\n                <!-- /ko -->\r\n            </ul>\r\n        </div>\r\n        <!-- /ko -->\r\n    </div>\r\n    <div class="asos-media catwalk" style="display: none" data-bind=\'component: { name: "asos-video-player-prod", params: { scene7: playerParams.scene7, player: { startInFullScreen: startVideoInFullScreen, closeOnFullScreenExited: closeVideoOnFullScreenExited, initialLoopCount: 2 }, api: videoPlayerApi, messages: playerParams.messages } }, visible: isVideoVisible\'></div>\r\n    <div class="asos-media spinset spinviewer" style="display: none" data-bind=\'component: { name: "asos-spin-viewer-prod", params: { scene7: playerParams.scene7, viewer: { spinSpeed: spinSpeed, showCloseButton: showSpinViewerCloseButton, zoomFactors: zoomFactors, reverseVerticalDirection: false, reverseHorizontalDirection: false, baseJpgQlt: 80, zoomJpgQlt: 90, showHint: showSpinViewerContainerHint, useInitialAnimation: true, animationIntervalStart: 100, animationIntervalPeak: 100, animationFramesCount: 5, preloadingTimeout: 30000 }, api: spinViewerApi, messages: playerParams.messages } }, visible: isSpinViewerVisible, css: { "zoomable": isSpinViewerLoadedWithoutErrors }\'></div>\r\n</div>\r\n\r\n<!-- ko if: !isMobile-->\r\n    <ul class="thumbnails" role="region" data-bind="attr: { \'aria-label\': galleryText.thumbnailLabel }">\r\n        <!-- ko foreach: galleryItems-->\r\n            <!-- ko if: $index() > 0  -->\r\n                <li class="image-thumbnail" data-bind="css: { active: $parent.thumbIndex() === $index() }, attr: { \'aria-current\': $parent.thumbIndex() === $index() }">\r\n                    <button data-bind="click: $parent.selectThumbnail.bind($data, $index())">\r\n                <!-- ko if: $index() === 1 -->\r\n                    <img data-bind="attr: { src: $parent.colourOptionImage().url + \'?$S$&wid=40&fit=constrain\', alt: $parent.getThumbnailAlt($index())}"/>\r\n                <!-- /ko -->\r\n                <!-- ko if: $index() > 1 -->\r\n                    <img data-bind="attr: { src: url + \'?$S$&wid=40&fit=constrain\', alt: $parent.getThumbnailAlt($index())}" />\r\n                <!-- /ko -->\r\n                    </button>\r\n                </li>\r\n            <!-- /ko -->\r\n        <!-- /ko -->\r\n    </ul>\r\n<!-- /ko -->\r\n<!-- ko if : isInStock -->\r\n    <div class="interactives">\r\n        <button class="catwalk" data-bind="visible: isVideoButtonVisible() && isInStock(), click: onVideoButtonActivated, attr: { \'aria-current\': isVideoVisible, \'aria-label\': state.resources.pdp_media_video_player_label }">\r\n            <span class="interactive-icon product-play" data-bind="css: { \'product-play-filled\': isVideoVisible }"></span>\r\n            <span class="interactive-text" data-bind="text: state.resources.pdp_misc_video, css: { \'active\': isVideoVisible }"></span>\r\n        </button>\r\n        <button class="spinset" data-bind="visible: isSpinViewerButtonVisible(), click: onSpinViewerButtonActivated, attr: { \'aria-current\': isSpinViewerVisible, \'aria-pressed\': isSpinViewerPressed, \'aria-label\': state.resources.pdp_media_spinset_label }">\r\n            <!-- ko if: !isMobile -->\r\n            <span class="interactive-icon product-360" data-bind="css: { \'product-360-selected\': isSpinViewerVisible }"></span>\r\n            <span class="interactive-text" data-bind="css: { \'active\': isSpinViewerVisible }, text: state.resources[\'pdp_misc_spinset\']"></span>\r\n            <!-- /ko -->\r\n            <!-- ko if: isMobile -->\r\n            <span class="interactive-icon product-360" data-bind="css: { \'product-returns\': isSpinViewerVisible }"></span>\r\n            <span class="interactive-text" data-bind="css: { \'active\': isSpinViewerVisible }, text: spinViewerLabelText"></span>\r\n            <!-- /ko -->\r\n        </button>\r\n    </div>\r\n<!--/ko -->\r\n<!-- ko if : product && isInStock && !isMobile -->\r\n<div class="social-share social-share-gallery" id="social-share" data-bind=\'component: { name: "social-share", params: { state: state, data: product } }\'></div>\r\n<!-- /ko -->\r\n'}),define("Components/product-gallery/product-gallery",["ko","$","text!./product-gallery.html","Models/CarouselControl","PageConfig","hammer","Asos.Utils.MediaPlayers","ProductUtils/Analytics","ProductUtils/UrlUtils","ProductUtils/features/features"],function(e,t,i,n,r,s,o,a,l,c){function d(t){function i(e){for(var t=-1,i=0;i<d.length;i++)if(d[i].colourWayId===e){t=i;break}return t}var n=t.state;this.product=t.data.product;var d=t.data.images;this.defaultProductId=t.data.defaultProductId;var u=0;this.galleryItems=e.observableArray(),this.galleryWidth=e.observable(),this.itemWidth=e.observable(),this.itemWidthValue=e.observable(),this.galleryPosition=e.observable(),this.galleryIndex=e.observable(0),this.animate=e.observable(!1),this.thumbIndex=e.observable(0),this.isInStock=e.observable(!1),this.isMobile="mobile"===r.platform;var h=new l,p={imageChanged:!1,thumbnailClick:!1,imageViewerZoomIn:!1,spinViewerInit:!1,spinViewerSpin:!1,spinViewerZoomIn:!1,videoPlayerInit:!1,videoProgress:{25:!1,50:!1,75:!1,100:!1}},m="tracking.mediaPlayer.videoAction",f="tracking.mediaPlayer.mediaAction";this.checkIfInStockAndSetFlag=function(){this.isInStock(n.productData?n.productData.isInStock:!0)},this.getVisibleImages=function(t){var i=t.filter(function(e){return e.isVisible===!0});if(!i[0].colourWayId||null===i[0].colourWayId){var n=e.utils.arrayFirst(t,function(e){return e.isPrimary});if(n||(n=e.utils.arrayFirst(t,function(e){return e.colourWayId&&null!==e.colourWayId})),n){var r=i.indexOf(n);r>=0&&i.splice(r,1),i.splice(0,0,n)}}return i};var v=this.getVisibleImages(d);this.getThumbnailAlt=function(e){return n.resources.pdp_media_gallery_thumbnail_count.replace("%{index}",e).replace("%{total}",v.length-1)}.bind(this),this.getImageAlt=function(e){return n.resources.pdp_misc_count.replace("%{index}",e).replace("%{total}",v.length-1)}.bind(this),this.selectImageAlt=n.resources.pdp_media_gallery_select_image,n.mainImage=this.colourOptionImage=e.observable(v[0]),this.init=function(){this.galleryItems(this.shuffleLastImage(v)),this.galleryWidth(this.getGalleryWidth()),this.itemWidth(this.getItemWidth()),this.setSwipe(),this.setImageViewers(),this.setGalleryPosition(1),this.defaultProductId>0?this.trySetProductImage(this.defaultProductId):n.selectedColour()&&n.selectedColour().colourWayId!==this.colourOptionImage().colourWayId&&this.trySetColour(n.selectedColour().colourWayId)},this.setGalleryPosition=function(e){this.galleryIndex(e),0===e?this.thumbIndex(this.galleryItems().length-1):this.thumbIndex(e),this.galleryPosition("-"+100*Math.abs(this.galleryIndex())+"%")},this.getItemWidth=function(){return 100/this.galleryItems().length+"%"},this.getGalleryWidth=function(){return 100*this.galleryItems().length+"%"},this.shuffleLastImage=function(e){var t=e,i=e[e.length-1];return t.unshift(i),t},this.moveLeft=function(){if(this.resetImageViewer(),0===this.galleryIndex())return this.animate(!1),this.setGalleryPosition(this.galleryItems().length-1),setTimeout(function(){this.animate(!0),this.setGalleryPosition(this.galleryItems().length-2),p.imageChanged||(a.fireEvent("carouselAction",{context:"chevronClick",carouselType:"productGallery",productIID:t.data.id,nextImagePosition:this.galleryIndex()}),p.imageChanged=!0)}.bind(this),10),!1;this.animate(!0),this.setGalleryPosition(this.galleryIndex()-1);var e=0===this.galleryIndex()?this.galleryItems().length-1:this.galleryIndex();return p.imageChanged||(a.fireEvent("carouselAction",{context:"chevronClick",carouselType:"productGallery",productIID:t.data.id,nextImagePosition:e}),p.imageChanged=!0),!1},this.moveRight=function(){return this.resetImageViewer(),this.galleryIndex()===this.galleryItems().length-1?(this.animate(!1),this.setGalleryPosition(0),setTimeout(function(){this.animate(!0),this.setGalleryPosition(1),p.imageChanged||(a.fireEvent("carouselAction",{context:"chevronClick",carouselType:"productGallery",productIID:t.data.id,nextImagePosition:this.galleryIndex()}),p.imageChanged=!0)}.bind(this),10),!1):(this.animate(!0),this.setGalleryPosition(this.galleryIndex()+1),p.imageChanged||(a.fireEvent("carouselAction",{context:"chevronClick",carouselType:"productGallery",productIID:t.data.id,nextImagePosition:this.galleryIndex()}),p.imageChanged=!0),!1)},this.selectThumbnail=function(e,i){this.exitVideo(),this.exitSpinViewer(),this.resetImageViewer(),this.animate(!1),this.setGalleryPosition(e),i===!0||p.thumbnailClick||(a.fireEvent(f,{context:"thumbnailClick",productIID:t.data.id,selectedImagePosition:e,zoomedIn:!1,pageType:"product"},!0),p.thumbnailClick=!0)}.bind(this),this.trySetColour=function(e){var t=i(e);if(-1!==t){var n=1;this.colourOptionImage(d[t]),this.exitVideo(),this.exitSpinViewer(),this.setGalleryPosition(n),this.imageViewersVisibility()[n]&&this.initImageViewer(n)}},this.trySetProductImage=function(e){for(var t=1,i=0;i<d.length;i++)if(d[i].productId===e){t=i+1;break}this.setGalleryPosition(t)},this.deselectThumbnails=function(){this.galleryIndex()>=0&&(u=this.galleryIndex()),this.setGalleryPosition(-2)},n.selectedColour.subscribe(function(e){void 0===e||null===e?(this.colourOptionImage(d[0]),this.initImageViewer(1)):e.colourWayId&&this.trySetColour(e.colourWayId)}.bind(this)),this.videoPlayerApi=e.observable(),this.exitVideo=function(){if(this.isVideoVisible(!1),this.videoPlayerApi()&&this.videoPlayerApi().stop)try{this.videoPlayerApi().stop()}catch(e){console.warn("could not stop video: "+e)}},document.body.addEventListener("modalClosed",function(){this.exitVideo()}.bind(this)),this.startVideoInFullScreen=this.isMobile,this.closeVideoOnFullScreenExited=this.isMobile,this.isVideoButtonVisible=e.observable(!1),this.isVideoVisible=e.observable(!1),this.playerParams=t.data.playerParams,this.playerParams.messages={errorHeaderText:n.resources.pdp_media_video_player_error_header,errorMessageText:n.resources.pdp_media_video_player_error_message,spinsetErrorMessageText:n.resources.pdp_media_spinset_error_message,refreshButtonText:n.resources.pdp_media_video_player_refresh_button,unsupportedHeaderText:n.resources.pdp_media_video_player_unsupported_header,unsupportedMessageText:n.resources.pdp_media_video_player_unsupported_message,closeButtonText:n.resources.pdp_media_video_player_close_button,hintDragText:n.resources.pdp_media_spinset_hint_drag,hintTapText:n.resources.pdp_media_spinset_hint_tap},this.onVideoButtonActivated=function(){p.videoFirstPlaybackCompleted=!1,this.isVideoVisible()||(u=this.thumbIndex()>=0?this.thumbIndex():u,this.resetImageViewer(),this.deselectThumbnails(),this.isVideoVisible(!0),this.exitSpinViewer(),this.videoPlayerApi().start(g),p.videoPlayerInit||(a.fireEvent(m,{context:"video",productIID:t.data.id,videoEvent:"start",fullScreen:this.startVideoInFullScreen,pageType:"product"},!0),p.videoPlayerInit=!0))};var g;this.videoPlayerApi.subscribe(function(e){e.events.on("playerExitRequested allLoopsEnded",function(){this.isVideoVisible()&&this.selectThumbnail(u,!0)}.bind(this)),e.events.on("progress",function(e,i){if(i.detail.value)for(var n in p.videoProgress){var r=parseInt(n,10);!p.videoProgress[n]&&i.detail.value>=r&&(p.videoProgress[n]=!0,a.fireEvent(m,{context:"video",productIID:t.data.id,videoEvent:n,fullScreen:i.detail.isFullScreen,pageType:"product"},!0))}});var i={formats:["m3u8","mp4","ogg"],preferredFPS:this.isMobile?25:50,preferredBitrates:{720:1200}};if(t.data.useProductIdForVideos)return void e.loadAssets(t.data.id,i,function(){this.isVideoButtonVisible(!0),this.checkIfInStockAndSetFlag()}.bind(this));if(t.data.media&&t.data.media.catwalkUrl){var n=o.getVideoPlayerAssetsProvider(t.data.playerParams.scene7.videoServer);n.getAssets(h.formatUrl(t.data.media.catwalkUrl),i).then(function(e){g=e,this.isVideoButtonVisible(!0),this.checkIfInStockAndSetFlag()}.bind(this))}}.bind(this)),this.spinViewerApi=e.observable(),this.exitSpinViewer=function(){this.spinViewerApi()&&this.spinViewerApi().zoomReset(),this.isSpinViewerVisible(!1)},this.spinSpeed=this.isMobile?1.5:3,this.showSpinViewerCloseButton=this.isMobile,this.showSpinViewerContainerHint=!this.isMobile,this.zoomFactors=[.5,1],this.isSpinViewerButtonVisible=e.observable(!1),this.isSpinViewerVisible=e.observable(!1),this.isSpinViewerPressed=e.computed(function(){return this.isMobile?this.isSpinViewerVisible().toString():void 0}.bind(this)),this.isSpinViewerLoadedWithoutErrors=e.observable(!1),this.spinViewerLabelText=e.observable(n.resources.pdp_misc_spinset),this.onSpinViewerButtonActivated=function(){this.spinViewerLabelText(n.resources.pdp_misc_gallery),this.isSpinViewerVisible()?this.isMobile&&(this.spinViewerLabelText(n.resources.pdp_misc_spinset),this.exitSpinViewer(),this.selectThumbnail(u,!0)):(u=this.thumbIndex()>=0?this.thumbIndex():u,this.resetImageViewer(),this.deselectThumbnails(),this.exitVideo(),this.isSpinViewerVisible(!0),this.spinViewerApi().init(),p.spinViewerInit||(a.fireEvent(f,{context:"360Launch",productIID:t.data.id,pageType:"product"},!0),p.spinViewerInit=!0))},this.spinViewerApi.subscribe(function(e){e.events.on("playerExitRequested",function(){this.isSpinViewerButtonVisible()&&this.selectThumbnail(u,!0)}.bind(this)),e.events.on("spun",function(){p.spinViewerSpin||(a.fireEvent(f,{context:"360Interaction",productIID:t.data.id,pageType:"product"},!0),p.spinViewerSpin=!0)}),e.events.on("zoomedIn",function(){p.spinViewerZoomIn||(a.fireEvent(f,{context:"360Zoom",productIID:t.data.id,pageType:"product"},!0),p.spinViewerZoomIn=!0)}),e.events.on("allImagesLoaded",function(e,t){t&&this.isSpinViewerLoadedWithoutErrors(t)}.bind(this));var i=t.data.id;e.loadAssets(i,function(){this.isSpinViewerButtonVisible(n.productData?n.productData.isInStock:!0)}.bind(this))}.bind(this)),this.imageData=e.observable(),this.imageViewerApis=e.observableArray([]),this.imageViewersVisibility=e.observableArray([]),this.areAllImageViewerApisReady=function(){for(var e=0;e<this.imageViewerApis().length;e++)if(!this.imageViewerApis()[e]())return!1;return!0},this.initImageViewer=function(e){var i=this.imageViewersVisibility(),n=this.imageData(),r=this.imageViewerApis()[e](),s=t.data.rootElement.querySelector('.image-container[data-gallery-index="'+e+'"] img.gallery-image');if(!s.complete)return void(s.onload=this.initImageViewer.bind(this,e));if(s.complete&&r&&n){i[e]=!0,this.imageViewersVisibility(i);var o=s.cloneNode();o.style.visibility="visible",r.setAssets(n[this.getImageIndexFromGalleryIndex(e)]),r.init(null,o),s.style.visibility="hidden"}},this.loadImagesMetadata=function(e){var i=o.getSpinViewerAssetsProvider(t.data.playerParams.scene7.imageServer);i.getAssets(e,function(e){this.imageData(e),this.checkIfInStockAndSetFlag()}.bind(this))},this.imageData.subscribe(function(e){if(e)for(var t=0;t<this.imageViewerApis().length;t++)this.initImageViewer(t)}.bind(this)),this.onImageViewerApiReady=function(e){var i=t.data.rootElement.querySelector('[data-gallery-index="'+e+'"]'),n=this.imageData();n&&this.initImageViewer(e,i)},this.getImageIndexFromGalleryIndex=function(t){var i=1===t?this.colourOptionImage():this.galleryItems()[t],n=e.utils.arrayFirst(d,function(e){return e.url===i.url});return d.indexOf(n)},this.setImageViewers=function(){for(var t,i=this.galleryItems(),n=[],r=0;r<d.length;r++)n.push(d[r].url);for(r=0;r<i.length;r++)t=e.observable(),this.imageViewerApis.push(t),this.imageViewersVisibility.push(!1),t.subscribe(this.onImageViewerApiReady.bind(this,r));this.loadImagesMetadata(n)},this.resetImageViewer=function(){var e=this.imageViewerApis()[this.galleryIndex()]&&this.imageViewerApis()[this.galleryIndex()]();e&&e.zoomReset()},this.setSwipe=function(){if(window.addEventListener){var e=document.querySelector(".product-gallery .window"),t=new s(e,{inputClass:s.TouchInput});t.on("swipeleft",function(){this.moveRight()}.bind(this)),t.on("swiperight",function(){this.moveLeft()}.bind(this))}},this.isSellingFastEnabled=e.observable(!1),this.showSellingFastLabel=e.computed(function(){var e=!this.isVideoVisible()&&!this.isSpinViewerVisible();return this.isInStock()&&t.state.sellingFast&&e&&this.isSellingFastEnabled()}.bind(this)),c.ifActive("t1280-web-selling-fast",!0).then(function(e){e&&(a.fireFeatureAnalytics(e.mvtExperience),e.isActive&&this.isSellingFastEnabled(!0))}.bind(this)),this.galleryText={thumbnailLabel:n.resources.pdp_media_gallery_thumbnail_label,carouselLabel:n.resources.pdp_media_gallery_carousel_label},this.init()}return{viewModel:d,template:i}}),define("text!Components/product-colour/product-colour.html",[],function(){return'<!-- ko if: render -->\r\n<section>\r\n    <div class="colour-size colour-component">\r\n        <div class="grid-row colour-section">\r\n            <label for="colourSelect" class="disabled" data-bind="text: colourLabel, visible: !hideLabels"></label>\r\n            <span class="product-colour" data-bind="visible: colourLabelVisible(), text: selectedColourLabel(), css: { disabled: isDisabled }"></span>\r\n            <div class="colour-size-select" data-bind="visible: colourDropdownVisible()">\r\n                <select id="colourSelect"\r\n                        data-id="colourSelect"\r\n                        data-bind="optionsCaption: selectColourText,\r\n                        disable: isDisabled,\r\n                        options: data,\r\n                        optionsAfterRender: setColourOptionText,\r\n                        value: colour,\r\n                        css:{ required : noColourSelected()},\r\n                        attr: {\r\n                            \'aria-describedby\': noColourSelected() ? \'selectColourError\' : null,\r\n                            \'aria-invalid\': noColourSelected() ? true : null\r\n                        }"></select>\r\n                <!-- ko if: noColourSelected() -->\r\n                <span id="selectColourError" class="error basic-error-box" data-bind="text:selectColourPrompt"></span>\r\n                <!-- /ko -->\r\n            </div>\r\n        </div>\r\n    </div>\r\n</section>\r\n<!-- /ko -->'}),define("Components/product-colour/product-colour",["ko","text!./product-colour.html","PageConfig"],function(e,t,i){function n(t){var n=t.state,r="undefined"!==t.hideOnOutOfStock?t.hideOnOutOfStock:!1;this.render=r&&!n.productData.isInStock?!1:!0,this.noColourSelected=t.state.showNoColourSelectedWarning,this.data=e.observableArray(),this.colour=n.selectedColour,this.hideLabels=t.hideLabels,this.useShortSelectColourLabel=t.useShortSelectColourLabel,this.selectColourPrompt=n.resources.pdp_select_colour_message,this.colourLabel=n.resources.pdp_misc_colour+":",this.isMobile="mobile"===i.platform,this.notAvailableText=n.resources.pdp_status_not_available,this.useShortSelectColourLabel?this.selectColourText=n.resources.pdp_select_colour_label:this.selectColourText=n.resources.pdp_select_colour_from_label,this.lowInStockText=n.resources.pdp_status_low_in_stock;var s=t.state.productData;this.isDisabled=!t.state.productData.isInStock;var o=s.colours,a=document.getElementById("colourSelect");this.noColourSelected.subscribe(function(e){e&&a.focus()}),this.data(o),this.selectColourText=this.selectColourText.replace("%{count}",this.data().length),this.colourDropdownVisible=e.computed(function(){return this.data().length>1}.bind(this)),this.colourLabelVisible=e.computed(function(){return!this.colourDropdownVisible()}.bind(this)),this.setColourOptionText=function(e,t){t&&(s.hasDifferentPrices?e.text=t.colour+" "+t.price.text:e.text=t.colour)},this.selectedColourLabel=e.computed(function(){return this.colour()?this.colour().colour:""}.bind(this)),this.setDefaultColour=function(){1===this.data().length&&this.colour(this.data()[0])},this.setDefaultColour(),this.setVariantColour=function(e,t){for(var i=0;i<e.length;i++)if(e[i].colourWayId===t){this.colour(e[i]);break}},t.state.defaultVariant&&this.setVariantColour(this.data(),t.state.defaultVariant.colourWayId)}return{viewModel:n,template:t}}),define("text!Components/product-size/product-size.html",[],function(){return'<!-- ko if: render -->\r\n<section>\r\n    <div class="colour-size size-component">\r\n        <div class="size-section" data-bind="visible: sizeSectionVisible()">\r\n            <div style="display: table; width: 100%">\r\n                <!-- ko if: (showFitAnalyticsSection() && !showNewIcon()) || !showFitAnalyticsSection() -->\r\n                    <label for="sizeSelect" style="display: table-cell; vertical-align: bottom" data-bind="text: sizeLabel, visible: !hideLabels, disable: isDisabled"></label>\r\n                <!-- /ko -->\r\n                <div style="display: table-cell; vertical-align: top; width: 100%">\r\n                    <!-- ko if: isOneSize -->\r\n                    <span class="product-size" data-bind="visible: sizeLabelVisible(), text: selectedSizeLabel(), css: { disabled: isDisabled }"></span>\r\n                    <!-- /ko -->\r\n                    <!-- ko if: !showFitAnalyticsSection() -->\r\n                    <div id="size-guide" class="size-guide" style="float: right;" data-bind=\'component: { name: "size-guide", params: {dictionary: sizeGuideDictionary , url: sizeGuideLink, visible: state.showSizeGuide, id:id}}\'></div>\r\n                    <!-- /ko -->\r\n                    <!-- ko if: showFitAnalyticsSection() && !isFitAssistantMvtCandidate() -->\r\n                    <div class="fit-analytics upper" style="line-height: 1.57; letter-spacing: 0.4px;" data-bind="style: { float: fitAnalyticsViewModel.recommendation() === fitAnalyticsViewModel.RecommendationType.None ? \'right\' : \'none\' }">\r\n                        <div class="table">\r\n                            <div class="cell" data-bind="click: fitAnalyticsOpen, visible: fitAnalyticsViewModel.recommendation() === fitAnalyticsViewModel.RecommendationType.None">\r\n                                <div class="circle" style="float: left">\r\n                                    <span class="no-recommendation"></span>\r\n                                </div>\r\n                            </div>\r\n                            <div class="cell">\r\n                                <a data-bind="click: fitAnalyticsOpen, text: fitAnalyticsLinkText"></a>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <!-- /ko -->\r\n                    <!-- ko if: showFitAnalyticsSection() && showPillDesign() -->\r\n                        <div class="fit-analytics upper">\r\n                            <button data-bind="click: fitAnalyticsOpen, attr:{\'aria-label\': fitAnalyticsMvtAriaText, \'class\': fitAnalyticsMvtVariantClass}">\r\n                                <span class="inner" data-bind="text: fitAnalyticsMvtText"></span>\r\n                            </button>\r\n                        </div>\r\n                    <!-- /ko -->\r\n                    <!-- ko if: showFitAnalyticsSection() && showNewIcon() -->\r\n                    <div class="fit-analytics upper">\r\n                        <a href="#" data-bind="click: fitAnalyticsOpen, attr:{\'class\': fitAnalyticsMvtVariantClass}">\r\n                            <div class="circle" style="float: left">\r\n                                <span class="fit-analytics-icon"></span>\r\n                            </div>\r\n                            <span class="inner" data-bind="text: fitAnalyticsMvtText"></span>\r\n                        </a>\r\n                    </div>\r\n                    <!-- /ko -->\r\n                </div>\r\n            </div>\r\n            <!-- ko if: !isOneSize -->\r\n            <span class="product-size" data-bind="visible: sizeLabelVisible(), text: selectedSizeLabel(), css: { disabled: isDisabled }"></span>\r\n            <!-- /ko -->\r\n            <div class="colour-size-select" data-bind="visible: sizeDropdownVisible(), markAndMeasure: \'pdp:size_selector_interactive\'">\r\n                <select id="sizeSelect"\r\n                        data-id="sizeSelect"\r\n                        data-bind="options: variants,\r\n                            optionsAfterRender: disableSizeIfOutOfStock,\r\n                            optionsText: \'Size\',\r\n                            optionsCaption: selectSizeText,\r\n                            value: size,\r\n                            disable: isDisabled || sizeDropdownDisabled(),\r\n                            css:{ required : noSizeSelected()},\r\n                            attr: {\r\n                                \'aria-describedby\': noSizeSelected() ? \'selectSizeError\' : null,\r\n                                \'aria-invalid\': noSizeSelected() ? true : null\r\n                            }"></select>\r\n                <!-- ko if: noSizeSelected() -->\r\n                <span id="selectSizeError" class="error basic-error-box" data-bind="text:selectSizePrompt"></span>\r\n                <!-- /ko -->\r\n            </div>\r\n        </div>\r\n        <div class="grid-row low-in-stock" data-bind="visible: isLowInStock() && !hideLowInStock">\r\n            <span class="clock"></span><span data-bind="text:lowInStockText"></span>\r\n        </div>\r\n    </div>\r\n</section>\r\n<!-- /ko -->\r\n';
}),define("Components/product-size/product-size",["ko","text!./product-size.html","ProductUtils/features/features"],function(e,t,i){function n(t){var n=t.data,r=t.state,s="undefined"!==t.hideOnOutOfStock?t.hideOnOutOfStock:!1;this.state=r,this.render=s&&!r.productData.isInStock?!1:!0,this.noSizeSelected=t.state.showNoSizeSelectedWarning,this.sizeGuideDictionary=t.state.resources,this.sizeGuideLink=n.sizeGuide,this.colour=r.selectedColour,this.size=r.selectedSize,this.alwaysDisplaySizeLabel=!1,this.isLowInStock=e.observable(!1),this.hideLabels=t.hideLabels,this.hideLowInStock=t.hideLowInStock,this.displayOnlyAsDropDown=t.displayOnlyAsDropDown||!1,this.doNotSelectDefaultSize=t.doNotSelectDefaultSize||this.displayOnlyAsDropDown,this.id=n.id,this.isOneSize=n.isOneSize,this.size.subscribe(function(){var e=void 0===this.size()?!1:this.size().isLowInStock===!0;this.isLowInStock(e)}.bind(this)),this.variants=e.computed(function(){return void 0===this.colour()?[]:this.colour().variants}.bind(this)),r.showSizeGuide||(r.showSizeGuide=e.observable(!1)),r.showSizeGuide(t.showSizeGuide===!0&&n.sizeGuideVisible),this.selectSizePrompt=r.resources.pdp_select_colour_size_message,this.sizeLabel=r.resources.pdp_misc_size+":",this.outOfStockText=r.resources.pdp_status_out_of_stock,this.notAvailableText=r.resources.pdp_status_not_available,this.selectSizeText=r.resources.pdp_select_size_label,this.lowInStockText=r.resources.pdp_status_low_in_stock;var o=t.state.productData;this.isDisabled=!t.state.productData.isInStock;for(var a=o.colours,l=0,c=a.length-1;c>=0;c--){var d=a[c];d.variants.length>l&&(l=d.variants.length)}var u=document.getElementById("sizeSelect");this.noSizeSelected.subscribe(function(e){e&&u.focus()}),!this.displayOnlyAsDropDown&&!n.isNoSize&&a.length>1&&1===l&&(this.alwaysDisplaySizeLabel=!0),this.colour.subscribe(function(e){void 0===e||1!==this.colour().variants.length||this.displayOnlyAsDropDown?this.setDefaultSize():this.size(this.colour().variants[0])}.bind(this)),this.sizeDropdownVisible=e.computed(function(){if(this.alwaysDisplaySizeLabel)return!1;if(this.displayOnlyAsDropDown)return!0;if(n.isNoSize)return!1;var e=void 0===this.colour(),t=e?0:this.colour().variants.length;return e||t>1}.bind(this)),this.sizeLabelVisible=e.computed(function(){return this.alwaysDisplaySizeLabel?!0:!this.displayOnlyAsDropDown&&!n.isNoSize&&!this.sizeDropdownVisible()}.bind(this)),this.sizeSectionVisible=e.computed(function(){return this.sizeLabelVisible()||this.sizeDropdownVisible()}.bind(this)),this.disableSizeIfOutOfStock=function(t,i){void 0!==i&&null!==i&&(t.text=i.isInStock?i.size:i.size+" - "+this.notAvailableText,e.applyBindingsToNode(t,{enable:i.isInStock},i))}.bind(this),this.sizeDropdownDisabled=e.computed(function(){return void 0===this.colour()}.bind(this)),this.selectedSizeLabel=e.computed(function(){return this.alwaysDisplaySizeLabel?a[0].variants[0].size:this.size()?this.size().size:""}.bind(this)),this.setDefaultSize=function(){if(!this.doNotSelectDefaultSize&&void 0!==o&&void 0!==this.variants()&&1===o.colours.length){for(var e,t=o.colours[0],i=t.variants.length-1;i>=0;i--)if(t.variants[i].isInStock){if(void 0!==e){e=void 0;break}e=this.variants()[i]}void 0!==e&&this.size(e)}},this.setVariantSize=function(e,t){for(var i=0;i<e.length;i++)if(e[i].variantId===t){if(!e[i].isInStock){this.size(void 0);break}this.size(e[i]);break}},t.useFitAnalytics&&t.state.fitAnalyticsViewModel()?this.fitAnalyticsViewModel=t.state.fitAnalyticsViewModel():this.fitAnalyticsViewModel={isLoaded:e.observable(!1)},this.showFitAnalyticsSection=e.computed(function(){if(!this.fitAnalyticsViewModel.isLoaded())return!1;if(!this.fitAnalyticsViewModel.recommendation)return!1;var e=void 0!==this.fitAnalyticsViewModel.recommendation();return e&&i.ifActive("t1270-web-fit-assistant-redesign",!0).then(function(e){e&&(this.initFitAssistantMvt(e),this.fitAnalyticsViewModel.recommendation.subscribe(this.initFitAssistantMvt.bind(this,e)))}.bind(this)),e}.bind(this)),this.getFitAnalyticsText=function(){if(this.fitAnalyticsViewModel.recommendation){var e;switch(this.fitAnalyticsViewModel.recommendation()){case this.fitAnalyticsViewModel.RecommendationType.Partial:e=r.resources.pdp_fit_analytics_recommendation_profile_partial;break;case this.fitAnalyticsViewModel.RecommendationType.Complete:e=r.resources.pdp_fit_analytics_recommendation_profile_complete;break;case this.fitAnalyticsViewModel.RecommendationType.OOS:e=r.resources.pdp_fit_analytics_recommendation_oos;break;default:e=r.resources.pdp_fit_analytics_recommendation_profile_none}if(e)return e.replace("%{size}",this.fitAnalyticsViewModel.recommendedSize())}},this.fitAnalyticsLinkText=e.computed(function(){return this.getFitAnalyticsText()}.bind(this)),this.fitAnalyticsOpen=function(){this.fitAnalyticsViewModel.openRecommendations&&this.fitAnalyticsViewModel.openRecommendations()}.bind(this),this.setDefaultSize(),t.state.defaultVariant&&this.setVariantSize(this.variants(),t.state.defaultVariant.variantId),this.isFitAssistantMvtCandidate=e.observable(!1),this.showPillDesign=e.observable(!1),this.showNewIcon=e.observable(!1),this.fitAnalyticsMvtText=e.computed(function(){return this.showPillDesign()||this.showNewIcon()?this.getFitAnalyticsMvtText().text:void 0}.bind(this)),this.fitAnalyticsMvtAriaText=e.computed(function(){return this.showPillDesign()?this.getFitAnalyticsMvtText().ariaText:void 0}.bind(this)),this.fitAnalyticsMvtVariantClass=e.computed(function(){return this.showPillDesign()?this.fitAnalyticsViewModel.recommendation()===this.fitAnalyticsViewModel.RecommendationType.OOS?"fa-mvt-bluepill fa-mvt-bluepill--oos":"fa-mvt-bluepill":this.showNewIcon()?this.fitAnalyticsViewModel.recommendation()===this.fitAnalyticsViewModel.RecommendationType.OOS?"fa-mvt-newicon fa-mvt-newicon--oos":"fa-mvt-newicon":void 0}.bind(this)),this.getFitAnalyticsMvtText=function(){if(this.showPillDesign()||this.showNewIcon()){var e,t;switch(this.fitAnalyticsViewModel.recommendation()){case this.fitAnalyticsViewModel.RecommendationType.Partial:e=this.showPillDesign()?r.resources.pdp_fit_analytics_mvt_v3_recommendation_profile_partial:r.resources.pdp_fit_analytics_recommendation_profile_partial,t=r.resources.pdp_fit_analytics_mvt_v3_recommendation_profile_partial_aria_label;break;case this.fitAnalyticsViewModel.RecommendationType.Complete:e=this.showPillDesign()?r.resources.pdp_fit_analytics_mvt_v3_recommendation_profile_complete:r.resources.pdp_fit_analytics_recommendation_profile_complete,t=r.resources.pdp_fit_analytics_mvt_v3_recommendation_profile_complete_aria_label;break;case this.fitAnalyticsViewModel.RecommendationType.OOS:e=this.showPillDesign()?r.resources.pdp_fit_analytics_mvt_v3_recommendation_oos:r.resources.pdp_fit_analytics_recommendation_oos,t=r.resources.pdp_fit_analytics_mvt_v3_recommendation_oos_aria_label;break;default:e=this.showPillDesign()?r.resources.pdp_fit_analytics_mvt_v3_recommendation_profile_none:r.resources.pdp_fit_analytics_recommendation_profile_none,t=e}if(!e)return;return{text:e.replace("%{size}",this.fitAnalyticsViewModel.recommendedSize()),ariaText:t.replace("%{size}",this.fitAnalyticsViewModel.recommendedSize())}}},this.initFitAssistantMvt=function(e){return"v2-icon"===e.variant?(this.isFitAssistantMvtCandidate(!0),void this.showNewIcon(!0)):"v3-pill"===e.variant?(this.isFitAssistantMvtCandidate(!0),void this.showPillDesign(!0)):void 0}}return{viewModel:n,template:t}}),define("text!Components/delivery-and-returns/delivery-and-returns.html",[],function(){return'<!-- ko if : !hideDeliveryLink-->\r\n<!-- ko if : features.deliveryAndReturnsModalEnabled -->\r\n<span><button class="link product-delivery" data-bind="text: deliveryReturnsLink, click: deliveryAndReturnsClicked"></button></span>\r\n<!-- /ko -->\r\n<!-- ko if : !features.deliveryAndReturnsModalEnabled -->\r\n<span><a href="#" class="product-delivery" target="_blank" data-bind="text: deliveryReturnsLink, attr : {href : url }"></a></span>\r\n<!-- /ko -->\r\n<!-- /ko -->\r\n'}),define("ProductUtils/SpinnerLoader",[],function(){return function(e){this.loader=null,e&&e.selector?this.loader=document.querySelector(e.selector):this.loader=document.querySelector(".loader"),this.show=function(){null!==this.loader&&(this.loader.style.display="block")},this.hide=function(){null!==this.loader&&(this.loader.style.display="none")}}}),define("ProductUtils/ModalWindow",["ko","PageConfig","ProductUtils/ComponentLoader","ProductUtils/SpinnerLoader"],function(e,t,i,n){return function(){this.components=new i,this.body=document.body,this.html=document.querySelector("html"),this.container=document.querySelector("#modal"),this.titleText=e.observable(""),this.lockBodyScroll=!0,this.title=this.container.querySelector(".modal-title h1"),this.content=this.container.querySelector(".modal-content"),this.closeArrow=this.container.querySelector(".modal-close"),this.modalScroll=this.container.querySelector(".modal-scroll"),this.modalWindow=this.container.querySelector(".modal-window"),this.modalCloseButton=this.container.querySelector(".modal-window .modal-close button.link"),this.customClasses=[],this.config=t;var r="mobile"===this.config.platform?".loader.mobile":".loader.fullwidth";this.loader=new n({selector:r}),this.componentName=null,this.hasLoaded=!1,this.open=function(e){e.showSpinner&&!this.hasLoaded&&this.loader.show(),this.setup(e),this.bindClose(),this.modalCloseButton.focus()},this.close=function(){this.tearDown()}.bind(this),this.setClass=function(e){this.customClasses.push(e),this.container.classList.add(e)},this.setAriaLabel=function(e){void 0!==e?this.modalWindow.setAttribute("aria-label",e):this.modalWindow.removeAttribute("aria-label")},this.setTitle=function(e){this.titleText(e),this.title.innerHTML=e},this.addContent=function(e){this.content.innerHTML=e,this.modalScroll.style.display=""},this.componentLoaded=function(){this.hasLoaded=!0,this.loader.hide()},this.addComponent=function(e,t,i){this.componentName=e;var n="modal-"+this.componentName,r='<div id="'+n+'"></div>';this.addContent(r),t.loadedCallback=this.componentLoaded.bind(this),this.components.register({type:this.componentName,name:this.componentName,elementId:n,useComponentTemplate:!0},t,i)},this.setup=function(e){this.body.classList.add("lockScroll"),this.html.classList.add("lockScroll"),this.setClass("open"),this.params=e},this.tearDown=function(){this.components.unregister(this.componentName),this.setTitle(""),this.setAriaLabel(),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.trapFocus),this.title.removeEventListener("click",this.stopEventPropagation),this.content.removeEventListener("click",this.stopEventPropagation),this.closeArrow.removeEventListener("click",this.onArrowClick),this.container.removeEventListener("click",this.close),this.content.style.height="";for(var e=0;e<this.customClasses.length;e++)this.container.classList.remove(this.customClasses[e]);this.body.classList.remove("lockScroll"),this.html.classList.remove("lockScroll");var t=document.createEvent("CustomEvent");t.initCustomEvent("modalClosed",!1,!1,{}),this.body.dispatchEvent(t),this.params&&this.params.openerElement&&this.params.openerElement.focus()},this.checkEscapeKey=function(e){return 27===e.keyCode?!0:!1},this.onKeyUp=function(e){this.checkEscapeKey(e)&&this.close()}.bind(this),this.stopEventPropagation=function(e){e.stopPropagation()},this.onArrowClick=function(e){this.close(),e.preventDefault(),e.stopPropagation()}.bind(this),this.trapFocus=function(e){var t=this.container.querySelectorAll('a[href], button, input[type="text"]'),i=t[0],n=t[t.length-1];("Tab"===e.key||9===e.keyCode)&&(e.shiftKey?document.activeElement===i&&(n.focus(),e.preventDefault()):document.activeElement===n&&(i.focus(),e.preventDefault()))}.bind(this),this.bindClose=function(){document.addEventListener("keyup",this.onKeyUp),this.title.addEventListener("click",this.stopEventPropagation),this.content.addEventListener("click",this.stopEventPropagation),this.closeArrow.addEventListener("click",this.onArrowClick),this.container.addEventListener("click",this.close),document.addEventListener("keydown",this.trapFocus)}}}),define("Models/LocalStorageWrapper",[],function(){return function(){var e=window.localStorage;return this.isStorageAvailable=function(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(i){return!1}},this.addItem=function(t,i,n){this.isStorageAvailable()&&e.setItem(t,JSON.stringify({item:i,expiry:n}))},this.getItem=function(t){if(this.isStorageAvailable()){var i=e.getItem(t);if(i){var n=JSON.parse(i);return new Date(n.expiry)<new Date?void e.removeItem(t):n.item}}},this}}),define("Components/delivery-and-returns/delivery-and-returns",["ko","text!./delivery-and-returns.html","ProductUtils/Ajax","Product.Config","PageConfig","ProductUtils/ModalWindow","ProductUtils/Analytics","Models/LocalStorageWrapper","Providers/SdkProvider"],function(e,t,i,n,r,s,o,a,l){function c(t){this.state=t.state,this.isCssTagAdded=!1,this.resources=t.state.resources,this.features=t.state.features,this.deliveryReturnsLink=t.state.resources.pdp_delivery_and_returns_button,this.apiUrl=n.deliveryApiEndpoint,this.hideDeliveryLink=t.hideDeliveryLink,this.modalWindow=new s,this.currentDeliveryAndReturnsData=null,this.isPremierUser=e.observable(null),this.ajax=new i;var c=new a,d={GB:!0,IE:!0,NL:!0,BE:!0,LU:!0,SE:!0,DK:!0,AT:!0,FI:!0,GR:!0,BG:!0,CY:!0,RO:!0,EE:!0,PL:!0,PT:!0,CZ:!0,LV:!0,LT:!0,SK:!0,SI:!0,HU:!0,HR:!0,MT:!0,HK:!0,SG:!0,NZ:!0};if(this.getExpiryDate=function(){var e=new Date;return e.setSeconds(0),e.setMilliseconds(0),e.setDate(e.getDate()+1),e},this.getDeliveryAndReturnsCountryCode=function(){var e=c.getItem("DeliveryAndReturnsCountryCode");return e?e:null}.bind(this),this.error=function(e){var t="";if(e.responseJSON&&Array.isArray(e.responseJSON)){var i=e.responseJSON[0];i.errorCode&&"DNR_"===i.errorCode.substring(0,4)&&(t=i.errorMessage)}t||(t=this.resources.pdp_delivery_and_returns_error_technical_difficulties_message);var n={content:t};this.showModal("error-container",this.resources.pdp_delivery_and_returns_error_technical_difficulties_title,n)}.bind(this),this.setDeliveryReturnsShippingOnlyLinkIfNotValidForCountry=function(e){d[e]||(this.deliveryReturnsLink=t.state.resources.pdp_delivery_and_returns_shipping_only_button)},this.setIsPremierUser=function(){var e=function(e){var t=e.length>0&&e.indexOf(r.countryCode)>=0?"true":"false";this.isPremierUser(t)}.bind(this);return l.getIdentity().then(function(t){return t.customer.subscriptions().then(e,e.bind(this,[]))}.bind(this))},"COM"===r.storeCode){var u=c.getItem("CountryCode");u?this.setDeliveryReturnsShippingOnlyLinkIfNotValidForCountry(u):r.geoCountryCode&&(this.setDeliveryReturnsShippingOnlyLinkIfNotValidForCountry(r.geoCountryCode),c.addItem("CountryCode",r.geoCountryCode,this.getExpiryDate()))}this.setDeliveryAndReturnsContent=function(e){var i={content:e.result,showCountrySelectionCallback:this.requestCountriesContent,closeModalCallback:this.modalWindow.close};this.currentDeliveryAndReturnsData=e,this.showModal("delivery-and-returns-content",i.content.title,i,t.state.resources.pdp_delivery_and_returns_content_aria_label)}.bind(this),this.setCountriesContent=function(e){var i={content:e.result.countries,currentDestination:this.currentDeliveryAndReturnsData.result.destination,countrySelectionCallback:this.newCountrySelected,cancelCallback:this.cancelCountrySelectionCallback};this.showModal("delivery-and-returns-countries",t.state.resources.pdp_delivery_and_returns_select_country_title,i,t.state.resources.pdp_delivery_and_returns_select_country_aria_label)}.bind(this),this.showModal=function(e,i,n,r){this.modalWindow.close(),this.modalWindow.addComponent(e,n,t.state),this.modalWindow.setTitle(i),this.modalWindow.setClass("modal-"+e),this.modalWindow.setAriaLabel(r),this.modalWindow.open({openerElement:document.querySelector("button.link.product-delivery")})}.bind(this),this.requestDeliveryAndReturnsContent=function(e){var t="";e&&(t="&deliverycountry="+e);var i={url:this.apiUrl+"?api=1"+t+"&userispremiercustomer="+this.isPremierUser(),callerContext:"DeliveryAndReturns.MainContent",successCallback:this.setDeliveryAndReturnsContent,errorCallback:this.error,apiName:"DeliveryAndReturns"};this.ajax.execute(i)}.bind(this),this.requestCountriesContent=function(){var e={url:this.apiUrl+this.DELIVERY_COUNTRIES_URL_PATH,callerContext:"DeliveryAndReturns.CountriesList",successCallback:this.setCountriesContent,errorCallback:this.error,apiName:"DeliveryAndReturns"};this.ajax.execute(e)}.bind(this),this.addCssTag=function(){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",r.flagsCssPath),document.querySelector("head").appendChild(e),this.isCssTagAdded=!0},this.deliveryAndReturnsClicked=function(){this.isCssTagAdded||this.addCssTag();var e=function(){var e=void 0!==t.state.productData?t.state.productData.productId:null;o.fireEvent("pageInteraction",{context:"freeDeliveryAndReturns",productIID:e});var i=this.getDeliveryAndReturnsCountryCode();this.requestDeliveryAndReturnsContent(i)}.bind(this);this.setIsPremierUser().then(e,e)}.bind(this),this.cancelCountrySelectionCallback=function(){this.setDeliveryAndReturnsContent(this.currentDeliveryAndReturnsData)}.bind(this),this.newCountrySelected=function(e){c.addItem("DeliveryAndReturnsCountryCode",e,this.getExpiryDate()),this.requestDeliveryAndReturnsContent(e)}.bind(this)}return c.prototype.DELIVERY_COUNTRIES_URL_PATH="countries/?api=1",{viewModel:c,template:t}}),define("text!Components/shipping-restrictions/shipping-restrictions.html",[],function(){return'<div class="shipping-restrictions" data-bind="visible: showShippingRestrictions">\r\n    <span><a id="shippingRestrictionsLink" href="#" data-bind="text:shippingRestrictionsLabel, click:openShippingRestrictions"></a></span>\r\n</div>'}),define("ProductUtils/FullProductApiClient",["ProductUtils/Ajax","Product.Config","ProductUtils/UrlUtils","PageConfig"],function(e,t,i,n){return function(){this.productArray=[],this.callbacks=[],this.ajax=new e;var r=new i,s=function(e){return void 0!==e&&null!==e?!0:!1};this.getFullProduct=function(e,t,i){return null!==e&&void 0!==e?this.requestData(e,t,i):void 0},this.requestData=function(e,i,r){var s=t.fullProductUrl,o=i?"shippingrestrictions":void 0;return this.ajax.execute({storeParams:{store:n.storeCode,currency:n.currency,lang:n.language,sizeSchema:n.sizeSchema,keyStoreDataversion:n.keyStoreDataversion,expand:o},url:s+e,apiName:"Product Catalogue",callerContext:r,errorCallback:this.error}).done(this.productRetrieved.bind(this))}.bind(this),this.productRetrieved=function(e){e.media.images=this.sortProductImages(e.media.images),e.media.catwalkUrl=this.getSingleCatwalkUrl(e);for(var t=0;t<e.media.images.length;t++){var i=e.media.images[t];i.isVisible=i.isPrimary||!s(i.colourWayId),i.url=r.formatUrl(i.url)}for(var n=0;n<e.variants.length;n++)e.variants[n].size=e.variants[n].brandSize,e.variants[n].sizeDescription&&(e.variants[n].size+=" - "+e.variants[n].sizeDescription);return e}.bind(this),this.sortProductImages=function(e){return e.sort(function(e,t){var i=t.isPrimary.toLocaleString().localeCompare(e.isPrimary.toLocaleString());if(0!==i)return i;if(void 0===e.colour||""===e.colour){if(void 0===t.colour||null===t.colour||""===t.colour)return e.type.toLocaleString().localeCompare(t.type.toLocaleString());if(t.colour&&t.colour.length>0)return 1}if(void 0===t.colour||null===t.colour||""===t.colour)return-1;var n=e.colour.toLocaleString().localeCompare(t.colour.toLocaleString());return n}),e}.bind(this),this.getSingleCatwalkUrl=function(e){return e&&e.media&&e.media.catwalk&&Array.isArray(e.media.catwalk)&&e.media.catwalk.length?e.media.catwalk[0].url:void 0},this.error=function(){}.bind(this)}}),define("Components/shipping-restrictions/shipping-restrictions",["ko","$","text!./shipping-restrictions.html","ProductUtils/Ajax","ProductUtils/ModalWindow","ProductUtils/FullProductApiClient","PageConfig","Product.Config"],function(e,t,i,n,r,s,o,a){function l(i){var l=new s;this.state=i.state,this.isInStock=this.state.productData.isInStock,this.ajax=new n;var c=i.data.shippingRestrictions;this.showShippingRestrictions=e.computed(function(){return this.isInStock&&c.shippingRestrictionsVisible}.bind(this)),this.shippingRestrictionsLabel=c.shippingRestrictionsLabel,this.getIncludedCountries=function(e,t){return e.excludedCountryCodes.length?t.filter(function(t){return 0===e.excludedCountryCodes.filter(function(e){return t.country===e}).length}).map(function(e){return e.name}):e.includedCountryCodes.length?t.filter(function(t){return e.includedCountryCodes.filter(function(e){return t.country===e}).length>0}).map(function(e){return e.name}):t.map(function(e){return e.name})},this.openShippingRestrictions=function(){var e=l.getFullProduct(i.data.productId,!0,"ShippingRestrictions"),n=this.ajax.execute({storeParams:{lang:o.language,keyStoreDataversion:o.keyStoreDataversion},url:a.storeApiClientUrl,api:"Store",callerContext:"ShippingRestrictions"});return t.when(e,n).done(function(e,t){var i=e[0].shippingRestriction,n=this.getIncludedCountries(i,t[0]);this.showModalContent({ShippableCountries:n,Description:this.state.resources.pdp_shipping_restrictions_only_ships_message})}.bind(this)),!1},this.showModalContent=function(e){var t=new r;t.addComponent("shipping-restrictions-content",e,this.state),t.setTitle(this.state.resources.pdp_shipping_restrictions_title),t.setClass("modal-shipping-restrictions-content"),t.open({showSpinner:!1,openerElement:document.querySelector("#shippingRestrictionsLink")})}}return{viewModel:l,template:i}}),define("text!Components/stock-price-retry/stock-price-retry.html",[],function(){return'<!-- ko if : state.showStockPriceRetry -->\r\n<div class="container">\r\n    <h1 data-bind="text: resources.pdp_status_error_stock_price_retry_title"></h1>\r\n    <div data-bind="text: resources.pdp_status_error_stock_price_retry_message"></div>\r\n\r\n    <a>\r\n        <span data-bind="click: retry, text: resources.pdp_status_error_stock_price_retry_button"></span>\r\n    </a>\r\n</div>\r\n\r\n<!-- /ko -->'}),define("Components/stock-price-retry/stock-price-retry",["ko","text!./stock-price-retry.html"],function(e,t){function i(e){this.resources=e.state.resources,this.retry=function(){e.state.retryCallback()}}return{viewModel:i,template:t}}),define("text!Components/save-button/save-button.html",[],function(){return'<div class="save-button" data-bind="click: componentClicked">\r\n    <a class="save-button-link" href="#" data-bind="click:saveProduct, clickBubble:false, css: { \'animate\' : isSaved, \'active\': active, \'out-of-stock-save-button\': !inStock }, markAndMeasure: \'pdp:save_for_later_interactive\'">\r\n        <span class="heartPrimary"></span>\r\n        <span data-bind="attr: {class : getCelebrationIconClass()}">\r\n            <span class="celebrationAnimation">\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n                <span></span>\r\n            </span>\r\n        </span>\r\n    </a>\r\n    <span class="toolTip" data-bind="html:message,visible:displayMessage,css: { \'fade\' : fade , \'error\':isError , \'nonError\':!isError()}"></span>\r\n</div>'}),define("Models/SavedItem",[],function(){return function(e,t,i,n,r,s){this.productId="",this.variantId="",this.sizeId="-1",this.imageUrl="",this.colour="",this.sellingFast=!1,this.init=function(){void 0!==e&&this.setProductId(e),void 0!==t&&this.setVariantId(t),void 0!==i&&this.setSizeId(i),void 0!==n&&this.setImageUrl(n),void 0!==r&&this.setColour(r),void 0!==s&&this.setSellingFast(s)},this.setProductId=function(e){var t=parseInt(e);t&&(this.productId=t)},this.setVariantId=function(e){var t=parseInt(e);t&&(this.variantId=t)},this.setSizeId=function(e){var t=parseInt(e);t&&(this.sizeId=t)},this.setImageUrl=function(e){"string"==typeof e&&(this.imageUrl=e)},this.setColour=function(e){"string"==typeof e&&(this.colour=e)},this.setSellingFast=function(e){"boolean"==typeof e&&(this.sellingFast=e)},this.setValuesViaState=function(e){e&&(e.selectedColour&&void 0!==e.selectedColour()&&this.setColour(e.selectedColour().colourName),e.selectedSize&&void 0!==e.selectedSize()&&(this.setVariantId(e.selectedSize().variantId),this.setSizeId(e.selectedSize().sizeId)),void 0!==e.sellingFast&&this.setSellingFast(e.sellingFast))},this.getObject=function(){return"-1"===this.sizeId&&this.setColour(""),{productId:this.productId,variantId:this.variantId,sizeId:this.sizeId,imageUrl:this.imageUrl,colour:this.colour,sellingFast:this.sellingFast}},this.init()}}),define("Components/save-button/save-button",["ko","text!./save-button.html","Models/SavedItem","featureSwitches","PageConfig","ProductUtils/Analytics","ProductUtils/NewRelicLogger","Providers/SdkProvider"],function(e,t,i,n,r,s,o,a){function l(t){function n(e,i){t.state&&t.state.toast&&(i&&t.state.toast.message(i),t.state.toast.displayMessage(e))}function r(){var e=l();if("object"==typeof e&&Object.keys(e).length>0){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!0;return!1}return!1}function l(){return window.__sdk.features.getFeaturesState()["web-event-icon"]}function d(){this.isSaved(!1),this.active(!1),this.displayMessage(!1),n(!1),clearTimeout(this.fadeTimer),clearTimeout(this.hideTimer)}function u(e){e&&(e.selectedSize.subscribe(function(){d.call(this)}.bind(this)),e.selectedColour.subscribe(function(){d.call(this)}.bind(this)))}function h(e){return e.map(function(e){var i={productId:t.productId?t.productId:e.productData.productId};return m(e)?i.variantId=m(e):p(e)&&(i.colourWayId=p(e)),i})}function p(e){return t.colourWayId?t.colourWayId:e.selectedSize()&&e.selectedSize().colourWayId?e.selectedSize().colourWayId:e.selectedColour()&&e.selectedColour().colourWayId?e.selectedColour().colourWayId:"function"==typeof e.mainImage?e.mainImage().colourWayId:e.productData.colours?e.productData.colours[0].colourWayId:void 0}function m(e){return e?e.selectedSize()&&e.selectedSize().variantId?e.selectedSize().variantId:e.selectedColour()&&e.selectedColour().variantId?e.selectedColour().variantId:void 0:!1}function f(e,t){return t.version?parseInt(t.version)>=e:!1}if(this.active=e.observable(!1),this.fade=e.observable(!0),this.displayMessage=e.observable(!1),this.message=e.observable(),this.isSaving=!1,this.isSaved=e.observable(!1),this.isCelebrationActive=r(),this.isError=e.observable(!1),this.isMixMatch=t.isMixMatch!==!0?!1:!0,this.hasSizeSelected=!1,this.fadeTimer=null,this.hideTimer=null,this.isMixMatch)for(var v=0;v<t.state.length;v++)u.call(this,t.state[v]);else u.call(this,t.state);this.getCelebrationIconClass=function(){var e="";if(this.isCelebrationActive){var t=l(),i=Object.keys(t).filter(function(e){return t[e]});i.length&&(e=" "+i[0])}return"heartSecondary"+e},this.inStock=!0,this.isInStock=function(e){return e?e.length>0?!0:e.productData.isInStock:!0},this.inStock=this.isInStock(t.state),this.saveProduct=function(){return this.active(!0),!this.inStock||this.isSaving||this.isSaved()?!1:void a.getSavedItems().then(function(e){c=e;var i,n;if(f(4,c))i="recentlyviewed"===t.context?[{productId:t.productData.productId,colourWayId:t.productData.colourWayId}]:h(this.isMixMatch?t.state:[t.state]),n=c.addItems({items:i});else{var r;this.isMixMatch?r=t.state:(r=[{productData:{productId:t.productId},productImage:t.productImage}],t.state&&(r[0].selectedSize=t.state.selectedSize,r[0].selectedColour=t.state.selectedColour)),i=this.createProductArray(r),n=c.addProducts(i)}s.saveVariants(i,t.context),this.watchPromise(n,i)}.bind(this))}.bind(this),this.watchPromise=function(e,i){var n=(Array.isArray(t.state)?t.state[0]:t.state)||{},r=n.resources||{};this.isSaving=!0,e.then(function(){this.isSaved(!0),this.isSaving=!1}.bind(this),function(){o.logError(new Error(o.ERROR_TYPE.UserActionFailed),{action:"SaveForLater",additionalData:JSON.stringify(i)}),this.active(!1),this.isSaving=!1,this.showMessage(r.pdp_status_error_not_saved,!0)}.bind(this))},this.createProductArray=function(e){for(var t,n=[],r=0;e.length>r;r++)t=new i(e[r].productData.productId,void 0,void 0,e[r].productImage,void 0),t.setValuesViaState(e[r]),n.push(t.getObject()),this.hasSizeSelected=!0;return n},this.componentClicked=function(){return this.displayMessage(!1),n(!1),!0}.bind(this),this.showMessage=function(e,t){this.isError(t),this.message(e),this.displayMessage(!0),n(!0,e),this.fade(!1),this.isSaved(!1),this.runTimer()},this.runTimer=function(){this.fadeTimer=setTimeout(function(){this.fade(!0),this.hideTimer=setTimeout(function(){this.displayMessage(!1)}.bind(this),1e3)}.bind(this),4500)}}var c;return{viewModel:l,template:t}}),define("text!Components/add-item/add-item.html",[],function(){return'<div class="add-item" data-bind="visible: isVisible">\r\n    <div class="is-add-item-saving" data-bind="visible: isBusy"></div>\r\n    <span class="aria-live" aria-role="status" aria-live="polite" data-bind="{ text: ariaLiveText, attr: { \'aria-label\': ariaLiveText }}"></span>\r\n    <a href="#" class="add-button" data-bind="click: addToBag, css : buttonCss, attr: { \'aria-label\': resources.pdp_cta_add_to_bag }, markAndMeasure: \'pdp:add_to_bag_interactive\'">\r\n        <span class="product-tick" data-bind="visible: showProductTick, text: iconText"></span>\r\n        <span data-bind="text: buttonText"></span>\r\n    </a>\r\n</div>'}),define("ProductUtils/ScrollTo",["$","ko"],function(e,t){return this.scrollToElement=function(t,i){var n=e(t);n.length>0&&e("html, body").animate({scrollTop:n.offset().top+i+"px"},"fast")},this.scrollToTop=function(){e("html, body").animate({scrollTop:"0px"},"fast")},t.bindingHandlers.scrollTo={init:function(i,n){var r=n(),s=t.unwrap(r),o=s,a=0;"object"==typeof s&&(o=s.selector,s.topPadding&&(a=s.topPadding)),e(i).click(function(){this.scrollToElement(o,a)}.bind(this))}},t.bindingHandlers.scrollToTop={init:function(t){e(t).click(function(){this.scrollToTop()}.bind(this))}},this}),define("Components/add-item/add-item",["$","ko","text!./add-item.html","ProductUtils/Bag","ProductUtils/ScrollTo","PageConfig"],function(e,t,i,n,r,s){function o(e){function i(t,i){e.state&&e.state.toast&&(i&&e.state.toast.message(i),e.state.toast.displayMessage(t))}this.isVisible=e.state.productData.isInStock,this.imgUrl=e.productImage,this.scrollToTop=e.scrollToTop,this.url=e.url,this.productId=e.state.productData.productId,this.resources=e.state.resources,this.selectedColour=e.state.selectedColour,this.selectedSize=e.state.selectedSize,this.noColourSelected=e.state.showNoColourSelectedWarning,this.noSizeSelected=e.state.showNoSizeSelectedWarning,this.addedToBag=t.observable(!1),this.showProductTick=t.observable(!1),this.failedToAdd=e.state.showAddToBagError,this.failedToAddMessage=e.state.addToBagErrorMessage,this.showTryAgain=t.observable(e.showTryAgain?e.showTryAgain:!1),this.buttonText=t.observable(this.resources.pdp_cta_add_to_bag),this.isBusy=t.observable(!1),this.ariaLiveText=t.computed(function(){var e=this.failedToAddMessage();return e?e:this.addedToBag()?this.resources.pdp_status_add_to_bag_success:""},this),this.buttonCss=t.computed(function(){return this.failedToAdd()&&this.showTryAgain()?"failed":this.isBusy()?"is-disabled":""}.bind(this)),this.iconText=t.computed(function(){return this.addedToBag()?"added to basket":"add to basket"}.bind(this)),this.selectedSize.subscribe(function(e){void 0!==e&&this.noSizeSelected()&&this.noSizeSelected(!1)}.bind(this)),this.selectedColour.subscribe(function(e){void 0!==e&&this.noColourSelected()&&this.noColourSelected(!1)}.bind(this));var o=new n(e,e.initiator);this.addToBag=function(){this.isBusy()||(this.revertState(),i(!1),void 0===this.selectedColour()?this.noColourSelected(!0):void 0===this.selectedSize()?this.noSizeSelected(!0):(this.isBusy(!0),
o.addItems(this.selectedSize(),this.addToBagResult)))};var a;this.addToBagResult=function(t){this.isBusy(!1),t.success?(this.addedToBag(!0),"buyTheLook"!==e.initiator&&this.showProductTick(!0),this.buttonText(this.resources.pdp_status_add_to_bag_success),this.scrollToTop&&"mobile"!==s.platform&&r.scrollToTop(),a&&clearTimeout(a),this.showMessage(this.resources.pdp_status_add_to_bag_toast),a=setTimeout(this.revertState,5e3)):(this.showTryAgain()&&this.buttonText(this.resources.pdp_status_error_add_item_try_again),this.failedToAdd(!0),this.failedToAddMessage(t.error))}.bind(this),this.revertState=function(){this.buttonText(this.resources.pdp_cta_add_to_bag),this.addedToBag(!1),this.showProductTick(!1),this.failedToAdd(!1),this.failedToAddMessage(""),this.isBusy(!1)}.bind(this),this.showMessage=function(e){"mobile"===s.platform&&i(!0,e)}}return{viewModel:o,template:i}}),define("text!Components/afterpay/afterpay.html",[],function(){return'<!-- ko if : shouldDisplayMessage -->\r\n<a data-bind="attr: { href: informationLinkUrl }" target="_blank" class="afterpay-component">\r\n    <p data-bind="text: afterpayMessaging"></p>\r\n    <span class="afterpay-information">\r\n        <span class="afterpay-logo" data-bind=\'attr : { "aria-label": afterpayLogoTranslation }\'></span>\r\n        <span class="product-information-light" data-bind=\'attr : { "aria-label": afterpayMoreInformationTranslation }\'></span>\r\n    </span>\r\n</a>\r\n<!-- /ko -->\r\n'}),define("asos-web-afterpay-installments",[],function(){"use strict";var e=function(e){return e?t(e)[0]:void 0},t=function(e){if(e){var t=Math.round(100*e),i=4,n=i-1,r=Math.ceil(t/i),s=t-n*r;return[r/100,r/100,r/100,Math.floor(s)/100]}},i={getSummary:e,getInstallments:t};return i}),define("Asos.Web.Currency.Formatter",["exports"],function(e){"use strict";function t(e){return Math.round(e)===e}var i={"default":{currencyFormatting:{"default":"1",RUB:"2"},numberFormat:"1"},"ar-AE":{currencyFormatting:{"default":"4"},numberFormat:"1"},"ar-KW":{currencyFormatting:{"default":"4"},numberFormat:"1"},"ar-QA":{currencyFormatting:{"default":"4"},numberFormat:"1"},"ar-SA":{currencyFormatting:{"default":"4"},numberFormat:"1"},"cs-CZ":{currencyFormatting:{"default":"4"},numberFormat:"3"},"de-DE":{currencyFormatting:{"default":"4"},numberFormat:"2"},"da-DK":{currencyFormatting:{"default":"4"},numberFormat:"2"},"en-AU":{currencyFormatting:{"default":"1",RUB:"2"},numberFormat:"1"},"en-GB":{currencyFormatting:{"default":"1",RUB:"2"},numberFormat:"1"},"en-US":{currencyFormatting:{"default":"1",RUB:"2"},numberFormat:"1"},"es-AR":{currencyFormatting:{"default":"1",RUB:"2"},numberFormat:"1"},"es-CL":{currencyFormatting:{"default":"1",RUB:"2"},numberFormat:"1"},"es-ES":{currencyFormatting:{"default":"4"},numberFormat:"2"},"es-MX":{currencyFormatting:{"default":"1",RUB:"2"},numberFormat:"1"},"fa-IR":{currencyFormatting:{"default":"4"},numberFormat:"1"},"fr-FR":{currencyFormatting:{"default":"4"},numberFormat:"3"},"he-IL":{currencyFormatting:{"default":"4"},numberFormat:"1"},"hi-IN":{currencyFormatting:{"default":"4"},numberFormat:"1"},"it-IT":{currencyFormatting:{"default":"4"},numberFormat:"2"},"ja-JP":{currencyFormatting:{"default":"2"},numberFormat:"1"},"ko-KR":{currencyFormatting:{"default":"2"},numberFormat:"1"},"ms-MY":{currencyFormatting:{"default":"2"},numberFormat:"1"},"nl-NL":{currencyFormatting:{"default":"2"},numberFormat:"2"},"pl-PL":{currencyFormatting:{"default":"4"},numberFormat:"3"},"ru-RU":{currencyFormatting:{"default":"4"},numberFormat:"3"},"sv-SE":{currencyFormatting:{"default":"4"},numberFormat:"2"},"tr-TR":{currencyFormatting:{"default":"4"},numberFormat:"1"},"uk-UA":{currencyFormatting:{"default":"4"},numberFormat:"4"}},n={1:{negative:"-{C}{N}",positive:"{C}{N}"},2:{negative:"-{C} {N}",positive:"{C} {N}"},3:{negative:"-{N}{C}",positive:"{N}{C}"},4:{negative:"-{N} {C}",positive:"{N} {C}"}},r={AED:{"default":"AED"},AUD:{"default":"$"},CAD:{"default":"C$"},CHF:{"default":"CHF"},CNY:{"default":""},CZK:{"default":"K"},DKK:{"default":"DKK","da-DK":"kr."},EUR:{"default":""},GBP:{"default":""},HKD:{"default":"HKD$"},ILS:{"default":"ILS"},INR:{"default":"INR"},IRR:{"default":"IRR"},JPY:{"default":"JPY"},KRW:{"default":"KRW"},KWD:{"default":"KWD"},MYR:{"default":"RM"},NOK:{"default":"NOK"},NZD:{"default":"NZD$"},PLN:{"default":"PLN","pl-PL":"z."},QAR:{"default":"QAR"},RUB:{"default":"."},SAR:{"default":"SAR"},SEK:{"default":"SEK"},SGD:{"default":"SGD$"},TRY:{"default":"TRY"},TWD:{"default":"NT$"},UAH:{"default":"UAH"},USD:{"default":"$"}},s={1:"###,###.##",2:"###.###,##",3:"### ###,##",4:"### ###.##"},o={cultures:i,currencyFormats:n,currencySymbols:r,numberFormats:s},a=new RegExp(/(#+)([^#])(#+)([^#]|$)(#+|$)/g),l="-",c=function(e){var t=e.split(a).filter(function(e){return""!==e});if(!(t.length<3))return{digitGroupingLength:t[0].length,digitGroupingSymbol:t[1],digitsBeforeDecimal:t[2].length,decimalSeparator:t[3],decimalPlaces:t[4]?t[4].length:0}},d=function(e){return e.split("").reverse().join("")},u=function(e,t,i){var n=i.digitGroupingSymbol,r=i.digitGroupingLength,s=i.digitsBeforeDecimal,o=i.decimalSeparator,a=i.decimalPlaces,c=!!o&&!t,u=t?Math.abs(e).toString():Math.abs(e).toFixed(a),h=d(u).split(""),p=c?a+1+s:s,m=h.reduce(function(e,t,i){if(!c&&i===s)return"".concat(t).concat(n).concat(e);if(c&&i===a)return"".concat(o).concat(e);var l=i>=p,d=(i-p)%r===0;return l&&d?"".concat(t).concat(n).concat(e):"".concat(t).concat(e)});return 0>e?"".concat(l).concat(m):m},h=function(e,i){if(i&&!t(e))throw new Error("Value must be an integer when formatAsInteger is set to true, else numeric precision will be lost")},p=function(e,t,i){var n=Number(e);if(isNaN(n)||!isFinite(n))return e;h(n,i);var r=o.cultures[t]||o.cultures["default"],s=o.numberFormats[r.numberFormat],a=c(s);return a?u(n,i,a):e},m="{N}",f="{C}",v=function(e,t){var i=o.currencySymbols[e];if(!i)return"";var n=i[t]||i["default"];return n},g=function(e,t,i,n){var r=Number(e);if(!b(r))return e;var s=v(i,t),o=y(t,i);if(!s)return e;var a=p(Math.abs(r),t,n),l=0>r?o.negative:o.positive,c=l.replace(f,s);return c=c.replace(m,a)},b=function(e){return!isNaN(e)&&isFinite(e)},y=function(e,t){var i=o.cultures[e]||o.cultures["default"],n=i.currencyFormatting[t]||i.currencyFormatting["default"];return o.currencyFormats[n]};e.formatPrice=g,e.formatValue=p,e.getCurrencySymbol=v,Object.defineProperty(e,"__esModule",{value:!0})}),define("Components/afterpay/afterpay",["ko","text!./afterpay.html","PageConfig","asos-web-afterpay-installments","Asos.Web.Currency.Formatter"],function(e,t,i,n,r){function s(t){this.afterpay=t.state.afterpay,this.instalmentsTranslation=t.state.resources.pdp_payment_provider_afterpay_instalments,this.afterpayLogoTranslation=t.state.resources.pdp_payment_provider_afterpay_name,this.afterpayMoreInformationTranslation=t.state.resources.pdp_payment_provider_afterpay_more_information_link_text,this.price=t.data.price,this.informationLinkUrl=i.siteDomain+"/customer-service/customer-care/afterpay/?WT.oss=afterpay&ctaref=product%20page",this.shouldDisplayMessage=e.computed(function(){return this.afterpay?this.price()>=this.afterpay.minimumTransactionAmount&&this.price()<=this.afterpay.maximumTransactionAmount:void 0}.bind(this)),this.afterpayMessaging=e.computed(function(){var e=n.getSummary(this.price()),t=r.formatPrice(e,i.language,i.currency);return this.instalmentsTranslation.replace("%{price}",t)}.bind(this))}return{viewModel:s,template:t}}),define("text!Components/fit-analytics/fit-analytics.html",[],function(){return'<div id="product-size" data-bind=\'component:{\r\n    name: "product-size",\r\n    params: {\r\n        hideLabels: false,\r\n        hideLowInStock: false,\r\n        showSizeGuide: true,\r\n        state: state,\r\n        data: product,\r\n        useFitAnalytics: true,\r\n        hideOnOutOfStock : true}\r\n    }\'></div>\r\n<div class="aside-action">\r\n    <div id="product-add" data-bind=\'component:{name: "add-item",\r\n                     params:{\r\n                         productId: product.id,\r\n                         productImage : product.images[0].url,\r\n                         scrollToTop: true,\r\n                         state: state,\r\n                         initiator : "main"\r\n                     }}\'></div>\r\n    <div id="product-save" data-bind=\'component:{name: "save-button",\r\n                     params:{\r\n                         productData : product,\r\n                         productId: product.id,\r\n                         productImage : product.images[0].url,\r\n                         state: state\r\n                     }\r\n                     }\'></div>\r\n    <div class="add-item-error error-message" data-bind="visible: state.showAddToBagError, html: state.addToBagErrorMessage" style="display: none">\r\n    </div>\r\n</div>\r\n<!-- ko if: showLowerSection -->\r\n<div class="fit-analytics lower">\r\n    <div class="size-guide-wrapper">\r\n        <label data-bind="text: lowerHeader"></label>\r\n        <span data-bind="text: lowerPreLinkText"></span>\r\n        <a data-bind="click: openRecommendations, text: lowerLinkText"></a>\r\n        <span data-bind="text: lowerPostLinkText"></span>\r\n        <div id="size-guide" class="size-guide" data-bind=\'component: { name: "size-guide", params: {dictionary: sizeGuideDictionary , url: product.sizeGuide, visible: state.showSizeGuide, id: product.id}}\'></div>\r\n        <span data-bind="text: lowerPostSizeGuideText"></span>\r\n    </div>\r\n</div>\r\n<!-- /ko -->\r\n'}),define("Components/fit-analytics/fit-analytics",["ko","text!./fit-analytics.html","$","PageConfig","ProductUtils/Analytics","Providers/SdkProvider"],function(e,t,i,n,r,s){function o(t){function o(){return this.resources.pdp_fit_analytics_sizing_help_intro}function a(e){return e&&e.split("%{splitPoint}")[0]}function l(e){return e&&e.split("%{splitPoint}")[1].split("%{link}")[0]}function c(e){return e&&e.split("%{link}")[1].split("%{linkEnd}")[0]}function d(e){return e&&e.split("%{linkEnd}")[1]}function u(){switch(n.storeCode){case"COM":return"GB";case"ROW":return"ASOS_ROW";case"ROE":return"ASOS_ROE";default:return n.storeCode}}var h=this;this.enabled=!1,this.visible=e.observable(!1),this.viewData=t.data,this.state=t.state,this.product=t.data,this.widget=void 0,this.resources=t.state.resources,this.isRecognised=e.observable(!1),this.features=t.state.features,this.state.fitAnalyticsViewModel(this);var p=[],m=!1;this.analyticsContext={analyticsLoadEventFired:!1,hasPreviousPurchases:!1,bodyPart:void 0},this.RecommendationType={None:1,Partial:2,Complete:3,OOS:4},this.recommendation=e.observable(void 0),this.recommendedSize=e.observable(),this.recommendedDisplaySize=e.observable(),this.recommendationText=e.observable(),this.userInfoLevel=e.observable(),this.displayLinkText=e.computed(function(){return-1!==[this.RecommendationType.None,this.RecommendationType.Complete,this.RecommendationType.Partial,this.RecommendationType.OOS].indexOf(this.recommendation())},this),this.recommendedSize.subscribe(function(e){this.recommendedDisplaySize(this.trimRecommendationSize(e))}.bind(this)),this.init=function(){var e=this.isMobileDevice(n.platform);this.isEnabled(this.viewData.isInStock,e,n.storeCode,this.features)&&s.getIdentity().then(function(t){t.customer.customerId().then(function(i){t.customer.isRecognised().then(function(t){this.isRecognised(t);var n=this.createFitData(this.viewData,i,this.state,e);this.createWidget(n)}.bind(this))}.bind(this))}.bind(this))},this.createFitData=function(e,t,i,r){t||(t="");var s={productId:"asos-"+e.productCode,thumbnail:i.mainImage().url,userId:t,showMobile:r,prefetch:!0,shopCountry:u(),language:n.languageShort,shopSizingSystem:n.sizeSchema,manufacturedSizes:this.getSizes(e.variants)};return s},this.isMobileDevice=function(e){return"mobile"===e},this.isEnabled=function(e,t,i,n){return e&&this._hasMoreThanOneSize()?t?n.fitAnalyticsEnabledStoresMobile.indexOf(i.toLowerCase())>-1:n.fitAnalyticsEnabledStores.indexOf(i.toLowerCase())>-1:!1},this.getSizes=function(e){for(var t={},i=0;i<e.length;i++){var n=this.formatSizes(e[i].size);t[n]=e[i].isInStock}return t},this._hasMoreThanOneSize=function(){return!this.product.isNoSize&&!this.product.isOneSize}.bind(this),this.formatSizes=function(e){var t=e.split("-"),i=t[0].replace(/\s+$/,"");return i};var f=function(){var e={recommendationType:h.recommendation(),hasPreviousPurchaseData:h.analyticsContext.hasPreviousPurchases,userSignedIn:h.isRecognised(),recommendedSize:h.recommendedSize()};return h.analyticsContext.bodyPart&&(e.bodyCategory=h.analyticsContext.bodyPart),e};this.getPurchaseChildSKU=function(e){return e.variantId.replace(/^asos-/i,"")},this.onMetricEventReceived=function(e,t){if(this.fireAnalyticsLoadEvent(),m&&p.push({event:e,value:t}),"managePurchasesScreen"===e&&"submit"===t){var i=h.widget.data.purchases.filter(function(e){return e.isIncluded}).map(this.getPurchaseChildSKU),n=h.widget.data.purchases.filter(function(e){return!e.isIncluded}).map(this.getPurchaseChildSKU);this.fireAnalyticsSaveSelectionsEvent(i,n)}},this.fireAnalyticsSaveSelectionsEvent=function(e,t){r.fireFitAnalyticsSaveSelectionsEvent({selected:e,deselected:t})},this.fireAnalyticsLoadEvent=function(){if(this.visible()&&!this.analyticsContext.analyticsLoadEventFired){var e=f();r.fireFitAnalyticsLoadEvent(e),this.analyticsContext.analyticsLoadEventFired=!0}},this.fireAnalyticsOutOfScaleEvent=function(){var e=f();r.fireFitAnalyticsOutOfScaleEvent(e)},this.trimRecommendationSize=function(e){return e?e.replace(/(in|cm|UK|EU|Chest)/g,"").split("-")[0].trim():e},this.onRecommendationReceived=function(e,t){if(this.visible(!0),t&&void 0!==t.hasPastPurchases&&(this.analyticsContext.hasPreviousPurchases=t.hasPastPurchases),this.recommendation(this.RecommendationType.None),this.recommendedSize(void 0),this.recommendationText(this.resources.pdp_fit_analytics_recommendation_profile_none),"new user"===e)return void this.fireAnalyticsLoadEvent();if(t){if(this.userInfoLevel(t.userInfoLevel),t.outOfScale)return void this.fireAnalyticsOutOfScaleEvent();if(e&&this.recommendedSize(e),t.outOfStock)return this.recommendationText(this.resources.pdp_fit_analytics_recommendation_oos.replace("%{size}",e)),this.recommendation(this.RecommendationType.OOS),void this.fireAnalyticsLoadEvent();1===t.userInfoLevel?(this.recommendationText(this.resources.pdp_fit_analytics_recommendation_profile_partial.replace("%{size}",e)),this.recommendation(this.RecommendationType.Partial)):2===t.userInfoLevel&&(this.recommendationText(this.resources.pdp_fit_analytics_recommendation_profile_complete.replace("%{size}",e)),this.recommendation(this.RecommendationType.Complete)),this.lastRecommendationDetails=t,this.fireAnalyticsLoadEvent()}},this.onLoadReceived=function(e){e&&e.garment&&(this.analyticsContext.bodyPart=e.garment.category),this.isLoaded(!0),this.fireAnalyticsLoadEvent()},this.openRecommendations=function(){if(this.widget){this.widget.open();var e=f();r.fireFitAnalyticsOpenWidgetEvent(e)}},this.onWidgetOpened=function(){m=!0},this.onWidgetClosed=function(){var e=f();e.widgetScreenEvents=p.slice(0),r.fireFitAnalyticsCloseWidgetEvent(e),m=!1,p.length=0},this.isLoaded=e.observable(!1),this.createWidget=function(e){window._fitAnalytics=function(){h.widget=new FitAnalyticsWidget({productId:e.productId,thumb:e.thumbnail,manufacturedSizes:e.manufacturedSizes,userId:e.userId,language:e.language,showMobile:e.showMobile,shopCountry:e.shopCountry,shopSizingSystem:e.shopSizingSystem,prefetch:e.prefetch,close:function(e,t,i){h.onRecommendationReceived(t,i),h.onWidgetClosed()},open:function(){h.onWidgetOpened()},metricEvent:function(e,t,i){h.onMetricEventReceived(e,t,i)},error:function(){},recommend:function(e,t,i){h.onRecommendationReceived(t,i)},load:function(e,t){h.onLoadReceived(t),h.widget.getRecommendation(),i("#existing-size-chart").hide()}})};var t=document.createElement("script");t.id="fitAnalyticsScript",t.src="//widget.fitanalytics.com/widget.js",t.crossOrigin="anonymous",document.body.appendChild(t)},this.showLowerSection=e.computed(function(){return this.isLoaded()?2!==this.userInfoLevel()?!0:this.state.showSizeGuide():!1}.bind(this)),this.getLowerText=function(e){if(this.recommendation()===this.RecommendationType.None)return e(this.resources.pdp_fit_analytics_sizing_help_profile_none);switch(this.userInfoLevel()){case 1:return e(this.resources.pdp_fit_analytics_sizing_help_profile_partial);case 2:return e(this.resources.pdp_fit_analytics_sizing_help_profile_complete);default:return e(this.resources.pdp_fit_analytics_sizing_help_profile_none)}},this.lowerHeader=this.resources.pdp_fit_analytics_sizing_help_title,this.lowerPreLinkText=e.computed(function(){return o.call(this)}.bind(this)),this.lowerPostLinkText=e.computed(function(){return this.state.showSizeGuide()?this.getLowerText(l):void 0}.bind(this)),this.lowerPostSizeGuideText=e.computed(function(){var e=this.getLowerText(d);if(e&&!(e.length<=1))return e}.bind(this)),this.lowerLinkText=e.computed(function(){var e=this.getLowerText(a);if(this.lowerPostLinkText())return e;var t=this.getLowerText(d);return!t||t.length>1?e:e+t}.bind(this)),this.sizeGuideDictionary={pdp_size_guide_link:e.computed(function(){if(this.state.showSizeGuide()){var e=this.getLowerText(c),t=this.getLowerText(d);return!t||t.length>1?e:e+t}}.bind(this))},this.init()}return{viewModel:o,template:t}}),define("text!Components/toast/toast.html",[],function(){return'<span class="toast" data-bind="html: message, visible: displayMessage, css: { \'fade\': fade }"></span>'}),define("Components/toast/toast",["ko","text!./toast.html"],function(e,t){function i(t){this.fade=e.observable(!1),this.displayMessage=t.state.toast.displayMessage,this.message=t.state.toast.message,this.fadeTimer=null,this.hideTimer=null,this.message.subscribe(function(e){clearTimeout(this.fadeTimer),clearTimeout(this.hideTimer),e&&(this.fade(!1),this.runTimer())}.bind(this)),this.displayMessage.subscribe(function(e){clearTimeout(this.fadeTimer),clearTimeout(this.hideTimer),e&&(this.fade(!1),this.runTimer())}.bind(this)),this.runTimer=function(){this.fadeTimer=setTimeout(function(){this.fade(!0),this.hideTimer=setTimeout(function(){this.displayMessage(!1)}.bind(this),1e3)}.bind(this),4500)}}return{viewModel:i,template:t}}),define("ProductUtils/OutOfStockAnimator",[],function(){function e(){function e(){return window.innerWidth<720}function t(){var e=C.filter(function(e){return S.submodulesCompleted[e]()===S.CAROUSEL_LOADING_STATE.NOT_LOADED});return 0!==e.length}function i(){var e=C.filter(function(e){return S.submodulesCompleted[e]()===S.CAROUSEL_LOADING_STATE.HAS_DATA});return 0!==e.length}function n(){if(x===I.ANIMATION_STATUS.UP){for(var e in _)_[e].dispose();b.removeEventListener("click",n,!0),I.animateDown()}}function r(){setTimeout(function(){b.addEventListener("click",n,!0)},I.ANIMATION_DURATION)}function s(){if(x===I.ANIMATION_STATUS.INITIAL&&S&&!t()&&i()){if(a(),!y)return setTimeout(s,I.DOM_CHECK_INTERVAL);I.animateUp(),r()}}function o(){x===I.ANIMATION_STATUS.INITIAL||i()||I.animateDown()}function a(){p=document.querySelector("#asos-product"),g=document.querySelector("#lower-content"),m=document.querySelector(".product-gallery"),b=document.querySelector("#asos-product > #core-product"),y=document.querySelector(".product-code"),f=document.getElementById("aside-content"),v=f.innerHTML}function l(e){return e.getBoundingClientRect().top+document.documentElement.scrollTop}function c(e){return e.getBoundingClientRect().bottom+document.documentElement.scrollTop}function d(){f.style.display="none",f.innerHTML="";var e=document.createElement("div");e.id="newAsideContainer",e.classList.add("layout-aside"),e.innerHTML=v,g.insertBefore(e,g.firstChild)}function u(){var e=document.getElementById("newAsideContainer");f.innerHTML=e.innerHTML,f.style.display="block",g.removeChild(e)}function h(){e()&&(x===I.ANIMATION_STATUS.INITIAL&&d(),x===I.ANIMATION_STATUS.SEQUENCE_COMPLETED&&u())}var p,m,f,v,g,b,y,S,w,I=this,_=[],C=["buyTheLook","recommendations","recentlyViewed"],x=I.ANIMATION_STATUS.INITIAL;this.isClickTargetHigherThanLowerContent=function(e){return e.getBoundingClientRect().top<g.getBoundingClientRect().top},this.subscribeToLoadingState=function(e){S=e,_.push(S.submodulesCompleted.buyTheLook.subscribe(s)),_.push(S.submodulesCompleted.recommendations.subscribe(s)),_.push(S.submodulesCompleted.recentlyViewed.subscribe(s)),_.push(S.submodulesCompleted.recentlyViewed.subscribe(o))},this.getAnimationTopPosition=function(){return e()?I.ANIMATION_TOP_POSITION.MOBILE:c(y)-l(m)+I.ANIMATION_TOP_POSITION.DESKTOP},this.animateUp=function(){a(),h(),x=I.ANIMATION_STATUS.MOVING_UP,w=m.getBoundingClientRect().height,m.style.maxHeight=w+"px",setTimeout(function(){m.style.maxHeight=I.getAnimationTopPosition()-I.GALLERY_MARGIN[e()?"MOBILE":"DESKTOP"]+"px",p.classList.add("animated-up"),setTimeout(function(){x=I.ANIMATION_STATUS.UP},I.ANIMATION_DURATION)},I.ANIMATION_TIMEOUT_DELAY)},this.animateDown=function(){a(),x=I.ANIMATION_STATUS.MOVING_DOWN,m.style.maxHeight=w+"px",p.classList.add("animating-down"),setTimeout(function(){m.removeAttribute("style"),p.classList.remove("animated-up"),p.classList.remove("animating-down"),x=I.ANIMATION_STATUS.SEQUENCE_COMPLETED,h()},I.ANIMATION_DURATION)}}var t=e.prototype;return t.ANIMATION_DURATION=2e3,t.DOM_CHECK_INTERVAL=250,t.ANIMATION_TOP_POSITION={MOBILE:190,DESKTOP:40},t.GALLERY_MARGIN={MOBILE:0,DESKTOP:30},t.ANIMATION_TIMEOUT_DELAY=20,t.ANIMATION_STATUS={INITIAL:0,MOVING_UP:1,UP:2,MOVING_DOWN:3,SEQUENCE_COMPLETED:4},new e}),define("text!Components/delivery-and-returns-content-table/delivery-and-returns-content-table.html",[],function(){return'<div class="delivery-options">\r\n    <!-- ko if : !isMobile-->\r\n    <hr />\r\n    <!-- ko foreach: content.deliveryGroups -->\r\n    <table>\r\n        <thead>\r\n            <tr class="delivery-and-returns-group-name">\r\n                <th scope="colgroup" colspan="3">\r\n                    <h2 data-bind="text: name"></h2>\r\n                </th>\r\n            </tr>\r\n            <!-- ko if:$index()===0 -->\r\n            <tr class="delivery-and-returns-headings">\r\n                <th scope="col" data-bind="text: $parent.content.deliveryGroupHeaders.type"></th>\r\n                <th scope="col" data-bind="text: $parent.content.deliveryGroupHeaders.when"></th>\r\n                <th scope="col" data-bind="text: $parent.content.deliveryGroupHeaders.howMuch"></th>\r\n            </tr>\r\n            <!-- /ko -->\r\n        </thead>\r\n        <tbody data-bind="foreach: options">\r\n            <tr>\r\n                <th scope="row" class="delivery-type" data-bind="html: type"></th>\r\n                <td class="delivery-when" data-bind="html: when"></td>\r\n                <td class="delivery-how-much" data-bind="with: $parents[1].formatHowMuch(howMuch)">\r\n                    <span class="delivery-cost" data-bind="html: price"></span>\r\n                    <span class="delivery-free-condition" data-bind="html: freeCondition"></span>\r\n                    <span class="delivery-premier-qualifier" data-bind="html: premierQualifier"></span>\r\n                </td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n    <hr />\r\n    <!-- /ko -->\r\n    <!-- /ko -->\r\n    <!-- ko if : isMobile-->\r\n    <!-- ko foreach: content.deliveryGroups -->\r\n    <table>\r\n        <thead>\r\n            <tr class="delivery-and-returns-group-name">\r\n                <th scope="colgroup" colspan="2">\r\n                    <h2 data-bind="text: name"></h2>\r\n                </th>\r\n            </tr>\r\n            <!-- ko if:$index()===0 -->\r\n            <tr class="delivery-and-returns-headings">\r\n                <th scope="col" data-bind="text: $parent.content.deliveryGroupHeaders.type"></th>\r\n                <th scope="col" data-bind="text: $parent.content.deliveryGroupHeaders.howMuch"></th>\r\n            </tr>\r\n            <!-- /ko -->\r\n        </thead>\r\n        <tbody data-bind="foreach: options">\r\n            <tr>\r\n                <td>\r\n                    <span class="delivery-type" data-bind="html: type"></span>\r\n                    <span class="delivery-when" data-bind="html: when"></span>\r\n                </td>\r\n                <td class="delivery-how-much" data-bind="with: $parents[1].formatHowMuch(howMuch)">\r\n                    <span class="delivery-cost" data-bind="html: price"></span>\r\n                    <span class="delivery-free-condition" data-bind="html: freeCondition"></span>\r\n                    <span class="delivery-premier-qualifier" data-bind="html: premierQualifier"></span>\r\n                </td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n    <hr />\r\n    <!-- /ko -->\r\n    <!-- /ko -->\r\n\r\n    <!-- ko if: content.deliveryGroups.length === 0 -->\r\n    <div class="delivery-messaging">\r\n        <div class="delivery-error">\r\n            <div class="information-icon sprite product-information"></div>\r\n            <div class="information-text">\r\n                <span data-bind="text: resources.pdp_delivery_and_returns_options_error_message"></span>\r\n            </div>\r\n        </div>\r\n        <div class="delivery-text">\r\n            <p data-bind="text: resources.pdp_delivery_and_returns_options_unavailable"></p>\r\n            <p data-bind="text: resources.pdp_delivery_and_returns_options_additional_messaging"></p>\r\n        </div>\r\n        <button class="preferences" data-bind="text: resources.pdp_delivery_and_returns_options_preferences_button, click: openCountrySelector"></button>\r\n    </div>\r\n    <!-- /ko -->\r\n    <!-- ko if: content.deliveryGroups.length > 0  -->\r\n    <span class="delivery-terms" data-bind="text: content.terms"></span>\r\n\r\n    <!-- /ko -->\r\n</div>'}),define("Components/delivery-and-returns-content-table/delivery-and-returns-content-table",["ko","text!./delivery-and-returns-content-table.html","PageConfig"],function(e,t,i){function n(e){this.content=e.data.content,this.closeModalCallback=e.data.closeModalCallback,this.isMobile="mobile"===i.platform,this.state=e.state,this.resources=this.state.resources,this.formatHowMuch=function(e){var t=e[0],i=null,n=null;return e.length>1&&(i=e[1],e.length>2&&(n=e[2])),{price:t,freeCondition:i,premierQualifier:n}}.bind(this),this.openCountrySelector=function(){this.closeModalCallback(),window.asos.siteChrome.openCountrySelector()}.bind(this)}return{viewModel:n,template:t}}),define("text!Components/delivery-and-returns-content-link/delivery-and-returns-content-link.html",[],function(){return'<div class="delivery-and-returns-content-link">\r\n    <p class="delivery-and-returns-link-title" data-bind="text: resources.pdp_delivery_and_returns_usa_link_title"></p>\r\n    <p class="delivery-and-returns-link-message" data-bind="text: resources.pdp_delivery_and_returns_usa_link_message"></p>\r\n    <a class="button" href="#" data-bind="attr: {href: deliveryUrl}" target="_blank">\r\n        <span data-bind="text: resources.pdp_delivery_and_returns_delivery_info_link_text"></span>\r\n        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">\r\n            <path fill="#FFFFFF" fill-rule="evenodd" d="M14 12h2V2H6v2h8v8zm0 2v4H0V4h4V0h14v14h-4zM4 6H2v10h10V6H4z"/>\r\n        </svg>\r\n    </a>\r\n</div>'}),define("Components/delivery-and-returns-content-link/delivery-and-returns-content-link",["ko","text!./delivery-and-returns-content-link.html","PageConfig","Product.Config"],function(e,t,i,n){function r(e){this.content=e.data.content,this.countryCode=e.data.countryCode,this.isMobile="mobile"===i.platform,this.resources=e.state.resources,this.deliveryUrl=n.deliveryApiEndpoint+"?country="+this.countryCode}return{viewModel:r,template:t}}),define("text!Components/shipping-restrictions-content/shipping-restrictions-content.html",[],function(){return'<div class="shipping-restrictions-content">\r\n    <div class="shipping-restriction-filter">\r\n        <label for="shippable-countries-input" data-bind="text: countryFilterLabel"></label>\r\n        <input id="shippable-countries-input" type="text" data-bind="textInput: countryFilter" />\r\n    </div>\r\n    <div class="shippable-countries" data-bind="visible: shippableCountriesVisible">\r\n        <span class="shipping-restriction-description" data-bind="text: description"></span>\r\n        <ul data-bind="foreach:filteredShippableCountriesGroupOne">\r\n            <li>\r\n                <span data-bind="text: $data"></span>\r\n            </li>\r\n        </ul>\r\n        <ul data-bind="visible: shippableCountriesGroupTwoVisible, foreach:filteredShippableCountriesGroupTwo">\r\n            <li>\r\n                <span data-bind="text: $data"></span>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div class="shipping-restrictions-no-matches" data-bind="visible: noMatchesVisible">\r\n        <span data-bind="text: noMatches"></span>\r\n    </div>\r\n</div>'}),define("Components/shipping-restrictions-content/shipping-restrictions-content",["ko","text!./shipping-restrictions-content.html"],function(e,t){function i(t){this.resources=t.state.resources,this.countryFilterLabel=this.resources.pdp_shipping_restrictions_filter_countries_label,this.noMatches=this.resources.pdp_shipping_restrictions_error_no_matching_countries_message,this.description=t.data.Description,this.shippableCountries=e.observableArray(t.data.ShippableCountries),this.countryFilter=e.observable(""),this.filteredShippableCountries=e.computed(function(){return this.countryFilter||this.countryFilter()?e.utils.arrayFilter(this.shippableCountries(),function(e){return e.toLowerCase().indexOf(this.countryFilter().toLowerCase())>=0}.bind(this)):this.shippableCountries()}.bind(this)),this.filteredShippableCountriesGroupOne=e.computed(function(){if(this.filteredShippableCountries){var e=Math.ceil(this.filteredShippableCountries().length/2);return this.filteredShippableCountries().slice(0,e)}return[]}.bind(this)),this.filteredShippableCountriesGroupTwo=e.computed(function(){if(this.filteredShippableCountries){var e=Math.ceil(this.filteredShippableCountries().length/2);return this.filteredShippableCountries().slice(e)}return[]}.bind(this)),this.shippableCountriesVisible=e.computed(function(){return this.filteredShippableCountriesGroupOne&&this.filteredShippableCountriesGroupOne().length>0}.bind(this)),this.shippableCountriesGroupTwoVisible=e.computed(function(){return this.filteredShippableCountriesGroupTwo&&this.filteredShippableCountriesGroupTwo().length>0}.bind(this)),this.noMatchesVisible=e.computed(function(){return!this.shippableCountriesVisible()}.bind(this))}return{viewModel:i,template:t}}),define("text!Components/delivery-and-returns-content/delivery-and-returns-content.html",[],function(){return'<div class="delivery-and-returns-content">\r\n    <div class="deliver-to">\r\n        <!-- ko if : !isMobile-->\r\n        <div class="current-country" data-bind="attr: { \'aria-label\': content.destination.label + \' \' + content.destination.selected.name }">\r\n            <span aria-hidden="true" class="country-label" data-bind="text: content.destination.label"></span>\r\n            <span aria-hidden="true" class="country-name dr-flag" data-bind="css: getCountryCode(), text: content.destination.selected.name"></span>\r\n        </div>\r\n        <div class="country-selection">\r\n            <div class="text-overlay"></div>\r\n            <button class="link" data-bind="click: countrySelectionClicked">\r\n                <span data-bind="text: content.destination.changeCountry"></span>\r\n            </button>\r\n        </div>\r\n        <!-- /ko -->\r\n        <!-- ko if : isMobile-->\r\n        <button class="link" data-bind="click: countrySelectionClicked">\r\n            <div class="current-country">\r\n                <span class="country-label" data-bind="text: content.destination.label"></span>\r\n                <span class="country-name dr-flag" data-bind="css: getCountryCode(), text: content.destination.selected.name"></span>\r\n            </div>\r\n            <div class="country-selection">\r\n                <div class="text-overlay"></div>\r\n                <span class="product-chevron" data-bind="text: content.destination.changeCountry"></span>\r\n            </div>\r\n        </button>\r\n        <!-- /ko -->\r\n    </div>\r\n\r\n    <!-- ko if: isUsa() -->\r\n    <div data-bind="component: { name: \'delivery-and-returns-content-link\', params: { data: { content: content, countryCode: getCountryCode() }, state: state } }"></div>\r\n    <!-- /ko -->\r\n\r\n    <!-- ko if: !isUsa() -->\r\n    <div data-bind="component: { name: \'delivery-and-returns-content-table\', params: { data: { content: content, closeModalCallback: closeModalCallback }, state: state } }"></div>\r\n    <!-- /ko -->\r\n\r\n    <!-- ko if: showPremier-->\r\n    <div class="premier-delivery">\r\n        <div class="premier-image">\r\n            <img data-bind="attr: { src: content.premier.image }" />\r\n        </div>\r\n        <div class="premier-text">\r\n            <h2 data-bind="text: content.premier.title"></h2>\r\n            <span data-bind="text: content.premier.text"></span>\r\n            <a class="premier-link" data-bind="text: content.premier.linkText, attr : {href: content.premier.link}" target="_blank"></a>\r\n        </div>\r\n    </div>\r\n    <!-- /ko -->\r\n    <div class="returns">\r\n        <div class="information-icon sprite product-information"></div>\r\n        <div class="information-text">\r\n            <h2 data-bind="text: content.returns.title"></h2>\r\n            <span data-bind="html: buildReturnsParagraph()"></span>\r\n        </div>\r\n    </div>\r\n</div>';
}),define("Components/delivery-and-returns-content/delivery-and-returns-content",["ko","text!./delivery-and-returns-content.html","PageConfig"],function(e,t,i){function n(e){this.content=e.data.content,this.countrySelectedCallback=e.data.showCountrySelectionCallback,this.closeModalCallback=e.data.closeModalCallback,this.showPremier=null!==this.content.premier,this.isMobile="mobile"===i.platform,this.state=e.state,this.resources=this.state.resources,this.countrySelectionClicked=function(){this.countrySelectedCallback()},this.getCountryCode=function(){return this.content.destination.selected["2-iso"].toLowerCase()}.bind(this),this.isUsa=function(e){return"us"===this.getCountryCode(e)}.bind(this),this.getReturnRedirectLink=function(){return this.content.returns.link+"?country="+this.getCountryCode()}.bind(this),this.buildReturnsParagraph=function(){return this.resources.pdp_delivery_and_returns_returns_info_link_text.replace("%{link}",'<a href="'+this.getReturnRedirectLink()+'" target="_blank">').replace("%{linkEnd}",'</a><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill="#2D2D2D" fill-rule="evenodd" d="M14 12h2V2H6v2h8v8zm0 2v4H0V4h4V0h14v14h-4zM4 6H2v10h10V6H4z"/></svg>')}.bind(this)}return{viewModel:n,template:t}}),define("text!Components/delivery-and-returns-countries/delivery-and-returns-countries.html",[],function(){return'<div class="delivery-and-returns-countries">\r\n    <!-- ko if : !isMobile -->\r\n    <div class="current-country-cancel">\r\n        <div class="current-country" data-bind="attr: { \'aria-label\': destination.label + \' \' + destination.selected.name }">\r\n            <span aria-hidden="true" class="country-label" data-bind="text: destination.label"></span>\r\n            <span aria-hidden="true" class="country-name dr-flag" data-bind="css: getFlagCountryCode(destination.selected[\'2-iso\']), text: destination.selected.name"></span>\r\n        </div>\r\n        <div class="cancel-country-selection">\r\n            <div class="text-overlay"></div>\r\n            <button class="link" data-bind="click: cancelClicked"><span data-bind="text: cancelLabel"></span></button>\r\n        </div>\r\n    </div>\r\n    <hr aria-hidden="true" />\r\n    <!-- /ko -->\r\n    <!-- ko if : isMobile-->\r\n    <div class="cancel-country-selection-container">\r\n        <div class="cancel-country-selection">\r\n            <button class="link" data-bind="click: cancelClicked"><span data-bind="text: cancelLabel"></span></button>\r\n        </div>\r\n    </div>\r\n    <!-- /ko -->\r\n    <div class="countries-filter">\r\n        <label for="countries-input" data-bind="text: countryFilterLabel"></label>\r\n        <div class="country-filter-input">\r\n            <input id="countries-input" type="text" data-bind="textInput: countryFilter" />\r\n            <button class="link" data-bind="visible: clearButtonVisible, text: clearCountryFilterLabel, click: clearCountryFilter"></button>\r\n        </div>\r\n    </div>\r\n    <div class="matching-countries" data-bind="visible: countriesVisible">\r\n        <ul data-bind="foreach: filteredCountries">\r\n            <li>\r\n                <button class="link dr-flag" data-bind="css: $parent.getFlagCountryCode(Code), text: Name, click: $parent.countryClicked.bind($data)"></button>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div class="no-matches" data-bind="visible: noMatchesVisible">\r\n        <span data-bind="text: noMatches"></span>\r\n    </div>\r\n</div>'}),define("Components/delivery-and-returns-countries/delivery-and-returns-countries",["ko","text!./delivery-and-returns-countries.html","PageConfig"],function(e,t,i){function n(t){this.isMobile="mobile"===i.platform,this.resources=t.state.resources,this.countrySelectedCallback=t.data.countrySelectionCallback,this.cancelCallback=t.data.cancelCallback,this.cancelLabel=this.resources.pdp_delivery_and_returns_cancel_button,this.clearCountryFilterLabel=this.resources.pdp_delivery_and_returns_clear_button,this.countryFilterLabel=this.resources.pdp_delivery_and_returns_filter_countries_label,this.noMatches=this.resources.pdp_delivery_and_returns_error_no_matching_countries_message;var n=t.data.content;n.sort(function(e,t){var i=e.Name,n=t.Name;return n>i?-1:i>n?1:0}),this.countries=e.observableArray(n),this.destination=t.data.currentDestination,this.countryFilter=e.observable(""),this.clearButtonVisible=e.computed(function(){return this.countryFilter().length>0}.bind(this)),this.getFlagCountryCode=function(e){return e.toLowerCase()}.bind(this),this.countryClicked=function(e){this.countrySelectedCallback(e.Code)}.bind(this),this.cancelClicked=function(){this.cancelCallback()}.bind(this),this.clearCountryFilter=function(){this.countryFilter("")}.bind(this),this.filteredCountries=e.computed(function(){return this.countryFilter||this.countryFilter()?e.utils.arrayFilter(this.countries(),function(e){return e.Name.toLowerCase().indexOf(this.countryFilter().toLowerCase())>=0}.bind(this)):this.countries()}.bind(this)),this.countriesVisible=e.computed(function(){return this.filteredCountries().length>0}.bind(this)),this.noMatchesVisible=e.computed(function(){return!this.countriesVisible()}.bind(this))}return{viewModel:n,template:t}}),define("text!Components/error-container/error-container.html",[],function(){return'<div class="error-container">\r\n    <span class="product-information">Info</span>\r\n    <span class="error" data-bind="html: error"></span>\r\n</div>'}),define("Components/error-container/error-container",["ko","text!./error-container.html"],function(e,t){function i(e){this.error=e.data.content}return{viewModel:i,template:t}}),define("Components/product-details/product-details",["ko","ProductUtils/Analytics","$","ProductUtils/debouncer"],function(e,t,i,n){function r(r){this.isOpen=e.observable(!1),this.id=void 0!==r.data?r.data.id:null,this.containerHeight=e.observable(),this.$overflowContainer=i(".overflow-container"),this.setupDetailsContainer=function(){this.productDetailsMaxHeightOpen=this.$overflowContainer[0].scrollHeight+"px"},this.setupDetailsContainer(),this.toggle=function(){this.isOpen()?this.close():this.open()},this.open=function(){t.fireEvent("pageInteraction",{context:"showMore",productIID:this.id}),this.containerHeight(this.productDetailsMaxHeightOpen),this.isOpen(!0)},this.close=function(){t.fireEvent("pageInteraction",{context:"showLess",productIID:this.id}),this.containerHeight(null),this.isOpen(!1)},window.addEventListener("resize",n.debounce(this.setupDetailsContainer.bind(this),200))}return{viewModel:r}}),define("ProductUtils/OnElementInView",["$","ko"],function(e,t){return this.currentlyInView=null,this.target=null,this.sourceElement=null,this.callback=null,this.timer=null,this.cumulativeOffset=function(e){var t=0,i=0;do t+=e.offsetTop||0,i+=e.offsetLeft||0,e=e.offsetParent;while(e);return{top:t,left:i}},this.checkScrollPosition=function(){var t=!1,i=e(this.sourceElement).outerHeight()+this.target.outerHeight()/2,n=window.innerHeight,r=this.cumulativeOffset(this.target[0]).top+i;(document.body.scrollTop+n>r||document.documentElement.scrollTop+n>r)&&(t=!0),(null===this.currentlyInView||t!==this.currentlyInView)&&(this.currentlyInView=t,this.callback({isInView:t}))},this.onScroll=function(){this.timer&&window.clearTimeout(this.timer),this.timer=window.setTimeout(this.checkScrollPosition.bind(this),100)},t.bindingHandlers.onElementInView={update:function(i,n){var r=n(),s=t.unwrap(r);this.target=e(s.targetSelector),this.sourceElement=i,this.callback=s.callback;var o=s.enabled;o?(this.checkScrollPosition(),window.addEventListener("scroll",this.onScroll,!1),window.addEventListener("resize",this.onScroll,!1)):(window.removeEventListener("scroll",this.onScroll,!1),window.removeEventListener("resize",this.onScroll,!1))}},this}),define("ProductUtils/Performance",["ko"],function(e){e.bindingHandlers.markAndMeasure={init:function(t,i){var n=e.unwrap(i());window.asos.performance.markAndMeasure(n)}}}),define("Pages/FullProduct",["ko","ProductUtils/ComponentLoader","Asos.Utils.MediaPlayers","ProductUtils/StockPrice","Models/VariantDecorator","Utils","Components/product-image/product-image","Components/product-price/product-price","Components/social-share/social-share","Components/content/content","Components/out-of-stock/out-of-stock","Components/size-guide/size-guide","Components/recently-viewed/recently-viewed","Components/might-like/might-like","Components/buy-the-look/buy-the-look","Components/product-gallery/product-gallery","Components/product-colour/product-colour","Components/product-size/product-size","Components/delivery-and-returns/delivery-and-returns","Components/shipping-restrictions/shipping-restrictions","Components/stock-price-retry/stock-price-retry","Components/save-button/save-button","Components/add-item/add-item","Components/afterpay/afterpay","ProductUtils/UrlUtils","ProductUtils/Analytics","Components/fit-analytics/fit-analytics","Components/toast/toast","PageConfig","ProductUtils/OutOfStockAnimator","ProductUtils/NewRelicLogger","Components/delivery-and-returns-content-table/delivery-and-returns-content-table","Components/delivery-and-returns-content-link/delivery-and-returns-content-link","Components/shipping-restrictions-content/shipping-restrictions-content","Components/delivery-and-returns-content/delivery-and-returns-content","Components/delivery-and-returns-countries/delivery-and-returns-countries","Components/error-container/error-container","Components/product-gallery/product-gallery","Components/product-details/product-details","ProductUtils/ScrollTo","ProductUtils/OnElementInView","ProductUtils/Performance"],function(e,t,i,n,r,s,o,a,l,c,d,u,h,p,m,f,v,g,b,y,S,w,I,_,C,x,P,T,k,A,E,z,M){return this.init=function(c,L,D){function R(){if(!W){var t=function n(){return F.getStockPrice(V,function(e){G.productData=(new r).getData(e,!e.isInStock),window.asos.performance.markAndMeasure("pdp:stock_api_returned"),O.register({type:"content",name:"content1",elementId:"aside-content",useComponentTemplate:!1},e,G),O.register({type:"content",name:"content2",elementId:"lower-content",useComponentTemplate:!1},e,G),x.fireProductLoadEvent(e),G.showStockPriceRetry(!1),G.productData.isInStock||A.subscribeToLoadingState(G,e)}.bind(this),function(e){404!==e.status||V.price&&V.price.currency?G.showStockPriceRetry(!0):(G.showStockPriceRetry(!1),G.productData={isInStock:!1},O.register({type:"content",name:"aside-content-oos",elementId:"aside-content-oos",useComponentTemplate:!1},V,this.state))}),n}();this.state.retryCallback=t,O.register({type:"content",name:"aside-content-retry",elementId:"aside-content-retry",useComponentTemplate:!1},V,this.state),O.register({type:"product-details",name:"product-details",elementId:"product-details",useComponentTemplate:!1},V,this.state),O.register({type:"content",name:"content3",elementId:"gallery-content",useComponentTemplate:!1},V,this.state),e.components.register("product-gallery",f),e.components.register("size-guide",u),e.components.register("product-image",o),e.components.register("shipping-restrictions",y),e.components.register("product-price",a),e.components.register("out-of-stock",d),e.components.register("might-like",p),e.components.register("social-share",l),e.components.register("buy-the-look",m),e.components.register("stock-price-retry",S),e.components.register("product-colour",v),e.components.register("product-size",g),e.components.register("delivery-and-returns",b),e.components.register("delivery-and-returns-content-table",z),e.components.register("delivery-and-returns-content-link",M),e.components.register("recently-viewed",h),e.components.register("asos-video-player-prod",i.videoPlayer),e.components.register("asos-spin-viewer-prod",i.spinViewer),e.components.register("save-button",w),e.components.register("add-item",I),e.components.register("fit-analytics",P),e.components.register("toast",T),e.components.register("afterpay",_),W=!0}}E.init(E.PAGE_TYPE.PRD);var V="string"==typeof c?JSON.parse(c):c,F=new n,O=new t,U=s.QueryString.getValue("colourWayId")&&parseInt(decodeURIComponent(s.QueryString.getValue("colourWayId")).trim(),10);V||E.logError(new Error(E.ERROR_TYPE.ParseError),{action:"PageInit",message:"server-side product data missing or invalid"});var N=new C,B=N.getVariantFromUrl(window.location.href,V.variants);if(!B&&U&&c.totalNumberOfColours>1&&(c.isOneSize||c.isNoSize))for(var $=0;$<V.variants.length;$++)if(V.variants[$].colourWayId===U){B=V.variants[$];break}this.state={selectedColour:e.observable(),selectedSize:e.observable(),showNoColourSelectedWarning:e.observable(!1),showNoSizeSelectedWarning:e.observable(!1),showAddToBagError:e.observable(!1),addToBagErrorMessage:e.observable(""),resources:L,features:D,gender:V.gender,isInStock:e.observable(!0),showStockPriceRetry:e.observable(!1),defaultVariant:B,showSizeGuide:e.observable(!1),fitAnalyticsViewModel:e.observable(),sellingFast:V.sellingFast,afterpay:V.afterpay?V.afterpay[k.currency.toLowerCase()]:void 0,displayPrice:e.observable(0),CAROUSEL_LOADING_STATE:{NOT_LOADED:0,NO_DATA:1,HAS_DATA:2},submodulesCompleted:{buyTheLook:e.observable(0),recommendations:e.observable(0),recentlyViewed:e.observable(0)},toast:{displayMessage:e.observable(!1),message:e.observable()}},this.isMobile="mobile"===k.platform;var W=!1,G=this.state;document.addEventListener("DOMContentLoaded",function(){R.call(this)}.bind(this)),document.getElementById("aside-content")&&document.getElementById("lower-content")&&document.getElementById("product-details")&&document.getElementById("gallery-content")&&R.call(this)},this.init}),define("text!Components/mix-and-match/mix-and-match.html",[],function(){return'<div class="product-hero">\r\n    <div data-bind=\'component: { name: "delivery-and-returns", params: {state: state, hideDeliveryLink: false}}\'></div>\r\n    <!-- ko if: isMobile -->\r\n    <div class="separator"></div>\r\n    <!-- /ko -->\r\n</div>\r\n\r\n<ul>\r\n    <!-- ko foreach: products -->\r\n    <li class="item">\r\n        <a data-bind="click: $parent.isMobile ? $parent.navigateToFullProduct.bind($data, $index()) : $parent.showOverlay.bind($data, $index(), $element)">\r\n            <div class="product-image" data-bind=\'component: { name: "product-image", params: {imgUrl: productImage.url+"?$S$&wid=75&fit=constrain"} }\'></div>\r\n        </a>\r\n        <div class="product-info">\r\n            <!--Product title-->\r\n            <a data-bind="click: $parent.isMobile ? $parent.navigateToFullProduct.bind($data, $index()) : $parent.showOverlay.bind($data, $index(), $element)">\r\n                <div class="product-title" data-bind=\'text: name\'></div>\r\n                <div class="product-price" data-bind=\'component: { name: "product-price", params: {state: $parent.getState($index()), hideDeliveryLink: true, showGermanVatMessage: $parent.options.showGermanVatMessage }}\'></div>\r\n            </a>\r\n\r\n            <!-- ko if: $parent.isMobile && state.afterpay -->\r\n            <div class="afterpay mix-and-match-mobile" data-bind=\'component: { name: "afterpay", params: { state: state, data: { price: ko.observable($parent.getState($index()).productData.minPrice.value) } } }\'></div>\r\n            <!-- /ko -->\r\n\r\n            <!-- ko if: $parent.isMobile -->\r\n            <a data-bind="click: $parent.showOverlay.bind($data, $index(), $element)">\r\n                <div class="product-information"></div>\r\n            </a>\r\n            <!-- /ko -->\r\n            <!-- ko if: $parent.isOutOfStock($index()) -->\r\n            <span class="out-of-stock" data-bind="text: $parent.state.resources.pdp_status_mix_and_match_out_of_stock"></span>\r\n            <!-- /ko -->\r\n            <!-- ko if: !$parent.isOutOfStock($index()) -->\r\n            <div class="product-colour" data-bind=\'component:{\r\n                name: "product-colour",\r\n                params: {\r\n                    hideLabels: false,\r\n                    useShortSelectColourLabel: true,state: $parent.getState($index()),\r\n                    data: $data}\r\n                }\'></div>\r\n            <!-- /ko -->\r\n\r\n        </div>\r\n        <!-- ko if: !$parent.isOutOfStock($index()) -->\r\n        <div data-bind=\'component:{\r\n            name: "product-size",\r\n            params: {\r\n                hideLabels: false,\r\n                hideLowInStock: false,\r\n                hideOnOutOfStock: true,\r\n                showSizeGuide: true,\r\n                doNotSelectDefaultSize: !$parent.isMobile,\r\n                displayOnlyAsDropDown: !$parent.isMobile,\r\n                state: $parent.getState($index()),\r\n                data: $data}\r\n            }\'></div>\r\n        <!-- ko if: $parent.isMobile -->\r\n        <div id="mix-and-match-add-item" data-bind=\'component:{name: "add-item",\r\n                     params:{\r\n                         state: $parent.getState($index())\r\n                     }}\'></div>\r\n\r\n        <div id="mix-and-match-save-button" data-bind=\'component:{name: "save-button",\r\n                     params:{\r\n                         variants: variants,\r\n                         state: [$parent.getState($index())],\r\n                         isMixMatch : true\r\n                     }}\'></div>\r\n        <div class="basic-error-box" data-bind="visible: $parent.getState($index()).showAddToBagError, html: $parent.getState($index()).addToBagErrorMessage" style="display:none">\r\n        </div>\r\n        <!-- /ko -->\r\n        <!-- /ko -->\r\n        <!-- ko if: $parent.isMobile -->\r\n        <div class="separator"></div>\r\n        <!-- /ko -->\r\n\r\n    </li>\r\n    <!-- /ko -->\r\n    <!-- ko if: !isMobile -->\r\n    <li class="item">\r\n        <div class="separator end-of-products"></div>\r\n    </li>\r\n    <li class="total-price-item">\r\n        <div data-bind=\'component: { name: "total-price", params: { variants: variants, state: getState(0), afterpay: state.afterpay } }\'></div>\r\n    </li>\r\n    <li class="item" data-bind="visible : showNoSizesSelectedWarning">\r\n        <div class="error-message" data-bind="html: state.resources.pdp_status_error_mix_and_match_select_product"></div>\r\n    </li>\r\n    <li class="item" data-bind="visible : showAddToBagError">\r\n        <div class="error-message" data-bind="html: addToBagErrorMessage"></div>\r\n    </li>\r\n    <li class="item">\r\n        <div id="mix-and-match-add-items" data-bind=\'component:{name: "add-items",\r\n                     params:{\r\n                         variants: variants,\r\n                         state: state,\r\n                         initiator : "main"\r\n                     }}\'></div>\r\n        <div id="mix-and-match-save-button" data-bind=\'component:{name: "save-button",\r\n                     params:{\r\n                         variants: variants,\r\n                         state: context.States,\r\n                         isMixMatch : true\r\n                     }}\'></div>\r\n    </li>\r\n    <!-- /ko -->\r\n</ul>'}),define("Components/mix-and-match/mix-and-match",["ko","text!./mix-and-match.html","ProductUtils/ModalWindow","ProductUtils/Analytics","ProductUtils/UrlUtils","PageConfig"],function(e,t,i,n,r,s){function o(e){this.context=e.data,this.products=e.data.products,this.state=e.state,this.options=e.options,this.isMobile="mobile"===s.platform,this.showNoSizesSelectedWarning=e.state.showNoSizesSelectedWarning,this.showAddToBagError=e.state.showAddToBagError,this.addToBagErrorMessage=this.state.addToBagErrorMessage,this.variants=[];for(var t=new r,o=this.products.length;o--;)this.variants.push(this.context.States[o].selectedSize);this.getState=function(e){return this.context.States[e]}.bind(this),this.isOutOfStock=function(e){return!this.getState(e).productData.isInStock}.bind(this),this.showOverlay=function(t,r){n.fireEvent("modalAction",{context:"openModal",modalType:"mixAndMatch",productIID:this.products[t].id});var s=new i;this.isMobile&&s.setTitle(this.state.resources.pdp_description_product_information_title),s.addComponent("mix-and-match-product",{productId:this.products[t].id,playerParams:e.playerParams},this.state),s.setClass("mix-and-match-overlay"),s.open({showSpinner:!0,openerElement:r})}.bind(this),this.getProductLink=function(e){var i=t.getProductUrl(e.name,this.context.brandName,e.id);return i+this.getQueryString()}.bind(this),this.navigateToFullProduct=function(e){var t=this.getProductLink(this.products[e]);this.navigateTo(t)}.bind(this),this.navigateTo=function(e){window.location=e},this.getQueryString=function(){return document.location.search}}return{viewModel:o,template:t}}),define("text!Components/total-price/total-price.html",[],function(){return'<h4 class="number-of-items" data-bind="text: selectedItemsText"></h4><h4 class="total-price" data-bind="text: totalPrice"></h4>\r\n<!-- ko if : state.afterpay -->\r\n<div class="afterpay mix-and-match-desktop" data-bind=\'component: { name: "afterpay", params: { state: state, data: { price: totalPriceValue } } }\'></div>\r\n<!-- /ko -->'}),define("Components/total-price/total-price",["ko","text!./total-price.html","Asos.Web.Currency.Formatter","PageConfig"],function(e,t,i,n){function r(t){var r=t.variants;this.state=t.state,this.state.afterpay=t.afterpay,this.selectedItemsText=e.observable(""),this.totalPriceValue=e.observable(0),this.totalPrice=e.computed(function(){for(var e=r.length,s=0,o=0;e--;){var a=r[e]();a&&(s+=a.price.current.value,o++)}return this.totalPriceValue(s),this.selectedItemsText(t.state.resources.pdp_status_number_of_selected_items.replace("%{count}",o)),i.formatPrice(this.totalPriceValue().toFixed(2),n.language,n.currency)}.bind(this))}return{viewModel:r,template:t}}),define("text!Components/mix-and-match-product/mix-and-match-product.html",[],function(){return'<!-- ko if: product() != undefined -->\r\n\r\n<div>\r\n\r\n    <section>\r\n        <div class="layout-width">\r\n            <!-- ko if: !isMobile -->\r\n            <div id="gallery-content" data-bind="visible: !isMobile">\r\n                <div class="product-gallery" data-bind=\'component: { name: "product-gallery", params: {state: state,  data: { rootElement: $element, id: product().id, images: product().media.images, map: {}, defaultColour: product().defaultColour, media: product().media, playerParams: playerParams  }}}\'></div>\r\n            </div>\r\n            <!-- /ko -->\r\n\r\n            <div class="layout-aside" id="aside-content">\r\n                <!-- ko if: !state.productData.isInStock -->\r\n                    <h3 class="product-out-of-stock-label" data-bind="text: state.resources.pdp_status_mix_and_match_out_of_stock"></h3>\r\n                <!-- /ko -->\r\n                <!-- ko if: !isMobile -->\r\n                <h1 class="product-hero" data-bind="text: product().name"></h1>\r\n                <div class="product-price" id="product-price" data-bind=\'component: { name: "product-price", params: {state: state}}\'></div>\r\n                <div id="product-colour" data-bind=\'component:{\r\n                            name: "product-colour",\r\n                            params: {\r\n                                hideLabels: false,\r\n                                useShortSelectColourLabel: false,\r\n                                state: state,\r\n                                data: product(),\r\n                                hideOnOutOfStock : true}\r\n                            }\'></div>\r\n                <!-- /ko -->\r\n\r\n                <!-- ko if: state.productData.isInStock -->\r\n                <div class="product-details" id="product-details">\r\n                    <div class="product-description" data-bind="visible: info().productDetailsVisible">\r\n                        <h2 data-bind="text: state.resources.pdp_description_product_details_title"></h2>\r\n                        <p data-bind="html: info().productDetails"></p>\r\n                    </div>\r\n                    <div class="product-description" data-bind="visible: info().sizeAndFitVisible">\r\n                        <h2 data-bind="text: state.resources.pdp_description_size_and_fit_title"></h2>\r\n                        <p data-bind="html: info().sizeAndFit"></p>\r\n                    </div>\r\n                    <div class="product-description" data-bind="visible: info().careInfoVisible">\r\n                        <h2 data-bind="text: state.resources.pdp_description_care_info_title"></h2>\r\n                        <p data-bind="html: info().careInfo"></p>\r\n                    </div>\r\n                    <div class="product-description" data-bind="visible: info().aboutMeVisible">\r\n                        <h2 data-bind="text: state.resources.pdp_description_about_me_title"></h2>\r\n                        <p data-bind="html: info().aboutMe"></p>\r\n                    </div>\r\n                    <div class="product-description" data-bind="visible: info().brandDescriptionVisible">\r\n                        <h2 data-bind="text: state.resources.pdp_description_brand_title"></h2>\r\n                        <p data-bind="html: info().brandDescription"></p>\r\n                    </div>\r\n                    <div class="product-description">\r\n                        <h2 data-bind="text: state.resources.pdp_description_product_code_title"></h2>\r\n                        <p data-bind="html: info().productCode"></p>\r\n                    </div>\r\n                </div>\r\n                <!-- /ko -->\r\n                <!-- ko if: !state.productData.isInStock -->\r\n                    <p class="product-code">\r\n                        <span class="label" data-bind="text: state.resources.pdp_description_product_code_title"></span>\r\n                        <span data-bind="text:info().productCode"></span>\r\n                    </p>\r\n                <!-- /ko -->\r\n            </div>\r\n        </div>\r\n    </section>\r\n\r\n    <a class="product-page-button" data-bind="attr: { href: productLink}, text: state.resources.pdp_mix_and_match_modal_go_to_product"></a>\r\n</div>\r\n\r\n<!-- /ko  -->\r\n'}),define("Models/ProductDescription",[],function(){function e(){this.productDetails="",this.productDetailsVisible=!1,this.sizeAndFit="",this.sizeAndFitVisible=!1,this.careInfo="",this.careInfoVisible=!1,this.aboutMe="",this.aboutMeVisible=!1,this.brandDescription="",this.brandDescriptionVisible=!1,this.productCode=""}return function(){this.getProductDescriptionViewModel=function(t){var i=new e;t.description&&(i.productDetails=t.description,i.productDetailsVisible=!0);var n=t.info;return n&&(n.sizeAndFit&&(i.sizeAndFit=n.sizeAndFit,i.sizeAndFitVisible=!0),n.careInfo&&(i.careInfo=n.careInfo,i.careInfoVisible=!0),n.aboutMe&&(i.aboutMe=n.aboutMe,i.aboutMeVisible=!0)),t.brand&&t.brand.description&&(i.brandDescription=t.brand.description,i.brandDescriptionVisible=!0),i.productCode=t.productCode,i}}}),define("Components/mix-and-match-product/mix-and-match-product",["ko","text!./mix-and-match-product.html","ProductUtils/FullProductApiClient","Models/VariantDecorator","Models/ProductDescription","$","PageConfig","ProductUtils/UrlUtils"],function(e,t,i,n,r,s,o,a){function l(t){var s=new i;this.urlUtils=new a,this.product=e.observable(),this.info=e.observable(),this.isMobile="mobile"===o.platform,this.playerParams=t.data.playerParams,this.dataReceived=t.data.loadedCallback,this.productLink=e.observable(),this.state={selectedColour:e.observable(),selectedSize:e.observable(),showNoColourSelectedWarning:e.observable(!1),showNoSizeSelectedWarning:e.observable(!1),resources:t.state.resources},s.getFullProduct(t.data.productId,!1,"MixAndMatch").done(function(e){this.state.productData=(new n).getData(e,!0);var t=new r;this.info(t.getProductDescriptionViewModel(e)),this.product(e),this.productLink(this.urlUtils.getProductUrl(e.name,e.brand.name,e.id)),this.dataReceived()}.bind(this))}return{viewModel:l,template:t}}),define("text!Components/add-items/add-items.html",[],function(){return'<div class="add-items">\r\n    <div class="is-add-items-saving" data-bind="visible: isBusy"></div>\r\n    <span class="aria-live" aria-live="polite" aria-role="status" data-bind="{ text: ariaLiveText, attr: { \'aria-label\': ariaLiveText }}"></span>\r\n    <a href="#" class="add-button" data-bind="click: addToBag, css : { \'is-disabled\' : isBusy }, attr: { \'aria-label\': resources.pdp_cta_add_to_bag }, markAndMeasure: \'pdp:add_to_bag_interactive\'">\r\n        <span class="product-tick" data-bind="visible: addedToBag, text: iconText"></span>\r\n        <span data-bind="text: buttonText"></span>\r\n    </a>\r\n</div>'}),define("Components/add-items/add-items",["ko","text!./add-items.html","ProductUtils/Bag","ProductUtils/ScrollTo","$"],function(e,t,i,n,r){function s(t){this.variants=t.variants,this.resources=t.state.resources,this.addedToBag=e.observable(!1),this.topOfPage=r("#top-of-page"),this.showNoSizesSelectedWarning=t.state.showNoSizesSelectedWarning,this.showAddToBagError=t.state.showAddToBagError,this.addToBagErrorMessage=t.state.addToBagErrorMessage,this.moreThanOneProductSelected=e.observable(!1),this.buttonText=e.observable(""),this.isBusy=e.observable(!1),this.ariaLiveText=e.computed(function(){var e=this.addToBagErrorMessage();return e?e:this.addedToBag()?this.resources.pdp_status_add_to_bag_success:""},this),this.iconText=e.computed(function(){return this.addedToBag()?"added to basket":"add to basket"}.bind(this)),this.setButtonTextAdd=function(){this.moreThanOneProductSelected()?this.buttonText(this.resources.pdp_cta_mix_and_match_add_items):this.buttonText(this.resources.pdp_cta_mix_and_match_add_item)}.bind(this),this.setButtonTextAdded=function(){this.moreThanOneProductSelected()?this.buttonText(this.resources.pdp_status_mix_and_match_add_items_success):this.buttonText(this.resources.pdp_status_mix_and_match_add_item_success)}.bind(this),this.selectedVariants=e.computed(function(){for(var e=this.variants.length,t=[];e--;){var i=this.variants[e]();i&&t.push(i)}return this.showNoSizesSelectedWarning(!1),this.moreThanOneProductSelected(t.length>1),this.setButtonTextAdd(),this.addedToBag(!1),t}.bind(this));var s=new i(t,t.initiator);this.addToBag=function(){return this.isBusy()?!1:(this.revertState(),void(0===this.selectedVariants().length?this.showNoSizesSelectedWarning(!0):(this.isBusy(!0),s.addItems(this.selectedVariants(),this.addToBagResult))))}.bind(this);var o;this.addToBagResult=function(e){this.isBusy(!1),this.addedToBag(e.success),e.success?(this.setButtonTextAdded(),n.scrollToElement(this.topOfPage),o&&window.clearTimeout(o),o=setTimeout(this.revertState,5e3)):(this.showAddToBagError(!0),this.addToBagErrorMessage(e.error))}.bind(this),this.revertState=function(){this.setButtonTextAdd(),this.addedToBag(!1),this.showAddToBagError(!1),this.addToBagErrorMessage(""),this.isBusy(!1)}.bind(this)}return{viewModel:s,template:t}}),define("Pages/MixAndMatch",["ko","ProductUtils/ComponentLoader","Asos.Utils.MediaPlayers","ProductUtils/StockPrice","Models/VariantDecorator","Utils","Components/product-image/product-image","Components/product-price/product-price","Components/add-item/add-item","Components/afterpay/afterpay","Components/social-share/social-share","Components/content/content","Components/out-of-stock/out-of-stock","Components/size-guide/size-guide","Components/recently-viewed/recently-viewed","Components/might-like/might-like","Components/buy-the-look/buy-the-look","Components/mix-and-match/mix-and-match","Components/product-gallery/product-gallery","Components/product-colour/product-colour","Components/product-size/product-size","Components/total-price/total-price","Components/delivery-and-returns/delivery-and-returns","Components/delivery-and-returns-content-table/delivery-and-returns-content-table","Components/delivery-and-returns-content-link/delivery-and-returns-content-link","Components/stock-price-retry/stock-price-retry","Components/mix-and-match-product/mix-and-match-product","Components/save-button/save-button","Components/add-items/add-items","Components/add-item/add-item","ProductUtils/Analytics","Components/toast/toast","PageConfig","ProductUtils/NewRelicLogger","Components/product-details/product-details","ProductUtils/ScrollTo","ProductUtils/Performance"],function(e,t,i,n,r,s,o,a,l,c,d,u,h,p,m,f,v,g,b,y,S,w,I,_,C,x,P,T,k,A,E,z,M,L){
return this.init=function(l,u,f){function v(){if(!O){var t=function n(){return V.getStockPrice(R,function(t){window.asos.performance.markAndMeasure("pdp:stock_api_returned"),E.fireMixMatchLoadEvent(t);for(var i=0;i<t.products.length;i++){var n={selectedColour:e.observable(),selectedSize:e.observable(),showNoColourSelectedWarning:e.observable(!1),showNoSizeSelectedWarning:e.observable(!1),showAddToBagError:e.observable(!1),addToBagErrorMessage:e.observable(""),productImage:t.products[i].productImage.url,resources:u,features:f,session:P.session};n.productData=(new r).getData(t.products[i],!0),F.push(n)}R.States=F,D.register({type:"content",name:"content1",elementId:"aside-content",useComponentTemplate:!1},R,P),D.register({type:"content",name:"content2",elementId:"lower-content",useComponentTemplate:!1},R,P),D.register({type:"content",name:"mix-and-match-name",elementId:"mix-and-match-name",useComponentTemplate:!1},R,P),P.showStockPriceRetry(!1)}.bind(this),function(e){404===e.status?(P.showStockPriceRetry(!1),P.productData={isInStock:!1},R.categories=[],D.register({type:"content",name:"aside-content-oos",elementId:"aside-content-oos",useComponentTemplate:!1},R,P)):P.showStockPriceRetry(!0)}),n}();this.state.retryCallback=t,D.register({type:"content",name:"aside-content-retry",elementId:"aside-content-retry",useComponentTemplate:!1},R,this.state),D.register({type:"content",name:"content3",elementId:"gallery-content",useComponentTemplate:!1},R,this.state),e.components.register("out-of-stock",h),e.components.register("stock-price-retry",x),e.components.register("product-gallery",b),e.components.register("size-guide",p),e.components.register("product-image",o),e.components.register("product-colour",y),e.components.register("product-size",S),e.components.register("product-price",a),e.components.register("social-share",d),e.components.register("mix-and-match",g),e.components.register("recently-viewed",m),e.components.register("total-price",w),e.components.register("delivery-and-returns",I),e.components.register("delivery-and-returns-content-table",_),e.components.register("delivery-and-returns-content-link",C),e.components.register("asos-video-player-prod",i.videoPlayer),e.components.register("asos-spin-viewer-prod",i.spinViewer),e.components.register("save-button",T),e.components.register("add-items",k),e.components.register("add-item",A),e.components.register("toast",z),e.components.register("afterpay",c),O=!0}}L.init(L.PAGE_TYPE.GRP),this.state={resources:u,features:f,selectedColour:e.observable(),showNoSizesSelectedWarning:e.observable(!1),showAddToBagError:e.observable(!1),addToBagErrorMessage:e.observable(""),showStockPriceRetry:e.observable(!1),toast:{displayMessage:e.observable(!1),message:e.observable()},CAROUSEL_LOADING_STATE:{NOT_LOADED:0,NO_DATA:1,HAS_DATA:2},submodulesCompleted:{buyTheLook:e.observable(0),recommendations:e.observable(0),recentlyViewed:e.observable(0)}},this.useProductIdForVideos=!0;var P=this.state,D=new t,R="string"==typeof l?JSON.parse(l):l;P.afterpay=R.afterpay?R.afterpay[M.currency.toLowerCase()]:void 0,R||L.logError(new Error(L.ERROR_TYPE.ParseError),{action:"PageInit",message:"server-side product data missing or invalid"});var V=new n,F=[];R.defaultProductId=parseInt(s.QueryString.getValue("iid")||0);var O=!1;document.addEventListener("DOMContentLoaded",function(){v.call(this)}.bind(this)),document.getElementById("aside-content")&&document.getElementById("lower-content")&&document.getElementById("gallery-content")&&v.call(this)},this.init}),define("main",["Pages/FullProduct","Pages/MixAndMatch"],function(){});
//# sourceMappingURL=Asos.Product.Page.Web.js.map